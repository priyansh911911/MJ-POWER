module.exports=[7840,a=>{"use strict";var b=a.i(9168),c=a.i(7068),d=a.i(2759),e=a.i(935),f=a.i(7298),g=a.i(8171),h=a.i(7669),i=a.i(6693),j=a.i(1376);let k="s3_mjpower_solar",l="http://localhost:4466",m=async(a,b,c={})=>{let{body:d,page:e,sort:f,joins:g,hidden:h,fields:i,filter:m,search:n,nearby:o,session:p,validation:q,permissions:r,loading:s=!0}=c,t={};h&&(t.hidden=h),m&&(t.filter=m),i&&(t.fields=i),p&&(t.session=p),o&&(t.nearby=o),g&&(t.collections=g),q&&(t.validation=q),r&&(t.permissions=r);let u=function(a,b,c){let d,e=((d=b.split("/")).length>2&&d.pop(),d.join("/")),f={fields:c?.fields,hidden:c?.hidden,filter:c?.filter,nearby:c?.nearby,collections:c?.joins,permissions:c?.permissions,validation:c?.validation};f.body_is_array=Array.isArray(c.body||{});let g=a+">"+e;for(let a in f)g+=a+":"+f[a];return a+":"+e+">"+function(a){let b,c=5381;for(let b=0;b<a.length;b++)c=(c<<5)+c^a.charCodeAt(b);let d="";for(let a=0;a<8;a++)c^=c<<13,c^=c>>>17,c^=c<<5,d+=String.fromCharCode(b=(b=(c>>>0)%62)<10?48+b:b<36?87+b:29+b);return d}(g)}(a,b,c),v=j.default[u]||!1;v?t.token=v:(t["token-key"]=u,t["token-path"]="C:\\Users\\priya\\OneDrive\\Documents\\GitHub\\MJ-POWER\\src\\services\\tokens.json");let w={page:e,sort:f,search:n};try{s&&console.log("Loading started...");let c={method:a.toUpperCase(),headers:{...t,"Content-Type":"application/json",app:k},body:d?JSON.stringify(d):null},e=b;if(w.page||w.sort||w.search){let a=new URLSearchParams(w);e+=`?${a.toString()}`}let f=v?l+e:"http://localhost:4466"+e;console.log(f,c);let g=await fetch(f,c);if(!g.ok)throw Error(`HTTP ${g.status}: ${g.statusText}`);return await g.json()}catch(b){if(console.error(`${a.toUpperCase()} Error:`,b.message),"Failed to fetch"===b.message)throw Error("Network error: Unable to connect to server. Please check your internet connection or try again later.");throw b}finally{s&&console.log("Loading completed.")}},n=async(a,b)=>m("get",a,b),o=async(a,b)=>m("put",a,b),p=async(a,b)=>m("post",a,b),q=async(a,b)=>m("delete",a,b),r=async(a,b)=>m("post",`/sql-${a.replace("/","")}`,b);class s{collection;constructor(a){this.collection=a}async findMany(a={}){try{console.log(`FQL: Fetching ${this.collection}`);let b=await n(`/${this.collection}`,{filter:a.filter,search:a.search,sort:a.sort,fields:a.fields,joins:a.joins,page:a.limit?`1,${a.limit}`:void 0});return console.log(`FQL: ${this.collection} result:`,b),{result:b?.result||b?.data||b||[]}}catch(a){return console.error(`FQL: Error fetching ${this.collection}:`,a),{result:[],err:a}}}async findById(a,b={}){try{return{result:await n(`/${this.collection}/${a}`,{fields:b.fields,joins:b.joins,session:b.useSession?"true":void 0})}}catch(a){return{result:null,err:a}}}async findLast(a={}){try{return{result:await n(`/${this.collection}/last`,{filter:a.filter,search:a.search,sort:a.sort,fields:a.fields,joins:a.joins,session:a.useSession?"true":void 0})}}catch(a){return{result:null,err:a}}}async createOne(a,b={}){try{console.log(`FQL: Creating ${this.collection}:`,a),console.log(`FQL: API endpoint will be: /${this.collection}`),"products"===this.collection&&console.log("PRODUCTS: Forcing correct endpoint");let b=await p(`/${this.collection}`,{body:a});return console.log(`FQL: Create ${this.collection} result:`,b),{result:b?.result||{id:b?.id||Date.now()}}}catch(a){return console.error(`FQL: Error creating ${this.collection}:`,a),{result:{id:0},err:a}}}async createMany(a,b={}){try{return{result:await p(`/${this.collection}/batch`,{body:a,session:b.useSession?"true":void 0})}}catch(a){return{result:{ids:[]},err:a}}}async updateById(a,b,c={}){try{return await o(`/${this.collection}/${a}`,{body:b,session:c.useSession?"true":void 0}),{result:!0}}catch(a){return{result:!1,err:a}}}async updateMany(a,b={}){try{return await o(`/${this.collection}/batch`,{body:a,session:b.useSession?"true":void 0}),{result:!0}}catch(a){return{result:!1,err:a}}}async softDeleteById(a,b={}){try{return await o(`/${this.collection}/${a}`,{body:{is_deleted:1},session:b.useSession?"true":void 0}),{result:!0}}catch(a){return{result:!1,err:a}}}}class t{sales=new s("sales");purchases=new s("purchases");purchase_entries=new s("purchase_entries");receipts=new s("receipts");customers=new s("customers");vendors=new s("vendors");items=new s("items");units=new s("units");areas=new s("areas");clients=new s("clients");roles=new s("roles");users=new s("users");products=new s("products");services=new s("services");orders=new s("orders");tickets=new s("tickets");quotes=new s("quotes");async sql(a,b=[],c={}){try{return{result:await r("query",{body:{sql:a,params:b},session:c.useSession?"true":void 0})}}catch(a){return{result:[],err:a}}}}let u=new t,v=(0,h.createContext)({}),w=()=>{let a=(0,h.useContext)(v);if(!a)throw Error("useApp must be used within an AppProvider");return a},x=({children:a})=>{let[b,c]=(0,h.useState)(()=>i.default),[d,e]=(0,h.useState)(()=>null),[f,j]=(0,h.useState)("dashboard"),[k,l]=(0,h.useState)(!1);(0,h.useEffect)(()=>{},[b]),(0,h.useEffect)(()=>{m()},[]);let m=async()=>{try{let[a,b,d,e,f]=await Promise.all([u.customers.findMany({fields:"*"}),u.products.findMany({fields:"*"}),u.services.findMany({fields:"*"}),u.tickets.findMany({fields:"*"}),u.quotes.findMany({fields:"*"})]);console.log("Raw FQL responses:",{customers:a,products:b,services:d,tickets:e,quotes:f});let g=b?.result||[],h=d?.result||[];if(b?.token&&!b?.result)try{let a=await n(`/products?token=${b.token}`);g=a?.result||[]}catch(a){console.log("Token fetch failed for products, using empty array")}if(d?.token&&!d?.result)try{let a=await n(`/services?token=${d.token}`);h=a?.result||[]}catch(a){console.log("Token fetch failed for services, using empty array")}console.log("Setting data from FQL:",{customers:a?.result||a||[],products:g,services:h,tickets:e?.result||e||[],quotes:f?.result||f||[]}),c({...i.default,customers:a?.result||a||[],products:g,services:h,tickets:e?.result||e||[],quotes:f?.result||f||[],orders:[]})}catch(a){console.error("Failed to load from database:",a)}},o=async()=>{try{await p("/mjpower_data",{body:b})}catch(a){console.error("Cloud sync failed:",a)}},q=async()=>{try{let a=await n("/mjpower_data");a&&c(a)}catch(a){console.error("Cloud load failed:",a)}};(0,h.useEffect)(()=>{},[d]);let r=async(a,b)=>{try{if(!b?.trim())return void c(b=>({...b,[a]:[]}));let d=await u.products.findMany({}),e=d.result?.filter(a=>a.name.toLowerCase().includes(b.toLowerCase()))||[];c(b=>({...b,[a]:e}))}catch(b){console.error("fetchData error:",b),c(b=>({...b,[a]:[]}))}},s=async(a,b)=>{try{console.log(`=== Adding item to ${a} ===`),console.log("Item data:",b),console.log("FQL collection exists:",!!u[a]);let d=await u[a].createOne(b,{});if(console.log("FQL response:",d),d.err)throw console.log("API returned error, falling back to local storage"),Error(d.err.message||d.result);let e={...b,id:d.result.id};return c(b=>({...b,[a]:[...b[a]||[],e]})),console.log(`Successfully added to ${a}:`,e),"products"===a&&setTimeout(async()=>{let a=await u.products.findMany({});console.log("=== Current Products in Database ===",a)},1e3),e}catch(e){console.error(`Database add failed for ${a}:`,e);let d={...b,id:Date.now()};return c(b=>({...b,[a]:[...b[a]||[],d]})),d}},t=async(a,b,d)=>{try{await u[a].updateById(b,d,{useSession:!0}),c(c=>({...c,[a]:c[a].map(a=>a.id===b?{...a,...d}:a)}))}catch(e){console.error("Database update failed:",e),c(c=>({...c,[a]:c[a].map(a=>a.id===b?{...a,...d}:a)}))}},w=async(a,b)=>{try{await u[a].softDeleteById(b,{useSession:!0}),c(c=>({...c,[a]:c[a].filter(a=>a.id!==b)}))}catch(d){console.error("Database delete failed:",d),c(c=>({...c,[a]:c[a].filter(a=>a.id!==b)}))}};return(0,g.jsx)(v.Provider,{value:{data:b,currentUser:d,currentPage:f,setCurrentPage:j,login:(a,c,d=null)=>{if(d)return e(d),!0;let f=b.users?.find(b=>b.username===a&&b.password===c);return!!f&&(e(f),!0)},logout:()=>{e(null),j("dashboard")},updateData:(a,b)=>{c(c=>({...c,[a]:b}))},addItem:s,updateItem:t,deleteItem:w,useCloud:k,setUseCloud:l,syncToCloud:o,loadFromCloud:q,fetchData:r},children:a})},y={src:a.i(5613).default,width:552,height:452,blurWidth:8,blurHeight:7,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAYAAAA1WQxeAAAAqklEQVR42o2OvQrCMACEY1pjIYXqYG2aEiQKDoKDONtBURcFIe2iXSr4Myi0QaxTBcHZxcHHcPPxrIuDi37HccMtHwD/AvOwUGrobUy0Kshl+aZYxy332nx2DrW7gqD2OSqmWfaEGI827t6/DR678/oSBHN/EYYzSikBnHN2StN4OO1PeqLrxVG0PCbJVkq5YoxRoKoqpLZtOA41stVtQvC7xLIwQkj5Kf8CEi0bWzA9qscAAAAASUVORK5CYII="},z=({onBackToCustomer:a})=>{let[b,c]=(0,h.useState)(""),[d,e]=(0,h.useState)(""),[f,i]=(0,h.useState)(""),[j,k]=(0,h.useState)(!1),[l,m]=(0,h.useState)(!1),[n,o]=(0,h.useState)(""),[p,q]=(0,h.useState)(""),[r,s]=(0,h.useState)(""),{login:t,addItem:u,data:v}=w(),x=a=>{if(a.preventDefault(),j){let a=v.customers.find(a=>a.email===b&&a.password===d);if(a){let b={...a,role:"customer"};t(a.email,a.password,b),i("")}else i("Invalid customer credentials")}else t(b,d)?i(""):i("Invalid credentials")};return j?(0,g.jsxs)("div",{className:"min-h-screen bg-blue-600 flex",children:[(0,g.jsx)("div",{className:"hidden lg:flex lg:w-1/2 bg-blue-600 items-center justify-center p-8",children:(0,g.jsxs)("div",{className:"text-center text-white",children:[(0,g.jsx)("div",{className:"bg-white rounded-2xl p-6 inline-block mb-6 shadow-2xl",children:(0,g.jsx)("img",{src:y,alt:"MJ POWER Solar",className:"w-32 h-auto"})}),(0,g.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"MJ POWER Solar"}),(0,g.jsx)("p",{className:"text-xl text-blue-100 mb-8",children:"Your trusted partner in clean energy solutions"}),(0,g.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,g.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg",children:[(0,g.jsx)("div",{className:"text-2xl mb-2",children:"ðŸŒž"}),(0,g.jsx)("div",{children:"Premium Solar Panels"})]}),(0,g.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg",children:[(0,g.jsx)("div",{className:"text-2xl mb-2",children:"âš¡"}),(0,g.jsx)("div",{children:"Expert Installation"})]}),(0,g.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg",children:[(0,g.jsx)("div",{className:"text-2xl mb-2",children:"ðŸ”§"}),(0,g.jsx)("div",{children:"24/7 Support"})]}),(0,g.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg",children:[(0,g.jsx)("div",{className:"text-2xl mb-2",children:"ðŸ’°"}),(0,g.jsx)("div",{children:"Best Prices"})]})]})]})}),(0,g.jsx)("div",{className:"w-full lg:w-1/2 bg-white flex items-center justify-center p-8",children:(0,g.jsxs)("div",{className:"w-full max-w-md",children:[(0,g.jsxs)("div",{className:"text-center mb-8",children:[(0,g.jsx)("div",{className:"lg:hidden bg-blue-600 rounded-xl p-3 inline-block mb-4",children:(0,g.jsx)("img",{src:y,alt:"MJ POWER Solar",className:"w-16 h-auto"})}),(0,g.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Fixed Text"}),(0,g.jsx)("p",{className:"text-gray-600",children:"Fixed Text"})]}),(0,g.jsxs)("form",{onSubmit:l?a=>{(a.preventDefault(),v.customers.find(a=>a.email===b))?i("Customer with this email already exists"):(u("customers",{name:n,email:b,phone:p,address:r,password:d,assignedTo:"",assignedType:"partner"}),i(""),m(!1),o(""),q(""),s(""),c(""),e(""),alert("Registration successful! You can now login."))}:x,className:"space-y-4",children:[l&&(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"Full Name"}),(0,g.jsx)("input",{type:"text",placeholder:"Enter your full name",value:n,onChange:a=>o(a.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900",required:!0})]}),l&&(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"Phone Number"}),(0,g.jsx)("input",{type:"tel",placeholder:"Enter your phone number",value:p,onChange:a=>q(a.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900",required:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"Email Address"}),(0,g.jsx)("input",{type:"email",placeholder:"Enter your email",value:b,onChange:a=>c(a.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900",required:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"Password"}),(0,g.jsx)("input",{type:"password",placeholder:"Enter your password",value:d,onChange:a=>e(a.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900",required:!0})]}),f&&(0,g.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg text-center",children:f}),l&&(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"Installation Address"}),(0,g.jsx)("textarea",{placeholder:"Enter your address for solar installation",value:r,onChange:a=>s(a.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900",rows:3})]}),(0,g.jsx)("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition-all duration-200 shadow-md hover:shadow-lg",children:"Fixed Text"}),l&&(0,g.jsx)("button",{type:"button",onClick:()=>{m(!1),o(""),q(""),s(""),c(""),e(""),i("")},className:"w-full mt-3 bg-gray-500 hover:bg-gray-600 text-white font-semibold py-3 rounded-lg transition-all duration-200",children:"Cancel"})]}),(0,g.jsxs)("div",{className:"mt-6 text-center space-y-3",children:[!l&&(0,g.jsx)("button",{onClick:()=>{a?a():(k(!j),i(""),c(""),e(""))},className:"text-blue-600 hover:text-blue-800 text-sm font-medium underline",children:"Back to Customer Portal"}),!l&&(0,g.jsx)("div",{children:(0,g.jsx)("button",{onClick:()=>{m(!0),i("")},className:"text-blue-600 hover:text-blue-800 text-sm font-medium underline",children:"New customer? Create account"})})]})]})})]}):(0,g.jsxs)("div",{className:"min-h-screen bg-white flex items-center justify-center p-4",children:[(0,g.jsxs)("div",{className:"absolute inset-0 opacity-10",children:[(0,g.jsx)("div",{className:"absolute top-10 left-10 w-32 h-32 border-4 border-yellow-400 rotate-12"}),(0,g.jsx)("div",{className:"absolute bottom-20 right-20 w-40 h-40 border-4 border-yellow-400 -rotate-12"}),(0,g.jsx)("div",{className:"absolute top-1/2 left-1/4 w-24 h-24 border-4 border-green-400 rotate-45"})]}),(0,g.jsxs)("div",{className:"w-full max-w-md relative z-10",children:[(0,g.jsxs)("div",{className:"text-center mb-6 sm:mb-8",children:[(0,g.jsx)("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-2xl p-3 sm:p-4 inline-block mb-4 sm:mb-6 shadow-2xl",children:(0,g.jsx)("img",{src:y,alt:"MJ POWER Solar",className:"w-24 sm:w-32 h-auto"})}),(0,g.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-black mb-2 drop-shadow-lg",children:"Solar Staff Portal"}),(0,g.jsx)("p",{className:"text-sm sm:text-base text-gray-700",children:"Power the future with solar"})]}),(0,g.jsxs)("form",{onSubmit:x,className:"bg-white rounded-2xl p-6 sm:p-8 shadow-xl border border-gray-200 space-y-4 sm:space-y-5",children:[(0,g.jsxs)("div",{children:[(0,g.jsxs)("label",{className:"block text-blue-900 font-semibold mb-2 text-sm sm:text-base flex items-center",children:[(0,g.jsx)("span",{className:"mr-2",children:"ðŸ‘¤"})," Username"]}),(0,g.jsx)("input",{type:"text",placeholder:"Enter your username",value:b,onChange:a=>c(a.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 bg-blue-50 border-2 border-blue-200 rounded-lg text-gray-800 focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-200 text-sm sm:text-base transition-all",required:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsxs)("label",{className:"block text-blue-900 font-semibold mb-2 text-sm sm:text-base flex items-center",children:[(0,g.jsx)("span",{className:"mr-2",children:"ðŸ”’"})," Password"]}),(0,g.jsx)("input",{type:"password",placeholder:"Enter your password",value:d,onChange:a=>e(a.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 bg-blue-50 border-2 border-blue-200 rounded-lg text-gray-800 focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-200 text-sm sm:text-base transition-all",required:!0})]}),f&&(0,g.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-3 sm:px-4 py-2 sm:py-3 rounded-lg text-center text-sm sm:text-base",children:f}),(0,g.jsx)("div",{className:"pt-2 sm:pt-4",children:(0,g.jsxs)("button",{type:"submit",className:"w-full bg-gradient-to-r from-orange-600 to-orange-500 text-white font-bold py-3 sm:py-4 rounded-lg hover:from-orange-700 hover:to-orange-600 text-sm sm:text-base shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 flex items-center justify-center",children:[(0,g.jsx)("span",{className:"mr-2",children:"âš¡"}),"Staff Login"]})})]}),(0,g.jsx)("div",{className:"mt-6 text-center space-y-3",children:(0,g.jsx)("button",{onClick:()=>{a?a():(k(!j),i(""),c(""),e(""))},className:"text-black hover:text-blue-600 text-sm font-semibold bg-gray-100 px-6 py-2 rounded-full hover:bg-gray-200 transition-all duration-200",children:"ðŸ  Back to Customer Portal"})})]})]})},A=({children:a})=>{let{currentUser:b,logout:c,setCurrentPage:d}=w(),[e,f]=(0,h.useState)("Dashboard"),[i,j]=(0,h.useState)(!1),[k,l]=(0,h.useState)(!1);return(0,g.jsxs)("div",{className:"min-h-screen bg-gray-50 text-gray-900 flex relative",children:[(0,g.jsx)("div",{className:"lg:hidden fixed top-0 left-0 right-0 z-50 bg-white border-b border-gray-200 p-2 shadow-sm",children:(0,g.jsx)("button",{onClick:()=>j(!i),className:"bg-white/10 backdrop-blur-sm p-2 rounded-lg border border-yellow-400 hover:bg-white/20 transition-all",children:(0,g.jsx)("span",{className:"text-yellow-300 text-xl",children:"â˜°"})})}),(0,g.jsx)("div",{className:"hidden lg:block fixed top-2 left-2 z-50",children:(0,g.jsx)("button",{onClick:()=>l(!k),className:"bg-white/10 backdrop-blur-sm p-2 rounded-lg border border-yellow-400 hover:bg-white/20 transition-all",children:(0,g.jsx)("span",{className:"text-yellow-300 text-lg",children:"â˜°"})})}),i&&(0,g.jsx)("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>j(!1)}),(0,g.jsxs)("div",{className:`fixed inset-y-0 left-0 z-40 w-64 bg-white border-r border-gray-200 flex flex-col h-screen overflow-y-auto transition-transform duration-300 ease-in-out shadow-lg ${i?"translate-x-0":"-translate-x-full"} lg:translate-x-0 ${k?"lg:-translate-x-full":""}`,children:[(0,g.jsxs)("div",{className:"flex-1 p-1 lg:p-2",children:[(0,g.jsx)("div",{className:"flex justify-center mb-2",children:(0,g.jsx)("div",{className:"bg-orange-500 p-2 rounded-xl flex items-center justify-center",children:(0,g.jsx)("span",{className:"text-white font-bold text-xl",children:"MJ"})})}),(0,g.jsx)("nav",{children:(0,g.jsx)("ul",{className:"space-y-0.5 lg:space-y-1",children:({admin:[{name:"Dashboard",icon:"â˜€ï¸"},{name:"Customers",icon:"ðŸ‘¥"},{name:"Products",icon:"ðŸ”‹"},{name:"Services",icon:"âš¡"},{name:"Quotes",icon:"ðŸ“‹"},{name:"Tickets",icon:"ðŸŽ«"},{name:"Add Technician",icon:"ðŸ‘¨ðŸ”§"},{name:"Add Partner",icon:"ðŸ¤"},{name:"Reports",icon:"ðŸ“Š"}],manager:[{name:"Dashboard",icon:"â˜€ï¸"},{name:"Tickets",icon:"ðŸŽ«"},{name:"Reports",icon:"ðŸ“Š"}],partner:[{name:"Dashboard",icon:"â˜€ï¸"},{name:"Customers",icon:"ðŸ‘¥"},{name:"Tickets",icon:"ðŸŽ«"}],technician:[{name:"Dashboard",icon:"â˜€ï¸"},{name:"Tickets",icon:"ðŸŽ«"}]})[b?.role]?.map(a=>(0,g.jsx)("li",{children:(0,g.jsxs)("button",{onClick:()=>{f(a.name),d(a.name.toLowerCase()),j(!1)},className:`w-full flex items-center gap-1.5 lg:gap-2 px-2 lg:px-3 py-1.5 lg:py-2 rounded-lg transition-all duration-200 ${e===a.name?"bg-orange-200 text-orange-800 shadow-sm":"text-gray-700 hover:bg-gray-100"}`,children:[(0,g.jsx)("span",{className:"text-sm lg:text-base",children:a.icon}),(0,g.jsx)("span",{className:"font-medium text-xs",children:a.name})]})},a.name))})})]}),(0,g.jsx)("div",{className:"p-1.5 lg:p-2 border-t border-gray-200",children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"text-xs font-medium text-gray-900",children:b?.name}),(0,g.jsx)("p",{className:"text-xs text-gray-600 capitalize",children:b?.role})]}),(0,g.jsx)("button",{onClick:c,className:"bg-red-500 hover:bg-red-600 text-white px-1.5 py-0.5 rounded text-xs transition-all",children:"Logout"})]})})]}),(0,g.jsx)("div",{className:`flex-1 overflow-y-auto transition-all duration-300 ${k?"lg:ml-0":"lg:ml-64"} ml-0`,children:(0,g.jsx)("main",{className:"p-3 sm:p-4 lg:p-6 pt-16 lg:pt-6",children:a})})]})},B=()=>{let{data:a,addItem:b,updateItem:c,deleteItem:d,currentUser:e}=w(),[f,i]=(0,h.useState)(!1),[j,k]=(0,h.useState)(null),[l,m]=(0,h.useState)({name:"",email:"",phone:"",address:"",assignedTo:"",assignedType:"partner"}),n=["admin","partner"].includes(e?.role),o=async a=>{a.preventDefault();try{j?await c("customers",j.id,l):await b("customers",l),p()}catch(a){console.error("Error saving customer:",a),alert("Failed to save customer. Please try again.")}},p=()=>{m({name:"",email:"",phone:"",address:"",assignedTo:"",assignedType:"partner"}),i(!1),k(null)},q=a=>{m(a),k(a),i(!0)};return(0,g.jsxs)("div",{className:"p-2 sm:p-4",children:[(0,g.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 sm:mb-6 gap-3",children:[(0,g.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Customers"}),n&&(0,g.jsx)("button",{onClick:()=>i(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 sm:px-4 sm:py-2 rounded-lg text-sm sm:text-base",children:"Add Customer"})]}),f&&n&&(0,g.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200 mb-6",children:[(0,g.jsx)("h3",{className:"text-lg font-semibold mb-4",children:j?"Edit Customer":"Add Customer"}),(0,g.jsxs)("form",{onSubmit:o,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,g.jsx)("input",{type:"text",placeholder:"Customer Name",value:l.name,onChange:a=>m({...l,name:a.target.value}),className:"p-3 border border-gray-300 rounded-lg",required:!0}),(0,g.jsx)("input",{type:"email",placeholder:"Email",value:l.email,onChange:a=>m({...l,email:a.target.value}),className:"p-3 border border-gray-300 rounded-lg",required:!0}),(0,g.jsx)("input",{type:"tel",placeholder:"Phone",value:l.phone,onChange:a=>m({...l,phone:a.target.value}),className:"p-3 border border-gray-300 rounded-lg",required:!0}),(0,g.jsxs)("select",{value:l.assignedType,onChange:a=>m({...l,assignedType:a.target.value}),className:"p-3 border border-gray-300 rounded-lg",children:[(0,g.jsx)("option",{value:"partner",children:"Partner"}),(0,g.jsx)("option",{value:"technician",children:"Technician"})]}),(0,g.jsx)("textarea",{placeholder:"Address",value:l.address,onChange:a=>m({...l,address:a.target.value}),className:"md:col-span-2 p-3 border border-gray-300 rounded-lg",rows:3}),(0,g.jsxs)("div",{className:"md:col-span-2 flex gap-2",children:[(0,g.jsx)("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg",children:j?"Update Customer":"Add Customer"}),(0,g.jsx)("button",{type:"button",onClick:p,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg",children:"Cancel"})]})]})]}),(0,g.jsx)("div",{className:"block sm:hidden space-y-3",children:a.customers?.map(a=>(0,g.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,g.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,g.jsx)("h3",{className:"font-semibold text-gray-900",children:a.name}),n&&(0,g.jsxs)("div",{className:"flex gap-2",children:[(0,g.jsx)("button",{onClick:()=>q(a),className:"bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs",children:"Edit"}),(0,g.jsx)("button",{onClick:()=>d("customers",a.id),className:"bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs",children:"Delete"})]})]}),(0,g.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:a.email}),(0,g.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:a.phone}),(0,g.jsxs)("p",{className:"text-xs text-gray-500",children:[a.assignedTo," (",a.assignedType,")"]})]},a.id))}),(0,g.jsx)("div",{className:"hidden sm:block bg-white rounded-lg border border-gray-200 overflow-x-auto",children:(0,g.jsxs)("table",{className:"w-full",children:[(0,g.jsx)("thead",{className:"bg-gray-50",children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Name"}),(0,g.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Email"}),(0,g.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Phone"}),(0,g.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Assigned To"}),n&&(0,g.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Actions"})]})}),(0,g.jsx)("tbody",{children:a.customers?.map(a=>(0,g.jsxs)("tr",{className:"border-t",children:[(0,g.jsx)("td",{className:"p-3 text-sm",children:a.name}),(0,g.jsx)("td",{className:"p-3 text-sm",children:a.email}),(0,g.jsx)("td",{className:"p-3 text-sm",children:a.phone}),(0,g.jsxs)("td",{className:"p-3 text-sm",children:[a.assignedTo," (",a.assignedType,")"]}),n&&(0,g.jsxs)("td",{className:"p-3",children:[(0,g.jsx)("button",{onClick:()=>q(a),className:"bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded mr-2 text-sm",children:"Edit"}),(0,g.jsx)("button",{onClick:()=>d("customers",a.id),className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm",children:"Delete"})]})]},a.id))})]})})]})};function C(a){return a?a.startsWith("http://")||a.startsWith("https://")?a:`https://uploads.backendservices.in/storage/admin/packages/${a}`:""}async function D(a){console.log("ðŸ–¼ï¸ Starting image upload..."),console.log("File:",a.name,"Size:",a.size,"Type:",a.type),console.log("Upload URL:","https://uploads.backendservices.in/api");let b=new FormData;b.append("folder","packages"),b.append("image",a);try{console.log("ðŸ“¤ Sending upload request...");let a=await fetch("https://uploads.backendservices.in/api",{method:"POST",headers:{username:"admin",password:"arodos"},body:b});if(console.log("ðŸ“¥ Upload response status:",a.status),console.log("ðŸ“¥ Upload response ok:",a.ok),!a.ok){let b=await a.text();throw console.error("âŒ Upload failed response:",b),Error(`Upload failed with status ${a.status}: ${b}`)}let c=await a.json();console.log("âœ… Upload response data:",c);let d=c?.files?.image;if(console.log("ðŸ“ Image path from response:",d),!d)return console.error("âŒ No image path in response"),null;let e=d.split("/"),f=e[e.length-1]||null;return console.log("ðŸ“„ Final filename:",f),f}catch(a){return console.error("âŒ Upload Error:",a.message),console.error("âŒ Full error:",a),null}}let E=()=>{let{data:a,addItem:b,updateItem:c,deleteItem:d,currentUser:e}=w(),[f,i]=(0,h.useState)(!1),[j,k]=(0,h.useState)(null),[l,m]=(0,h.useState)({name:"",category:"",price:"",description:"",specifications:"",image:"",gstPercent:"18",partnerCommissionPercent:"10",technicianCommissionPercent:"5"}),[n,o]=(0,h.useState)(!1),p=["admin","manager"].includes(e?.role),q=a.categories?.filter(a=>"product"===a.type)||[],r=async a=>{let b=a.target.files[0];if(b){o(!0);try{let a=await D(b);m({...l,image:a||""})}catch(a){alert("Image upload failed")}o(!1)}};(0,h.useEffect)(()=>{},[]);let s=async a=>{a.preventDefault();let d={name:l.name,category:l.category,price:parseFloat(l.price),description:l.description||"",specifications:l.specifications||"",image:l.image||"",gstPercent:parseFloat(l.gstPercent),partnerCommissionPercent:parseFloat(l.partnerCommissionPercent),technicianCommissionPercent:parseFloat(l.technicianCommissionPercent)};console.log("Submitting product data:",d);try{if(j)await c("products",j.id,d),console.log("Product updated successfully");else{let a=await b("products",d);console.log("Product added successfully:",a)}t()}catch(a){console.error("Error saving product:",a),alert("Error saving product. Check console for details.")}},t=()=>{m({name:"",category:"",price:"",description:"",specifications:"",image:"",gstPercent:"18",partnerCommissionPercent:"10",technicianCommissionPercent:"5"}),i(!1),k(null)},u=a=>{m(a),k(a),i(!0)};return(0,g.jsxs)("div",{className:"p-2",children:[(0,g.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-2 relative z-10",children:[(0,g.jsxs)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 flex items-center",children:[(0,g.jsx)("span",{className:"mr-2",children:"ðŸ”‹"})," Solar Products"]}),p&&(0,g.jsx)("button",{onClick:()=>i(!0),className:"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-700 hover:to-green-600 text-white px-4 py-2 rounded-lg font-semibold shadow-lg transition-all w-full sm:w-auto whitespace-nowrap",children:"+ Add Product"})]}),f&&p&&(0,g.jsxs)("div",{className:"bg-white/10 backdrop-blur-xl border border-yellow-400/30 p-4 sm:p-6 rounded-xl mb-4 shadow-lg relative z-10",children:[(0,g.jsx)("h3",{className:"text-lg font-semibold text-yellow-300 mb-4",children:j?"Edit Product":"Add Product"}),(0,g.jsxs)("form",{onSubmit:s,className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,g.jsx)("input",{type:"text",placeholder:"Product Name (e.g., Solar Panel 500W)",value:l.name,onChange:a=>m({...l,name:a.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all",required:!0}),(0,g.jsxs)("div",{children:[(0,g.jsx)("input",{type:"file",accept:"image/*",onChange:r,className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 outline-none transition-all"}),n&&(0,g.jsx)("p",{className:"text-yellow-300 text-sm mt-1",children:"Uploading..."}),l.image&&(0,g.jsx)("img",{src:C(l.image),alt:"Preview",className:"mt-2 h-20 w-20 object-cover rounded"})]}),(0,g.jsxs)("select",{value:l.category,onChange:a=>m({...l,category:a.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all",required:!0,children:[(0,g.jsx)("option",{value:"",children:"Select Category"}),q.map((a,b)=>(0,g.jsx)("option",{value:a.name,children:a.name},a.id||b))]}),(0,g.jsx)("input",{type:"number",step:"0.01",placeholder:"Price (â‚¹)",value:l.price,onChange:a=>m({...l,price:a.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all",required:!0}),(0,g.jsx)("textarea",{placeholder:"Product Description",value:l.description,onChange:a=>m({...l,description:a.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all",rows:3}),(0,g.jsx)("textarea",{placeholder:"Technical Specifications",value:l.specifications,onChange:a=>m({...l,specifications:a.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all",rows:2}),(0,g.jsx)("input",{type:"number",step:"0.01",placeholder:"GST %",value:l.gstPercent,onChange:a=>m({...l,gstPercent:a.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all"}),(0,g.jsx)("input",{type:"number",step:"0.01",placeholder:"Partner Commission %",value:l.partnerCommissionPercent,onChange:a=>m({...l,partnerCommissionPercent:a.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all"}),(0,g.jsx)("input",{type:"number",step:"0.01",placeholder:"Technician Commission %",value:l.technicianCommissionPercent,onChange:a=>m({...l,technicianCommissionPercent:a.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all"}),(0,g.jsxs)("div",{className:"sm:col-span-2 flex flex-col sm:flex-row gap-2",children:[(0,g.jsx)("button",{type:"submit",className:"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-700 hover:to-green-600 text-white px-4 py-2 rounded-lg font-semibold shadow-lg transition-all",children:j?"Update Product":"Add Product"}),(0,g.jsx)("button",{type:"button",onClick:t,className:"bg-gradient-to-r from-gray-600 to-gray-500 hover:from-gray-700 hover:to-gray-600 text-white px-4 py-2 rounded-lg font-semibold shadow-md transition-all",children:"Cancel"})]})]})]}),(0,g.jsx)("div",{className:"hidden md:block bg-white border border-gray-200 rounded-xl overflow-hidden shadow-lg",children:(0,g.jsxs)("table",{className:"w-full",children:[(0,g.jsx)("thead",{className:"bg-gray-50",children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Product Name"}),(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Category"}),(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Price"}),(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"GST %"}),(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Partner %"}),(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Tech %"}),p&&(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Actions"})]})}),(0,g.jsx)("tbody",{children:a.products?.length>0?a.products.map(a=>{let b=a.image&&""!==a.image.trim();return(0,g.jsxs)("tr",{className:"border-t border-gray-200 hover:bg-gray-50 transition-all",children:[(0,g.jsx)("td",{className:"p-3 text-gray-900",children:(0,g.jsxs)("div",{className:"flex items-center gap-2",children:[b?(0,g.jsx)("img",{src:C(a.image),alt:a.name,className:"h-10 w-10 object-cover rounded"}):(0,g.jsx)("div",{className:"h-10 w-10 rounded bg-white/10 flex items-center justify-center text-xs text-blue-200",children:"No Img"}),a.name]})}),(0,g.jsx)("td",{className:"p-3 text-gray-700",children:a.category}),(0,g.jsxs)("td",{className:"p-3 text-green-600 font-semibold",children:["â‚¹",a.price]}),(0,g.jsxs)("td",{className:"p-3 text-gray-700",children:[a.gstPercent,"%"]}),(0,g.jsxs)("td",{className:"p-3 text-gray-700",children:[a.partnerCommissionPercent,"%"]}),(0,g.jsxs)("td",{className:"p-3 text-gray-700",children:[a.technicianCommissionPercent,"%"]}),p&&(0,g.jsxs)("td",{className:"p-3 whitespace-nowrap",children:[(0,g.jsx)("button",{onClick:()=>u(a),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-lg mr-2 text-sm transition-all",children:"Edit"}),(0,g.jsx)("button",{onClick:()=>d("products",a.id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-lg text-sm transition-all",children:"Delete"})]})]},a.id)}):(0,g.jsx)("tr",{children:(0,g.jsx)("td",{colSpan:p?7:6,className:"p-6 text-center text-gray-500",children:'No solar products added yet. Click "Add Product" to get started.'})})})]})}),(0,g.jsx)("div",{className:"md:hidden space-y-3",children:a.products?.length>0?a.products.map(a=>(0,g.jsx)("div",{className:"bg-white border border-gray-200 p-4 rounded-xl shadow-lg",children:(0,g.jsxs)("div",{className:"space-y-2",children:[a.image&&(0,g.jsx)("img",{src:C(a.image),alt:a.name,className:"h-32 w-full object-cover rounded"}),(0,g.jsx)("div",{children:(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:a.name})}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Category: "}),(0,g.jsx)("span",{className:"text-gray-800",children:a.category})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Price: "}),(0,g.jsxs)("span",{className:"text-green-600 font-bold",children:["â‚¹",a.price]})]}),(0,g.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"GST: "}),(0,g.jsxs)("span",{className:"text-gray-800",children:[a.gstPercent,"%"]})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Partner: "}),(0,g.jsxs)("span",{className:"text-gray-800",children:[a.partnerCommissionPercent,"%"]})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Tech: "}),(0,g.jsxs)("span",{className:"text-gray-800",children:[a.technicianCommissionPercent,"%"]})]})]}),p&&(0,g.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,g.jsx)("button",{onClick:()=>u(a),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg flex-1 text-sm transition-all",children:"Edit"}),(0,g.jsx)("button",{onClick:()=>d("products",a.id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-lg flex-1 text-sm transition-all",children:"Delete"})]})]})},a.id)):(0,g.jsx)("div",{className:"bg-white border border-gray-200 p-6 rounded-xl text-center text-gray-500",children:'No solar products added yet. Click "Add Product" to get started.'})})]})},F=()=>{let{data:a,addItem:b,updateItem:c,deleteItem:d,currentUser:e}=w(),[f,i]=(0,h.useState)(!1),[j,k]=(0,h.useState)(null),[l,m]=(0,h.useState)({name:"",category:"",price:"",description:"",duration:"",includes:""}),n=["admin","manager"].includes(e?.role),o=a.categories.filter(a=>"service"===a.type),p=()=>{m({name:"",category:"",price:"",description:"",duration:"",includes:""}),i(!1),k(null)},q=a=>{m({name:a.name||"",category:a.category||"",price:a.price?.toString()||"",description:a.description||"",duration:a.duration||"",includes:a.includes||""}),k(a),i(!0)};return(0,g.jsxs)("div",{className:"p-2",children:[(0,g.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-2 relative z-10",children:[(0,g.jsx)("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Services"}),n&&(0,g.jsx)("button",{onClick:()=>i(!0),className:"btn-primary px-4 py-2 rounded w-full sm:w-auto text-sm whitespace-nowrap",children:"Add Service"})]}),f&&n&&(0,g.jsxs)("div",{className:"glass-form p-3 sm:p-4 rounded-lg mb-4 relative z-10",children:[(0,g.jsx)("h3",{className:"text-base font-semibold text-green-400 mb-3",children:j?"Edit Service":"Add Service"}),(0,g.jsxs)("form",{onSubmit:a=>{a.preventDefault();let d={name:l.name,category:l.category,price:parseFloat(l.price),description:l.description,duration:l.duration,includes:l.includes};j?c("services",j.id,d):b("services",d),p()},className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,g.jsx)("input",{type:"text",placeholder:"Service Name",value:l.name,onChange:a=>m({...l,name:a.target.value}),className:"p-2 bg-gray-700 text-green-100 rounded border border-green-600 text-sm",required:!0}),(0,g.jsxs)("select",{value:l.category,onChange:a=>m({...l,category:a.target.value}),className:"p-2 bg-gray-700 text-green-100 rounded border border-green-600 text-sm",required:!0,children:[(0,g.jsx)("option",{value:"",className:"bg-gray-700 text-green-100",children:"Select Category"}),o.map(a=>(0,g.jsx)("option",{value:a.name,className:"bg-gray-700 text-green-100",children:a.name},a.id))]}),(0,g.jsx)("input",{type:"number",step:"0.01",placeholder:"Price",value:l.price,onChange:a=>m({...l,price:a.target.value}),className:"p-2 bg-gray-700 text-green-100 rounded border border-green-600 text-sm",required:!0}),(0,g.jsx)("input",{type:"text",placeholder:"Duration (e.g., 2-3 hours)",value:l.duration,onChange:a=>m({...l,duration:a.target.value}),className:"p-2 bg-gray-700 text-green-100 rounded border border-green-600 text-sm"}),(0,g.jsx)("textarea",{placeholder:"Description",value:l.description,onChange:a=>m({...l,description:a.target.value}),className:"p-2 bg-gray-700 text-green-100 rounded border border-green-600 text-sm",rows:2}),(0,g.jsx)("textarea",{placeholder:"What's included",value:l.includes,onChange:a=>m({...l,includes:a.target.value}),className:"p-2 bg-gray-700 text-green-100 rounded border border-green-600 text-sm",rows:2}),(0,g.jsxs)("div",{className:"sm:col-span-2 flex flex-col sm:flex-row gap-2",children:[(0,g.jsx)("button",{type:"submit",className:"btn-primary px-3 py-1.5 rounded text-sm",children:j?"Update Service":"Add Service"}),(0,g.jsx)("button",{type:"button",onClick:p,className:"btn-secondary px-3 py-1.5 rounded text-sm",children:"Cancel"})]})]})]}),(0,g.jsx)("div",{className:"hidden md:block bg-white border border-gray-200 rounded-lg",children:(0,g.jsxs)("table",{className:"w-full",children:[(0,g.jsx)("thead",{className:"bg-gray-50",children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{className:"p-2 text-left text-gray-900 text-sm",children:"Name"}),(0,g.jsx)("th",{className:"p-2 text-left text-gray-900 text-sm",children:"Category"}),(0,g.jsx)("th",{className:"p-2 text-left text-gray-900 text-sm",children:"Price"}),(0,g.jsx)("th",{className:"p-2 text-left text-gray-900 text-sm",children:"Duration"}),(0,g.jsx)("th",{className:"p-2 text-left text-gray-900 text-sm",children:"Description"}),n&&(0,g.jsx)("th",{className:"p-2 text-left text-gray-900 text-sm",children:"Actions"})]})}),(0,g.jsx)("tbody",{children:a.services?.map(a=>(0,g.jsxs)("tr",{className:"border-t border-gray-200",children:[(0,g.jsx)("td",{className:"p-2 text-gray-900 text-sm",children:a.name}),(0,g.jsx)("td",{className:"p-2 text-gray-700 text-sm",children:a.category}),(0,g.jsxs)("td",{className:"p-2 text-green-600 text-sm",children:["â‚¹",a.price]}),(0,g.jsx)("td",{className:"p-2 text-gray-700 text-sm",children:a.duration}),(0,g.jsx)("td",{className:"p-2 text-gray-700 text-sm",children:a.description}),n&&(0,g.jsxs)("td",{className:"p-2",children:[(0,g.jsx)("button",{onClick:()=>q(a),className:"btn-info px-2 py-1 rounded mr-1 text-xs",children:"Edit"}),(0,g.jsx)("button",{onClick:()=>d("services",a.id),className:"btn-danger px-2 py-1 rounded text-xs",children:"Delete"})]})]},a.id))})]})}),(0,g.jsx)("div",{className:"md:hidden space-y-2",children:a.services?.map(a=>(0,g.jsx)("div",{className:"bg-white border border-gray-200 p-3 rounded-lg",children:(0,g.jsxs)("div",{className:"space-y-2",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Name: "}),(0,g.jsx)("span",{className:"text-gray-900",children:a.name})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Category: "}),(0,g.jsx)("span",{className:"text-gray-800",children:a.category})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Price: "}),(0,g.jsxs)("span",{className:"text-green-600",children:["â‚¹",a.price]})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Duration: "}),(0,g.jsx)("span",{className:"text-gray-800",children:a.duration})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Description: "}),(0,g.jsx)("span",{className:"text-gray-800",children:a.description})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Includes: "}),(0,g.jsx)("span",{className:"text-gray-800",children:a.includes})]}),n&&(0,g.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,g.jsx)("button",{onClick:()=>q(a),className:"btn-info px-2 py-1 rounded flex-1 text-xs",children:"Edit"}),(0,g.jsx)("button",{onClick:()=>d("services",a.id),className:"btn-danger px-2 py-1 rounded flex-1 text-xs",children:"Delete"})]})]})},a.id))})]})},G=()=>{let{data:a,updateItem:b,deleteItem:c,currentUser:d}=w(),[e,f]=(0,h.useState)("all"),i=["admin","manager"].includes(d?.role),j=a.quotes?.filter(a=>"all"===e||a.status===e)||[],k=(a,c)=>{b("orders",a,{status:c})},l=a=>{switch(a){case"completed":return"bg-green-100 text-green-800";case"in-progress":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return(0,g.jsxs)("div",{className:"p-2",children:[(0,g.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-2",children:[(0,g.jsxs)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 flex items-center",children:[(0,g.jsx)("span",{className:"mr-2",children:"ðŸ“‹"})," Customer Quotes"]}),(0,g.jsxs)("select",{value:e,onChange:a=>f(a.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900",children:[(0,g.jsx)("option",{value:"all",children:"All Quotes"}),(0,g.jsx)("option",{value:"pending",children:"Pending"}),(0,g.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,g.jsx)("option",{value:"completed",children:"Completed"}),(0,g.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),(0,g.jsx)("div",{className:"hidden md:block bg-white border border-gray-200 rounded-xl overflow-hidden shadow-lg",children:(0,g.jsxs)("table",{className:"w-full",children:[(0,g.jsx)("thead",{className:"bg-gray-50",children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Quote ID"}),(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Customer"}),(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Email"}),(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Phone"}),(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Address"}),(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Items"}),(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Subtotal"}),(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Tax"}),(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Total"}),(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Date"}),i&&(0,g.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Actions"})]})}),(0,g.jsx)("tbody",{children:j.length>0?j.map(a=>(0,g.jsxs)("tr",{className:"border-t border-gray-200 hover:bg-gray-50 transition-all",children:[(0,g.jsxs)("td",{className:"p-3 text-gray-900 font-medium",children:["#",a.id]}),(0,g.jsx)("td",{className:"p-3 text-gray-700",children:a.name}),(0,g.jsx)("td",{className:"p-3 text-gray-700",children:a.email}),(0,g.jsx)("td",{className:"p-3 text-gray-700",children:a.phone}),(0,g.jsx)("td",{className:"p-3 text-gray-700 max-w-xs truncate",title:a.address,children:a.address}),(0,g.jsx)("td",{className:"p-3 text-gray-700",children:(0,g.jsx)("div",{className:"max-w-xs",children:a.items?.map((a,b)=>(0,g.jsxs)("div",{className:"text-sm",children:[a.name," - â‚¹",a.price," x ",a.quantity]},b))})}),(0,g.jsxs)("td",{className:"p-3 text-gray-700",children:["â‚¹",a.subtotal]}),(0,g.jsxs)("td",{className:"p-3 text-gray-700",children:["â‚¹",a.tax]}),(0,g.jsxs)("td",{className:"p-3 text-green-600 font-semibold",children:["â‚¹",a.totalAmount]}),(0,g.jsx)("td",{className:"p-3 text-gray-700",children:new Date(a.created_at||Date.now()).toLocaleDateString()}),(0,g.jsx)("td",{className:"p-3",children:(0,g.jsx)("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${l(a.status)}`,children:a.status})}),(0,g.jsx)("td",{className:"p-3 text-gray-700",children:a.createdAt}),i&&(0,g.jsxs)("td",{className:"p-3 whitespace-nowrap",children:[(0,g.jsxs)("select",{value:a.status,onChange:b=>k(a.id,b.target.value),className:"text-sm border border-gray-300 rounded px-2 py-1 mr-2",children:[(0,g.jsx)("option",{value:"pending",children:"Pending"}),(0,g.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,g.jsx)("option",{value:"completed",children:"Completed"}),(0,g.jsx)("option",{value:"cancelled",children:"Cancelled"})]}),(0,g.jsx)("button",{onClick:()=>c("quotes",a.id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-lg text-sm transition-all",children:"Delete"})]})]},a.id)):(0,g.jsx)("tr",{children:(0,g.jsx)("td",{colSpan:i?11:10,className:"p-6 text-center text-gray-500",children:"No quotes found for the selected filter."})})})]})}),(0,g.jsx)("div",{className:"md:hidden space-y-3",children:j.length>0?j.map(a=>(0,g.jsx)("div",{className:"bg-white border border-gray-200 p-4 rounded-xl shadow-lg",children:(0,g.jsxs)("div",{className:"space-y-2",children:[(0,g.jsxs)("div",{className:"flex justify-between items-start",children:[(0,g.jsxs)("span",{className:"text-gray-700 font-semibold",children:["Order #",a.id]}),(0,g.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${l(a.status)}`,children:a.status})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Customer: "}),(0,g.jsx)("span",{className:"text-gray-900",children:a.customerName})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Item: "}),(0,g.jsx)("span",{className:"text-gray-900",children:a.itemName})]}),(0,g.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Type: "}),(0,g.jsx)("span",{className:"text-gray-800 capitalize",children:a.type})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Qty: "}),(0,g.jsx)("span",{className:"text-gray-800",children:a.quantity||1})]})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Total: "}),(0,g.jsxs)("span",{className:"text-green-600 font-bold",children:["â‚¹",a.totalPrice||a.itemPrice]})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-gray-700 font-semibold",children:"Date: "}),(0,g.jsx)("span",{className:"text-gray-800",children:a.createdAt})]}),i&&(0,g.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,g.jsxs)("select",{value:a.status,onChange:b=>k(a.id,b.target.value),className:"flex-1 text-sm border border-gray-300 rounded px-2 py-2",children:[(0,g.jsx)("option",{value:"pending",children:"Pending"}),(0,g.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,g.jsx)("option",{value:"completed",children:"Completed"}),(0,g.jsx)("option",{value:"cancelled",children:"Cancelled"})]}),(0,g.jsx)("button",{onClick:()=>c("quotes",a.id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-lg text-sm transition-all",children:"Delete"})]})]})},a.id)):(0,g.jsx)("div",{className:"bg-white border border-gray-200 p-6 rounded-xl text-center text-gray-500",children:"No quotes found for the selected filter."})})]})},H=()=>{let{data:a,addItem:b,updateItem:c,deleteItem:d,currentUser:e}=w(),[f,i]=(0,h.useState)(!1),[j,k]=(0,h.useState)(null),[l,m]=(0,h.useState)({title:"",description:"",priority:"medium",status:"open",assignedTo:"",customerId:""}),n=()=>{m({title:"",description:"",priority:"medium",status:"open",assignedTo:"",customerId:""}),i(!1),k(null)},o=a=>{m(a),k(a),i(!0)};return(0,g.jsxs)("div",{className:"p-2 sm:p-4",children:[(0,g.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 sm:mb-6 gap-3",children:[(0,g.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Support Tickets"}),(0,g.jsx)("button",{onClick:()=>i(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 sm:px-4 sm:py-2 rounded-lg text-sm sm:text-base",children:"Create Ticket"})]}),f&&(0,g.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200 mb-6",children:[(0,g.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:[j?"Edit":"Add"," Item"]}),(0,g.jsxs)("form",{onSubmit:a=>{a.preventDefault();let d={...l,createdBy:e?.id,createdAt:new Date().toISOString()};j?c("tickets",j.id,d):b("tickets",d),n()},className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,g.jsx)("input",{type:"text",placeholder:"Ticket Title",value:l.title,onChange:a=>m({...l,title:a.target.value}),className:"p-3 border border-gray-300 rounded-lg",required:!0}),(0,g.jsxs)("select",{value:l.priority,onChange:a=>m({...l,priority:a.target.value}),className:"p-3 border border-gray-300 rounded-lg",children:[(0,g.jsx)("option",{value:"low",children:"Low"}),(0,g.jsx)("option",{value:"medium",children:"Medium"}),(0,g.jsx)("option",{value:"high",children:"High"}),(0,g.jsx)("option",{value:"urgent",children:"Urgent"})]}),(0,g.jsxs)("select",{value:l.customerId,onChange:a=>m({...l,customerId:a.target.value}),className:"p-3 border border-gray-300 rounded-lg",children:[(0,g.jsx)("option",{value:"",children:"Select Customer"}),a.customers?.map(a=>(0,g.jsx)("option",{value:a.id,children:a.name},a.id))]}),(0,g.jsxs)("select",{value:l.status,onChange:a=>m({...l,status:a.target.value}),className:"p-3 border border-gray-300 rounded-lg",children:[(0,g.jsx)("option",{value:"open",children:"Open"}),(0,g.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,g.jsx)("option",{value:"resolved",children:"Resolved"}),(0,g.jsx)("option",{value:"closed",children:"Closed"})]}),(0,g.jsx)("textarea",{placeholder:"Description",value:l.description,onChange:a=>m({...l,description:a.target.value}),className:"md:col-span-2 p-3 border border-gray-300 rounded-lg",rows:4,required:!0}),(0,g.jsxs)("div",{className:"md:col-span-2 flex gap-2",children:[(0,g.jsxs)("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg",children:[j?"Edit":"Add"," Item Ticket"]}),(0,g.jsx)("button",{type:"button",onClick:n,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg",children:"Cancel"})]})]})]}),(0,g.jsx)("div",{className:"block sm:hidden space-y-3",children:a.tickets?.map(b=>{let c=a.customers?.find(a=>a.id==b.customerId);return(0,g.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,g.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,g.jsx)("h3",{className:"font-semibold text-gray-900 text-sm",children:b.title}),(0,g.jsxs)("div",{className:"flex gap-1",children:[(0,g.jsx)("button",{onClick:()=>o(b),className:"bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs",children:"Edit"}),(0,g.jsx)("button",{onClick:()=>d("tickets",b.id),className:"bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs",children:"Delete"})]})]}),(0,g.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:c?.name||"N/A"}),(0,g.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,g.jsx)("span",{className:`px-2 py-1 rounded text-xs ${"urgent"===b.priority?"bg-red-100 text-red-800":"high"===b.priority?"bg-orange-100 text-orange-800":"medium"===b.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:b.priority}),(0,g.jsx)("span",{className:`px-2 py-1 rounded text-xs ${"closed"===b.status?"bg-gray-100 text-gray-800":"resolved"===b.status?"bg-green-100 text-green-800":"in-progress"===b.status?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:b.status})]}),(0,g.jsx)("p",{className:"text-xs text-gray-500",children:new Date(b.createdAt).toLocaleDateString()})]},b.id)})}),(0,g.jsx)("div",{className:"hidden sm:block bg-white rounded-lg border border-gray-200 overflow-x-auto",children:(0,g.jsxs)("table",{className:"w-full",children:[(0,g.jsx)("thead",{className:"bg-gray-50",children:(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Title"}),(0,g.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Customer"}),(0,g.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Priority"}),(0,g.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Status"}),(0,g.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Created"}),(0,g.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Actions"})]})}),(0,g.jsx)("tbody",{children:a.tickets?.map(b=>{let c=a.customers?.find(a=>a.id==b.customerId);return(0,g.jsxs)("tr",{className:"border-t",children:[(0,g.jsx)("td",{className:"p-3 text-sm",children:b.title}),(0,g.jsx)("td",{className:"p-3 text-sm",children:c?.name||"N/A"}),(0,g.jsx)("td",{className:"p-3",children:(0,g.jsx)("span",{className:`px-2 py-1 rounded text-xs ${"urgent"===b.priority?"bg-red-100 text-red-800":"high"===b.priority?"bg-orange-100 text-orange-800":"medium"===b.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:b.priority})}),(0,g.jsx)("td",{className:"p-3",children:(0,g.jsx)("span",{className:`px-2 py-1 rounded text-xs ${"closed"===b.status?"bg-gray-100 text-gray-800":"resolved"===b.status?"bg-green-100 text-green-800":"in-progress"===b.status?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:b.status})}),(0,g.jsx)("td",{className:"p-3 text-sm",children:new Date(b.createdAt).toLocaleDateString()}),(0,g.jsxs)("td",{className:"p-3",children:[(0,g.jsx)("button",{onClick:()=>o(b),className:"bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded mr-2 text-sm",children:"Edit"}),(0,g.jsx)("button",{onClick:()=>d("tickets",b.id),className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm",children:"Delete"})]})]},b.id)})})]})})]})},I=()=>{let a,{data:b,currentUser:c,addItem:d}=w(),[e,f]=(0,h.useState)(!1),[i,j]=(0,h.useState)({userId:"",amount:"",reason:""}),k=["admin","manager"].includes(c?.role),l=(a={},b.tickets.filter(a=>"completed"===a.status).forEach(c=>{let d=("product"===c.type?b.products:b.services).find(a=>a.id==c.itemId);if(d){let e=b.customers.find(a=>a.id==c.customerId),f=e?b.users.find(a=>a.id==e.assignedTo&&"partner"===a.role):null,g=b.users.find(a=>a.id==c.assignedTo);if(f){a[f.id]||(a[f.id]={user:f,total:0,items:[]});let b=d.price*d.partnerCommissionPercent/100;a[f.id].total+=b,a[f.id].items.push({item:d.name,commission:b})}if(g){a[g.id]||(a[g.id]={user:g,total:0,items:[]});let b=d.price*d.technicianCommissionPercent/100;a[g.id].total+=b,a[g.id].items.push({item:d.name,commission:b})}}}),a),m=b.bonuses||[],n=(()=>{if(c?.role==="partner"){let a=b.customers.filter(a=>a.assignedTo==c.id),d=b.tickets.filter(b=>a.some(a=>a.id==b.customerId)),e=l[c.id]?.total||0,f=m.filter(a=>a.userId==c.id).reduce((a,b)=>a+b.amount,0);return{customers:a.length,tickets:d.length,commission:e,bonuses:f,totalEarnings:e+f}}if(c?.role==="technician"){let a=b.tickets.filter(a=>a.assignedTo==c.id),d=a.filter(a=>"completed"===a.status),e=l[c.id]?.total||0,f=m.filter(a=>a.userId==c.id).reduce((a,b)=>a+b.amount,0);return{assignedTickets:a.length,completedTickets:d.length,commission:e,bonuses:f,totalEarnings:e+f}}return null})();return c?.role==="partner"||c?.role==="technician"?(0,g.jsxs)("div",{className:"p-4",children:[(0,g.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-green-400 mb-6",children:"My Reports"}),(0,g.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-6 mb-6",children:["partner"===c.role&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:"bg-gray-800 p-4 lg:p-6 rounded-lg border border-green-600",children:[(0,g.jsx)("h3",{className:"text-green-400 text-sm lg:text-lg font-semibold",children:"My Customers"}),(0,g.jsx)("p",{className:"text-xl lg:text-3xl font-bold text-green-100 mt-1 lg:mt-2",children:n?.customers})]}),(0,g.jsxs)("div",{className:"bg-gray-800 p-4 lg:p-6 rounded-lg border border-green-600",children:[(0,g.jsx)("h3",{className:"text-green-400 text-sm lg:text-lg font-semibold",children:"Tickets Raised"}),(0,g.jsx)("p",{className:"text-xl lg:text-3xl font-bold text-green-100 mt-1 lg:mt-2",children:n?.tickets})]})]}),"technician"===c.role&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:"bg-gray-800 p-4 lg:p-6 rounded-lg border border-green-600",children:[(0,g.jsx)("h3",{className:"text-green-400 text-sm lg:text-lg font-semibold",children:"Assigned Tickets"}),(0,g.jsx)("p",{className:"text-xl lg:text-3xl font-bold text-green-100 mt-1 lg:mt-2",children:n?.assignedTickets})]}),(0,g.jsxs)("div",{className:"bg-gray-800 p-4 lg:p-6 rounded-lg border border-green-600",children:[(0,g.jsx)("h3",{className:"text-green-400 text-sm lg:text-lg font-semibold",children:"Completed Tickets"}),(0,g.jsx)("p",{className:"text-xl lg:text-3xl font-bold text-green-100 mt-1 lg:mt-2",children:n?.completedTickets})]})]}),(0,g.jsxs)("div",{className:"bg-gray-800 p-4 lg:p-6 rounded-lg border border-green-600",children:[(0,g.jsx)("h3",{className:"text-green-400 text-sm lg:text-lg font-semibold",children:"Commission"}),(0,g.jsxs)("p",{className:"text-xl lg:text-3xl font-bold text-green-100 mt-1 lg:mt-2",children:["â‚¹",n?.commission.toFixed(2)]})]}),(0,g.jsxs)("div",{className:"bg-gray-800 p-4 lg:p-6 rounded-lg border border-green-600",children:[(0,g.jsx)("h3",{className:"text-green-400 text-sm lg:text-lg font-semibold",children:"Bonuses"}),(0,g.jsxs)("p",{className:"text-xl lg:text-3xl font-bold text-green-100 mt-1 lg:mt-2",children:["â‚¹",n?.bonuses.toFixed(2)]})]}),(0,g.jsxs)("div",{className:"bg-gray-800 p-4 lg:p-6 rounded-lg border border-green-600",children:[(0,g.jsx)("h3",{className:"text-green-400 text-sm lg:text-lg font-semibold",children:"Total Earnings"}),(0,g.jsxs)("p",{className:"text-xl lg:text-3xl font-bold text-green-100 mt-1 lg:mt-2",children:["â‚¹",n?.totalEarnings.toFixed(2)]})]})]})]}):(0,g.jsxs)("div",{className:"p-4",children:[(0,g.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 gap-4 relative z-10",children:[(0,g.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-green-400",children:"Reports & Analytics"}),k&&(0,g.jsx)("button",{onClick:()=>f(!0),className:"bg-green-600 hover:bg-green-700 px-4 py-2 rounded text-white w-full sm:w-auto whitespace-nowrap",children:"Add Bonus"})]}),e&&(0,g.jsxs)("div",{className:"bg-gray-800 p-4 sm:p-6 rounded-lg mb-6 border border-green-600 relative z-10",children:[(0,g.jsx)("h3",{className:"text-lg font-semibold text-green-400 mb-4",children:"Add Bonus"}),(0,g.jsxs)("form",{onSubmit:a=>{a.preventDefault(),d("bonuses",{...i,amount:parseFloat(i.amount),addedBy:c.id,addedAt:new Date().toISOString()}),j({userId:"",amount:"",reason:""}),f(!1)},className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,g.jsxs)("select",{value:i.userId,onChange:a=>j({...i,userId:a.target.value}),className:"p-3 bg-gray-700 text-green-100 rounded border border-green-600",required:!0,children:[(0,g.jsx)("option",{value:"",children:"Select User"}),b.users.filter(a=>["partner","technician"].includes(a.role)).map(a=>(0,g.jsxs)("option",{value:a.id,children:[a.name," (",a.role,")"]},a.id))]}),(0,g.jsx)("input",{type:"number",step:"0.01",placeholder:"Bonus Amount",value:i.amount,onChange:a=>j({...i,amount:a.target.value}),className:"p-3 bg-gray-700 text-green-100 rounded border border-green-600",required:!0}),(0,g.jsx)("input",{type:"text",placeholder:"Reason",value:i.reason,onChange:a=>j({...i,reason:a.target.value}),className:"p-3 bg-gray-700 text-green-100 rounded border border-green-600",required:!0}),(0,g.jsxs)("div",{className:"sm:col-span-3 flex flex-col sm:flex-row gap-2",children:[(0,g.jsx)("button",{type:"submit",className:"bg-green-600 hover:bg-green-700 px-4 py-2 rounded text-white",children:"Add Bonus"}),(0,g.jsx)("button",{type:"button",onClick:()=>f(!1),className:"bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded text-white",children:"Cancel"})]})]})]}),(0,g.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-6",children:[(0,g.jsxs)("div",{className:"bg-white p-4 lg:p-6 rounded-lg border border-gray-200 shadow-sm",children:[(0,g.jsx)("h3",{className:"text-gray-600 text-sm lg:text-lg font-semibold",children:"Total Customers"}),(0,g.jsx)("p",{className:"text-xl lg:text-3xl font-bold text-black mt-1 lg:mt-2",children:b.customers.length})]}),(0,g.jsxs)("div",{className:"bg-white p-4 lg:p-6 rounded-lg border border-gray-200 shadow-sm",children:[(0,g.jsx)("h3",{className:"text-gray-600 text-sm lg:text-lg font-semibold",children:"Total Tickets"}),(0,g.jsx)("p",{className:"text-xl lg:text-3xl font-bold text-black mt-1 lg:mt-2",children:b.tickets.length})]}),(0,g.jsxs)("div",{className:"bg-white p-4 lg:p-6 rounded-lg border border-gray-200 shadow-sm",children:[(0,g.jsx)("h3",{className:"text-gray-600 text-sm lg:text-lg font-semibold",children:"Completed Tickets"}),(0,g.jsx)("p",{className:"text-xl lg:text-3xl font-bold text-black mt-1 lg:mt-2",children:b.tickets.filter(a=>"completed"===a.status).length})]}),(0,g.jsxs)("div",{className:"bg-white p-4 lg:p-6 rounded-lg border border-gray-200 shadow-sm",children:[(0,g.jsx)("h3",{className:"text-gray-600 text-sm lg:text-lg font-semibold",children:"Total Commissions"}),(0,g.jsxs)("p",{className:"text-xl lg:text-3xl font-bold text-black mt-1 lg:mt-2",children:["â‚¹",Object.values(l).reduce((a,b)=>a+b.total,0).toFixed(2)]})]})]}),(0,g.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6",children:[(0,g.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:[(0,g.jsx)("h3",{className:"text-base lg:text-lg font-semibold text-black p-4 border-b border-gray-200",children:"Commission Summary"}),(0,g.jsx)("div",{className:"p-4",children:Object.values(l).map(({user:a,total:b})=>(0,g.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-200",children:[(0,g.jsxs)("span",{className:"text-black text-sm lg:text-base",children:[a.name," (",a.role,")"]}),(0,g.jsxs)("span",{className:"text-orange-500 font-semibold text-sm lg:text-base",children:["â‚¹",b.toFixed(2)]})]},a.id))})]}),(0,g.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:[(0,g.jsx)("h3",{className:"text-base lg:text-lg font-semibold text-black p-4 border-b border-gray-200",children:"Recent Bonuses"}),(0,g.jsx)("div",{className:"p-4",children:m.slice(-10).map(a=>{let c=b.users.find(b=>b.id==a.userId);return(0,g.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-200",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{className:"text-black text-sm lg:text-base",children:c?.name}),(0,g.jsx)("p",{className:"text-xs lg:text-sm text-gray-600",children:a.reason})]}),(0,g.jsxs)("span",{className:"text-orange-500 font-semibold text-sm lg:text-base",children:["â‚¹",a.amount]})]},a.id)})})]})]})]})},J=()=>{let{addItem:a}=w(),[b,c]=(0,h.useState)({name:"",email:"",phone:"",username:"",password:"",specialization:""});return(0,g.jsxs)("div",{className:"w-full p-4",children:[(0,g.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,g.jsx)("button",{onClick:()=>window.history.back(),className:"btn-secondary px-3 py-2 rounded flex items-center gap-2",children:"â† Back"}),(0,g.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-green-400",children:"Add New Technician"})]}),(0,g.jsxs)("form",{onSubmit:d=>{d.preventDefault(),a("users",{...b,role:"technician"}),c({name:"",email:"",phone:"",username:"",password:"",specialization:""}),alert("Technician added successfully!")},className:"glass-form p-4 sm:p-6 rounded-lg space-y-4",children:[(0,g.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Name"}),(0,g.jsx)("input",{type:"text",value:b.name,onChange:a=>c({...b,name:a.target.value}),className:"w-full px-3 py-2 bg-white/5 backdrop-blur-sm text-green-100 focus:bg-white/10 transition-all duration-200 rounded border-0 outline-none",required:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Email"}),(0,g.jsx)("input",{type:"email",value:b.email,onChange:a=>c({...b,email:a.target.value}),className:"w-full px-3 py-2 bg-white/5 backdrop-blur-sm text-green-100 focus:bg-white/10 transition-all duration-200 rounded border-0 outline-none",required:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Phone"}),(0,g.jsx)("input",{type:"tel",value:b.phone,onChange:a=>c({...b,phone:a.target.value}),className:"w-full px-3 py-2 bg-white/5 backdrop-blur-sm text-green-100 focus:bg-white/10 transition-all duration-200 rounded border-0 outline-none",required:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Username"}),(0,g.jsx)("input",{type:"text",value:b.username,onChange:a=>c({...b,username:a.target.value}),className:"w-full px-3 py-2 bg-white/5 backdrop-blur-sm text-green-100 focus:bg-white/10 transition-all duration-200 rounded border-0 outline-none",required:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Password"}),(0,g.jsx)("input",{type:"password",value:b.password,onChange:a=>c({...b,password:a.target.value}),className:"w-full px-3 py-2 bg-white/5 backdrop-blur-sm text-green-100 focus:bg-white/10 transition-all duration-200 rounded border-0 outline-none",required:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Specialization"}),(0,g.jsx)("input",{type:"text",value:b.specialization,onChange:a=>c({...b,specialization:a.target.value}),className:"w-full px-3 py-2 bg-white/5 backdrop-blur-sm text-green-100 focus:bg-white/10 transition-all duration-200 rounded border-0 outline-none",placeholder:"e.g., Electrical, Plumbing"})]})]}),(0,g.jsx)("button",{type:"submit",className:"w-full btn-primary font-bold py-2 sm:py-3 px-4 rounded",children:"Add Technician"})]})]})},K=()=>{let{addItem:a}=w(),[b,c]=(0,h.useState)({name:"",email:"",phone:"",username:"",password:"",company:"",territory:""});return(0,g.jsxs)("div",{className:"w-full p-4",children:[(0,g.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,g.jsx)("button",{onClick:()=>window.history.back(),className:"btn-secondary px-3 py-2 rounded flex items-center gap-2",children:"â† Back"}),(0,g.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-green-400",children:"Add New Partner"})]}),(0,g.jsxs)("form",{onSubmit:d=>{d.preventDefault(),a("users",{...b,role:"partner"}),c({name:"",email:"",phone:"",username:"",password:"",company:"",territory:""}),alert("Partner added successfully!")},className:"glass-form p-4 sm:p-6 rounded-lg space-y-4",children:[(0,g.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Name"}),(0,g.jsx)("input",{type:"text",value:b.name,onChange:a=>c({...b,name:a.target.value}),className:"glass-input w-full px-3 py-2 rounded placeholder-green-300/50",required:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Email"}),(0,g.jsx)("input",{type:"email",value:b.email,onChange:a=>c({...b,email:a.target.value}),className:"glass-input w-full px-3 py-2 rounded placeholder-green-300/50",required:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Phone"}),(0,g.jsx)("input",{type:"tel",value:b.phone,onChange:a=>c({...b,phone:a.target.value}),className:"glass-input w-full px-3 py-2 rounded placeholder-green-300/50",required:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Username"}),(0,g.jsx)("input",{type:"text",value:b.username,onChange:a=>c({...b,username:a.target.value}),className:"glass-input w-full px-3 py-2 rounded placeholder-green-300/50",required:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Password"}),(0,g.jsx)("input",{type:"password",value:b.password,onChange:a=>c({...b,password:a.target.value}),className:"glass-input w-full px-3 py-2 rounded placeholder-green-300/50",required:!0})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Company"}),(0,g.jsx)("input",{type:"text",value:b.company,onChange:a=>c({...b,company:a.target.value}),className:"glass-input w-full px-3 py-2 rounded placeholder-green-300/50",placeholder:"Partner company name"})]}),(0,g.jsxs)("div",{className:"sm:col-span-2",children:[(0,g.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Territory"}),(0,g.jsx)("input",{type:"text",value:b.territory,onChange:a=>c({...b,territory:a.target.value}),className:"glass-input w-full px-3 py-2 rounded placeholder-green-300/50",placeholder:"Assigned territory or region"})]})]}),(0,g.jsx)("button",{type:"submit",className:"w-full btn-primary font-bold py-2 sm:py-3 px-4 rounded",children:"Add Partner"})]})]})},L=()=>{let{currentUser:a,data:b,currentPage:c,setCurrentPage:d}=w();return(0,g.jsx)("div",{children:(()=>{switch(c){case"customers":return(0,g.jsx)(B,{});case"products":return(0,g.jsx)(E,{});case"services":return(0,g.jsx)(F,{});case"quotes":case"orders":return(0,g.jsx)(G,{});case"tickets":return(0,g.jsx)(H,{});case"reports":return(0,g.jsx)(I,{});case"add technician":return(0,g.jsx)(J,{});case"add partner":return(0,g.jsx)(K,{});default:return(0,g.jsxs)("div",{className:"space-y-4",children:[(0,g.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[(0,g.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 mb-2 flex items-center",children:[(0,g.jsx)("span",{className:"mr-2",children:"â˜€ï¸"})," Welcome back, ",a?.name,"!"]}),(0,g.jsxs)("p",{className:"text-gray-600",children:["Solar Energy Management - ",a?.role," dashboard"]})]}),(0,g.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,g.jsx)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all",children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{className:"text-gray-600 text-sm font-medium",children:"Solar Customers"}),(0,g.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:b.customers.length})]}),(0,g.jsx)("span",{className:"text-3xl text-orange-500",children:"ðŸ‘¥"})]})}),(0,g.jsx)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all",children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{className:"text-gray-600 text-sm font-medium",children:"Solar Products"}),(0,g.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:b.products.length})]}),(0,g.jsx)("span",{className:"text-3xl text-orange-500",children:"ðŸ”‹"})]})}),(0,g.jsx)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all",children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{className:"text-gray-600 text-sm font-medium",children:"Services"}),(0,g.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:b.services.length})]}),(0,g.jsx)("span",{className:"text-3xl text-orange-500",children:"âš¡"})]})}),(0,g.jsx)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all",children:(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{className:"text-gray-600 text-sm font-medium",children:"Quotes"}),(0,g.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:(b.quotes||[]).length})]}),(0,g.jsx)("span",{className:"text-3xl text-orange-500",children:"ðŸ“‹"})]})})]}),(0,g.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,g.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[(0,g.jsxs)("h3",{className:"text-gray-900 text-lg font-semibold mb-4 flex items-center",children:[(0,g.jsx)("span",{className:"mr-2",children:"ðŸŽ«"})," Recent Support Tickets"]}),(0,g.jsxs)("div",{className:"space-y-3",children:[Array.isArray(b.tickets)?b.tickets.slice(0,3).map((a,b)=>(0,g.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg border border-gray-100",children:[(0,g.jsxs)("span",{className:"text-gray-900 text-sm font-medium",children:["Ticket #",b+1]}),(0,g.jsx)("span",{className:"text-orange-600 text-xs font-semibold bg-orange-100 px-2 py-1 rounded",children:"Open"})]},b)):null,(!Array.isArray(b.tickets)||0===b.tickets.length)&&(0,g.jsx)("p",{className:"text-gray-500 text-sm",children:"No tickets yet"})]})]}),(0,g.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[(0,g.jsxs)("h3",{className:"text-gray-900 text-lg font-semibold mb-4 flex items-center",children:[(0,g.jsx)("span",{className:"mr-2",children:"âš¡"})," Quick Actions"]}),(0,g.jsxs)("div",{className:"space-y-2",children:[(a?.role==="admin"||a?.role==="partner")&&(0,g.jsx)("button",{onClick:()=>d("customers"),className:"w-full bg-gradient-to-r from-green-600 to-green-500 hover:from-green-700 hover:to-green-600 text-white p-2 rounded-lg transition-all text-sm font-semibold shadow-md hover:shadow-lg",children:"+ Add Solar Customer"}),a?.role==="admin"&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("button",{onClick:()=>d("add partner"),className:"w-full bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 text-white p-2 rounded-lg transition-all text-sm font-semibold shadow-md hover:shadow-lg",children:"+ Add Partner"}),(0,g.jsx)("button",{onClick:()=>d("add technician"),className:"w-full bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 text-white p-2 rounded-lg transition-all text-sm font-semibold shadow-md hover:shadow-lg",children:"+ Add Technician"})]}),(0,g.jsx)("button",{onClick:()=>d("tickets"),className:"w-full bg-gradient-to-r from-yellow-600 to-yellow-500 hover:from-yellow-700 hover:to-yellow-600 text-white p-2 rounded-lg transition-all text-sm font-semibold shadow-md hover:shadow-lg",children:"+ Create Support Ticket"}),(0,g.jsx)("button",{onClick:()=>d("reports"),className:"w-full bg-gradient-to-r from-purple-600 to-purple-500 hover:from-purple-700 hover:to-purple-600 text-white p-2 rounded-lg transition-all text-sm font-semibold shadow-md hover:shadow-lg",children:"ðŸ“Š View Reports"})]})]})]})]})}})()})},M=new Map;function N(a){let b=M.get(a);return b&&b.expiry>Date.now()?b.data:(b&&M.delete(a),null)}function O(a,b,c){M.set(a,{data:b,expiry:Date.now()+("number"==typeof c?c:3e5)})}function P(a,b){try{return`${a}:${JSON.stringify(b)}`}catch{return`${a}:${String(b)}`}}class Q{resource;constructor(a){this.resource=a}async findLast(a={}){let{sort:b="-created_at",search:c="",fields:d="*",filter:e="",useCache:f=!1,useSession:g=!1,cacheTtlMs:h=3e5}=a,i={page:"1,1",sort:b,search:c,fields:d,filter:e,...this.getSessionParam(g)},j=P(`${this.resource}:last`,{sort:b,search:c,fields:d,filter:e,useSession:g});if(f){let a=N(j);if(a)return a}let k=await n(`/${this.resource}`,i),l=Array.isArray(k?.result)?k.result[0]:k?.result,m={...k,result:l};return f&&!k?.err&&O(j,m,h),m}getSessionParam(a){return{}}ensureValidIds(a,b){if(!Array.isArray(a)||0===a.length)throw Error(`${b}: ids[] must not be empty`)}async findAll(a={}){return this.findMany(a)}async findMany(a={}){let{page:b="",sort:c="created_at",limit:d="",joins:e="",search:f="",fields:g="*",filter:h="",nearby:i="",useCache:j=!1,useSession:k=!1,cacheTtlMs:l=3e5}=a,m={page:`${b},${d}`,sort:c,search:f,fields:g,filter:h,...e?{joins:e}:{},...i?{nearby:i}:{},...this.getSessionParam(k)},o=P(`${this.resource}:list`,{page:b,limit:d,sort:c,fields:g,filter:h,useSession:k});if(j){let a=N(o);if(a)return a}let p=await n(`/${this.resource}`,m);return j&&!p?.err&&O(o,p,l),p}async findOne(a,b={}){let{fields:c="*",useSession:d=!1,useCache:e=!1,cacheTtlMs:f=3e5,joins:g=""}=b,h={fields:c,...g?{joins:g}:{},...this.getSessionParam(d)},i=P(`${this.resource}:byId`,{id:a,fields:c,useSession:d});if(e){let a=N(i);if(a)return a}let j=await n(`/${this.resource}/${a}`,h);return Array.isArray(j?.result)&&(j.result=j.result[0]),e&&!j?.err&&O(i,j,f),j}async findManyIds(a,b={}){let{fields:c="*",useSession:d=!1,useCache:e=!1,cacheTtlMs:f=3e5,joins:g=""}=b,h={fields:c,...g?{joins:g}:{},...this.getSessionParam(d)},i=P(`${this.resource}:byIds`,{ids:a,fields:c,useSession:d});if(e){let a=N(i);if(a)return a}let j=await n(`/${this.resource}/${a.join(",")}`,h);return j.result=j?.result||[],e&&!j?.err&&O(i,j,f),j}async createOne(a,b={}){let{useSession:c=!1,fields:d="*"}=b,e={...a};if(c){let a=(void 0)??void 0;a&&null==e.client&&(e.client=a)}return await p(`/${this.resource}`,{body:e,...this.getSessionParam(c),fields:d})}async createMany(a,b={}){let{useSession:c=!1,fields:d="*"}=b,e=a.map(a=>({...a}));if(c){let a=(void 0)??void 0;a&&(e=e.map(b=>null==b.client?{...b,client:a}:b))}return await p(`/${this.resource}`,{body:e,...this.getSessionParam(c),fields:d})}async updateOne(a,b,c={}){let{useSession:d=!1,fields:e="*"}=c;return await o(`/${this.resource}/${a}`,{body:b,...this.getSessionParam(d),fields:e})}async updateMany(a,b={}){let{useSession:c=!1,fields:d="*"}=b,e=a.map(({id:a,data:b})=>({id:a,...b}));return await o(`/${this.resource}`,{body:e,...this.getSessionParam(c),fields:d})}async deleteOne(a,b={}){let{useSession:c=!1}=b;return await q(`/${this.resource}/${a}`,this.getSessionParam(c))}async deleteMany(a,b={}){this.ensureValidIds(a,"deleteMany");let{useSession:c=!1}=b;return await q(`/${this.resource}/${a.join(",")}`,this.getSessionParam(c))}async softDeleteOne(a,b={}){return this.updateOne(a,{is_deleted:1},b)}async softDeleteMany(a,b={}){this.ensureValidIds(a,"softDeleteMany");let c=a.map(a=>({id:a,data:{is_deleted:1}}));return this.updateMany(c,b)}async restoreOne(a,b={}){return this.updateOne(a,{is_deleted:0},b)}async restoreMany(a,b={}){this.ensureValidIds(a,"restoreMany");let c=a.map(a=>({id:a,data:{is_deleted:0}}));return this.updateMany(c,b)}async rawSql(a,b,c=[],d={}){let{useSession:e=!1,useCache:f=!1,cacheTtlMs:g=3e5}=d,h=a?a.trim().replace(/\s+/g,"-").toLowerCase():"rawSql",i=P(h,{sql:b,params:JSON.stringify(c),useSession:e});if(f){let a=N(i);if(a)return a}let j=await r(`/${h}`,{body:{sql:b,params:c},...this.getSessionParam(e)});return f&&!j?.err&&O(i,j,g),j}}function R(a){return new Q(a)}let S={users:R("users"),orders:R("orders"),tickets:R("tickets"),products:R("products"),services:R("services"),customers:R("customers"),quotes:R("quotes")},T=()=>{let{currentUser:a,data:b,addItem:c,login:d}=w();console.log("CustomerPortal data:",b),console.log("Products:",b.products),console.log("Services:",b.services);let[e,f]=(0,h.useState)("home"),[i]=(0,h.useState)(!1),[j]=(0,h.useState)({type:"product",itemId:"",quantity:1,description:"",preferredDate:""}),[k,l]=(0,h.useState)({name:"",phone:"",email:"",address:"",propertyType:"residential",roofArea:"",monthlyBill:"",requirements:""}),[m,n]=(0,h.useState)({type:"product",itemId:"",issue:"",notes:""}),[o,p]=(0,h.useState)([]),[q,r]=(0,h.useState)(!1);(0,h.useEffect)(()=>{a||"my-orders"!==e&&"my-tickets"!==e||f("home")},[a,e]);let s=a&&b.orders?.filter(b=>b.customerId===a.id)||[],t=a&&b.tickets?.filter(b=>b.customerId===a.id)||[];(0,h.useEffect)(()=>{a&&"my-quotes"===e&&u()},[a,e]);let u=async()=>{if(!a)return},v=[{id:"home",label:"Home",icon:"ðŸ "},{id:"products",label:"Products",icon:"ðŸ›’"},{id:"services",label:"Services",icon:"ðŸ”§"},{id:"raise-ticket",label:"Support",icon:"ðŸŽ«"},...a?[{id:"my-orders",label:"My Orders",icon:"ðŸ“¦"},{id:"my-tickets",label:"My Tickets",icon:"ðŸŽŸï¸"}]:[]];return(0,g.jsxs)("div",{className:"min-h-screen bg-slate-900 text-slate-100",children:[(0,g.jsx)("nav",{className:"sticky top-0 z-40 border-b border-gray-700/60 bg-slate-900/80 backdrop-blur",children:(0,g.jsxs)("div",{className:"mx-auto flex max-w-7xl items-center justify-between gap-4 px-4 py-4",children:[(0,g.jsxs)("a",{href:"#",className:"flex items-center gap-3",children:[(0,g.jsx)("div",{className:"h-11 w-11 rounded-xl bg-blue-600 flex items-center justify-center ring-1 ring-white/10",children:(0,g.jsx)("span",{className:"text-white font-bold text-lg",children:"MJ"})}),(0,g.jsxs)("div",{className:"leading-tight hidden sm:block",children:[(0,g.jsx)("div",{className:"font-semibold tracking-wide",children:"MJ Power"}),(0,g.jsx)("div",{className:"text-xs text-slate-400",children:"Products â€¢ Services â€¢ Support"})]})]}),(0,g.jsxs)("div",{className:"hidden lg:flex w-full max-w-xl items-center gap-2",children:[(0,g.jsxs)("div",{className:"relative w-full",children:[(0,g.jsx)("input",{type:"search",placeholder:"Search products (Inverters, Batteries, Panels...)",className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 pr-10 text-sm text-slate-100 placeholder:text-slate-400 outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20"}),(0,g.jsx)("span",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-slate-400",children:"âŒ•"})]}),(0,g.jsx)("a",{onClick:()=>f("get-quote"),className:"rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110 cursor-pointer whitespace-nowrap",children:"Get Quote"})]}),(0,g.jsxs)("div",{className:"flex items-center gap-2",children:[v.map(b=>(0,g.jsx)("button",{onClick:()=>{a||"my-orders"!==b.id&&"my-tickets"!==b.id?f(b.id):r(!0)},className:"hidden lg:inline rounded-xl px-3 py-2 text-sm text-slate-200 hover:bg-white/5",children:b.label},b.id)),(0,g.jsxs)("button",{onClick:()=>f("cart"),className:"rounded-2xl border border-white/10 bg-white/5 px-3 py-2 text-sm hover:bg-white/10",type:"button",children:["ðŸ›’ ",(0,g.jsxs)("span",{className:"ml-1 text-slate-300",children:["(",o.length,")"]})]})]})]})}),(0,g.jsx)("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-slate-900/95 backdrop-blur border-t border-gray-700/60 lg:hidden",children:(0,g.jsxs)("div",{className:"grid grid-cols-5 gap-1 px-2 py-2",children:[v.slice(0,4).map(b=>(0,g.jsxs)("button",{onClick:()=>{a||"my-orders"!==b.id&&"my-tickets"!==b.id?f(b.id):r(!0)},className:`flex flex-col items-center py-2 px-1 rounded-lg text-xs transition-colors ${e===b.id?"text-green-500 bg-white/10":"text-slate-400"}`,children:[(0,g.jsx)("span",{className:"text-lg mb-1",children:b.icon}),(0,g.jsx)("span",{className:"truncate",children:b.label})]},b.id)),(0,g.jsxs)("button",{onClick:()=>f("get-quote"),className:`flex flex-col items-center py-2 px-1 rounded-lg text-xs transition-colors ${"get-quote"===e?"text-green-500 bg-white/10":"text-slate-400"}`,children:[(0,g.jsx)("span",{className:"text-lg mb-1",children:"ðŸ’°"}),(0,g.jsx)("span",{className:"truncate",children:"Quote"})]})]})}),(0,g.jsx)("div",{className:"pb-20 lg:pb-0",children:(0,g.jsxs)("main",{className:"mx-auto max-w-7xl px-4 py-6 lg:py-10",children:["home"===e&&(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"relative overflow-hidden mb-8",children:[(0,g.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-green-500/15 via-transparent to-white/5"}),(0,g.jsxs)("div",{className:"mx-auto grid max-w-7xl items-center gap-10 px-4 py-12 md:grid-cols-2 md:py-16",children:[(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-1.5 text-xs text-slate-200",children:[(0,g.jsx)("span",{className:"h-2 w-2 rounded-full bg-green-500"}),"Power solutions for homes, businesses & industry"]}),(0,g.jsxs)("h1",{className:"mt-5 text-4xl font-semibold leading-tight tracking-tight md:text-5xl",children:["Reliable ",(0,g.jsx)("span",{className:"text-green-500",children:"Electrical"})," Products",(0,g.jsx)("br",{className:"hidden sm:block"}),"+ Expert Services"]}),(0,g.jsx)("p",{className:"mt-4 max-w-xl text-slate-300",children:"Buy authentic power products (inverters, batteries, solar, wiring) and book installation, maintenance, AMC, and audits â€” all in one place."}),(0,g.jsxs)("div",{className:"mt-6 flex flex-wrap gap-3",children:[(0,g.jsx)("button",{onClick:()=>f("products"),className:"rounded-2xl bg-green-500 px-5 py-3 text-sm font-semibold text-black hover:brightness-110",children:"Shop Products"}),(0,g.jsx)("button",{onClick:()=>f("services"),className:"rounded-2xl border border-white/10 bg-white/5 px-5 py-3 text-sm font-semibold text-slate-100 hover:bg-white/10",children:"Explore Services"}),(0,g.jsx)("button",{onClick:()=>f("get-quote"),className:"rounded-2xl border border-green-500/40 bg-black/20 px-5 py-3 text-sm font-semibold text-green-500 hover:border-green-500/70",children:"Request a Quote"})]}),(0,g.jsxs)("div",{className:"mt-8 grid grid-cols-2 gap-3 sm:grid-cols-3",children:[(0,g.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[(0,g.jsx)("div",{className:"text-sm font-semibold",children:"Warranty-backed"}),(0,g.jsx)("div",{className:"mt-1 text-xs text-slate-400",children:"Genuine products only"})]}),(0,g.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[(0,g.jsx)("div",{className:"text-sm font-semibold",children:"Fast Support"}),(0,g.jsx)("div",{className:"mt-1 text-xs text-slate-400",children:"Phone + onsite"})]}),(0,g.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[(0,g.jsx)("div",{className:"text-sm font-semibold",children:"Professional Install"}),(0,g.jsx)("div",{className:"mt-1 text-xs text-slate-400",children:"Certified team"})]})]})]}),(0,g.jsx)("div",{className:"relative",children:(0,g.jsx)("div",{className:"rounded-3xl border border-white/10 bg-gradient-to-b from-white/10 to-white/5 p-6 shadow-2xl shadow-black/40",children:(()=>{let a=b.products&&b.products.length>0?b.products.reduce((a,b)=>(b.originalPrice?(b.originalPrice-b.price)/b.originalPrice*100:0)>(a?.originalPrice?(a.originalPrice-a.price)/a.originalPrice*100:0)?b:a,null):null;if(a&&a.originalPrice||(a=b.products&&b.products.length>0?b.products[0]:null),!a)return null;let c=a.originalPrice?Math.round((a.originalPrice-a.price)/a.originalPrice*100):15;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"text-sm font-semibold text-slate-100",children:"Today's Deal"}),(0,g.jsx)("div",{className:"mt-1 text-xs text-slate-400",children:"Limited stock â€¢ Best price"})]}),(0,g.jsxs)("span",{className:"rounded-full bg-green-500/20 px-3 py-1 text-xs font-semibold text-green-500",children:["-",c,"%"]})]}),(0,g.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,g.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/20 p-4",children:[(0,g.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"text-sm font-semibold",children:a.name}),(0,g.jsxs)("div",{className:"mt-1 text-xs text-slate-400",children:[a.category," â€¢ ",a.description]}),(0,g.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,g.jsxs)("span",{className:"text-lg font-semibold text-green-500",children:["â‚¹",a.price?.toLocaleString()]}),a.originalPrice&&(0,g.jsxs)("span",{className:"text-sm text-slate-500 line-through",children:["â‚¹",a.originalPrice?.toLocaleString()]})]})]}),(0,g.jsx)("div",{className:"h-14 w-14 rounded-2xl bg-green-500/15 ring-1 ring-green-500/20 grid place-items-center",children:"âš¡"})]}),(0,g.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,g.jsx)("button",{onClick:()=>{o.find(b=>b.id===a.id)||p([...o,{...a,quantity:1}])},className:"w-full rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110",type:"button",children:"Add to Cart"}),(0,g.jsx)("button",{className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-center text-sm font-semibold hover:bg-white/10",children:"Install +"})]})]}),(0,g.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,g.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/20 p-4",children:[(0,g.jsx)("div",{className:"text-xs text-slate-400",children:"Avg dispatch"}),(0,g.jsx)("div",{className:"mt-1 text-lg font-semibold",children:"24â€“48 hrs"})]}),(0,g.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/20 p-4",children:[(0,g.jsx)("div",{className:"text-xs text-slate-400",children:"Service coverage"}),(0,g.jsx)("div",{className:"mt-1 text-lg font-semibold",children:"Onsite"})]})]})]})]})})()})})]})]}),(0,g.jsxs)("div",{className:"mb-10",children:[(0,g.jsxs)("div",{className:"flex items-end justify-between gap-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{className:"text-2xl font-semibold",children:"Shop by Category"}),(0,g.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Quickly find what you need."})]}),(0,g.jsx)("button",{onClick:()=>f("products"),className:"text-sm font-semibold text-green-500 hover:underline",children:"View all â†’"})]}),(0,g.jsx)("div",{className:"mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[{name:"Solar Panels",icon:"â˜€ï¸",color:"bg-yellow-400"},{name:"Inverters",icon:"âš¡",color:"bg-yellow-400"},{name:"Batteries",icon:"ðŸ”‹",color:"bg-yellow-400"},{name:"Installation",icon:"ðŸ”§",color:"bg-yellow-400"}].map(a=>(0,g.jsxs)("button",{onClick:()=>f("products"),className:"group rounded-3xl border border-white/10 bg-white/5 p-5 hover:bg-white/10 text-left",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsx)("div",{className:"text-sm font-semibold",children:a.name}),(0,g.jsx)("div",{className:"rounded-2xl bg-green-500/15 px-3 py-2 text-green-500 ring-1 ring-green-500/20",children:a.icon})]}),(0,g.jsxs)("p",{className:"mt-3 text-sm text-slate-400",children:["Professional ",a.name.toLowerCase()," solutions"]}),(0,g.jsx)("p",{className:"mt-4 text-xs text-slate-500 group-hover:text-slate-300",children:"Explore â†’"})]},a.name))})]}),(0,g.jsxs)("div",{className:"mb-10",children:[(0,g.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{className:"text-2xl font-semibold",children:"Featured Products"}),(0,g.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Add to cart or request installation."})]}),(0,g.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,g.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"All"}),(0,g.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"Inverters"}),(0,g.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"Batteries"}),(0,g.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"Solar"})]})]}),(0,g.jsx)("div",{className:"mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:b.products?.slice(0,3).map(a=>(0,g.jsxs)("article",{className:"rounded-3xl border border-white/10 bg-white/5 p-5 hover:bg-white/10",children:[(0,g.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{className:"text-base font-semibold",children:a.name}),(0,g.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:a.category}),(0,g.jsx)("div",{className:"mt-3 flex items-center gap-2",children:(0,g.jsxs)("span",{className:"text-lg font-semibold text-green-500",children:["â‚¹",a.price?.toLocaleString()]})}),(0,g.jsx)("p",{className:"mt-2 text-xs text-slate-500",children:"â­ 4.5 â€¢ Reviews"})]}),(0,g.jsx)("div",{className:"grid h-14 w-14 place-items-center rounded-2xl bg-green-500/15 ring-1 ring-green-500/20",children:"âš¡"})]}),(0,g.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,g.jsx)("button",{onClick:()=>{o.find(b=>b.id===a.id)||p([...o,{...a,quantity:1}])},className:"w-full rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110",type:"button",children:"Add to Cart"}),(0,g.jsx)("button",{className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-center text-sm font-semibold hover:bg-white/10",children:"Install +"})]})]},a.id))})]}),(0,g.jsxs)("div",{className:"rounded-3xl p-8 lg:p-12 text-white",children:[(0,g.jsxs)("div",{className:"text-center mb-12",children:[(0,g.jsx)("h3",{className:"text-3xl font-bold mb-4 text-white",children:"Why Choose MJPOWER Solar?"}),(0,g.jsx)("p",{className:"text-lg text-gray-300",children:"Leading the way in sustainable energy solutions"})]}),(0,g.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,g.jsxs)("div",{className:"text-center",children:[(0,g.jsx)("div",{className:"w-16 h-16 bg-green-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,g.jsx)("span",{className:"text-2xl",children:"ðŸ†"})}),(0,g.jsx)("h4",{className:"text-lg font-semibold mb-2 text-white",children:"Expert Installation"}),(0,g.jsx)("p",{className:"text-gray-300",children:"Professional installation by certified technicians"})]}),(0,g.jsxs)("div",{className:"text-center",children:[(0,g.jsx)("div",{className:"w-16 h-16 bg-green-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,g.jsx)("span",{className:"text-2xl",children:"âš¡"})}),(0,g.jsx)("h4",{className:"text-lg font-semibold mb-2 text-white",children:"Premium Quality"}),(0,g.jsx)("p",{className:"text-gray-300",children:"High-efficiency solar panels and components"})]}),(0,g.jsxs)("div",{className:"text-center",children:[(0,g.jsx)("div",{className:"w-16 h-16 bg-green-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,g.jsx)("span",{className:"text-2xl",children:"ðŸ› ï¸"})}),(0,g.jsx)("h4",{className:"text-lg font-semibold mb-2 text-white",children:"24/7 Support"}),(0,g.jsx)("p",{className:"text-gray-300",children:"Round-the-clock maintenance and support"})]})]})]})]}),"services"===e&&(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"flex items-end justify-between gap-4 mb-6",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{className:"text-2xl font-semibold",children:"Services"}),(0,g.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Book onsite work, AMC, and audits."})]}),(0,g.jsx)("button",{className:"text-sm font-semibold text-green-500 hover:underline",children:"Request service â†’"})]}),(0,g.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:b.services?.map(a=>(0,g.jsxs)("article",{className:"rounded-3xl border border-white/10 bg-white/5 p-5 hover:bg-white/10",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsx)("h3",{className:"text-sm font-semibold",children:a.name}),(0,g.jsx)("span",{className:"rounded-2xl bg-green-500/15 px-3 py-2 text-green-500 ring-1 ring-green-500/20",children:"ðŸ”§"})]}),(0,g.jsx)("p",{className:"mt-3 text-sm text-slate-400",children:a.description}),(0,g.jsx)("div",{className:"mt-3 flex items-center gap-2",children:(0,g.jsxs)("span",{className:"text-lg font-semibold text-green-500",children:["â‚¹",a.price?.toLocaleString()]})}),(0,g.jsx)("button",{onClick:()=>{o.find(b=>b.id===a.id)||p([...o,{...a,quantity:1}])},className:"mt-5 inline-flex w-full items-center justify-center rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110",children:"Book Service"})]},a.id))})]}),"products"===e&&(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between mb-6",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{className:"text-2xl font-semibold",children:"Featured Products"}),(0,g.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Add to cart or request installation."})]}),(0,g.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,g.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"All"}),(0,g.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"Inverters"}),(0,g.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"Batteries"}),(0,g.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"Solar"})]})]}),(0,g.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:b.products?.map(a=>(0,g.jsxs)("article",{className:"rounded-3xl border border-white/10 bg-white/5 p-5 hover:bg-white/10",children:[(0,g.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{className:"text-base font-semibold",children:a.name}),(0,g.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:a.description}),(0,g.jsx)("div",{className:"mt-3 flex items-center gap-2",children:(0,g.jsxs)("span",{className:"text-lg font-semibold text-green-500",children:["â‚¹",a.price?.toLocaleString()]})}),(0,g.jsx)("p",{className:"mt-2 text-xs text-slate-500",children:"â­ 4.5 â€¢ Reviews"})]}),(0,g.jsx)("div",{className:"grid h-14 w-14 place-items-center rounded-2xl bg-green-500/15 ring-1 ring-green-500/20",children:"âš¡"})]}),(0,g.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,g.jsx)("button",{onClick:()=>{if(o.find(b=>b.id===a.id))f("cart");else{let b=j.quantity||1;p([...o,{...a,quantity:b}])}},className:"w-full rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110",children:o.find(b=>b.id===a.id)?"âœ“ In Cart":"Add to Cart"}),(0,g.jsx)("button",{className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-center text-sm font-semibold hover:bg-white/10",children:"Install +"})]})]},a.id))})]}),"get-quote"===e&&(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"flex items-end justify-between gap-4 mb-6",children:(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{className:"text-2xl font-semibold",children:"Get Solar Quote"}),(0,g.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Get a personalized solar solution estimate"})]})}),(0,g.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,g.jsxs)("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-5",children:[(0,g.jsx)("h3",{className:"text-base font-semibold mb-4",children:"Request Quote"}),(0,g.jsxs)("form",{onSubmit:async b=>{b.preventDefault();let c={...k,customerId:a?.id,customerName:a?.name||k.name,status:"pending",estimatedCost:Math.round(12*(parseInt(k.monthlyBill)||0)*8),estimatedSavings:Math.round(12*(parseInt(k.monthlyBill)||0)*.8),type:o.length>0?"cart-quote":"form-quote",...o.length>0&&{items:o.map(a=>({id:a.id,name:a.name,price:a.price,quantity:a.quantity,total:a.price*a.quantity})),subtotal:o.reduce((a,b)=>a+(b.price||0)*b.quantity,0),tax:Math.round(.18*o.reduce((a,b)=>a+(b.price||0)*b.quantity,0)),totalAmount:Math.round(1.18*o.reduce((a,b)=>a+(b.price||0)*b.quantity,0))}};try{let a=await S.quotes.createOne(c);a.err?alert("Error submitting quote: "+a.message):(alert("Quote request submitted successfully! We will contact you soon."),l({name:"",phone:"",email:"",address:"",propertyType:"residential",roofArea:"",monthlyBill:"",requirements:""}),p([]),f("home"))}catch(a){console.error("Error submitting quote:",a),a.message.includes("Network error")?alert("Connection failed. Please check if the server is running and try again."):alert("Error submitting quote: "+a.message)}},className:"space-y-3",children:[(0,g.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,g.jsx)("input",{type:"text",placeholder:"Full Name",value:k.name,onChange:a=>l({...k,name:a.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",required:!0}),(0,g.jsx)("input",{type:"tel",placeholder:"Phone Number",value:k.phone,onChange:a=>l({...k,phone:a.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",required:!0})]}),(0,g.jsx)("input",{type:"email",placeholder:"Email Address",value:k.email,onChange:a=>l({...k,email:a.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",required:!0}),(0,g.jsx)("textarea",{placeholder:"Installation Address",value:k.address,onChange:a=>l({...k,address:a.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",rows:2,required:!0}),(0,g.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,g.jsxs)("select",{value:k.propertyType,onChange:a=>l({...k,propertyType:a.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",children:[(0,g.jsx)("option",{value:"residential",children:"Residential"}),(0,g.jsx)("option",{value:"commercial",children:"Commercial"}),(0,g.jsx)("option",{value:"industrial",children:"Industrial"})]}),(0,g.jsx)("input",{type:"number",placeholder:"Roof Area (sq ft)",value:k.roofArea,onChange:a=>l({...k,roofArea:a.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20"})]}),(0,g.jsx)("input",{type:"number",placeholder:"Monthly Electricity Bill (â‚¹)",value:k.monthlyBill,onChange:a=>l({...k,monthlyBill:a.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",required:!0}),(0,g.jsx)("textarea",{placeholder:"Special Requirements or Questions",value:k.requirements,onChange:a=>l({...k,requirements:a.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",rows:2}),o.length>0&&(0,g.jsxs)("div",{className:"rounded-2xl border border-green-500/20 bg-green-500/5 p-4",children:[(0,g.jsx)("h4",{className:"text-sm font-semibold text-green-500 mb-3",children:"Selected Items"}),(0,g.jsx)("div",{className:"space-y-2",children:o.map(a=>(0,g.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,g.jsxs)("span",{children:[a.name," x",a.quantity]}),(0,g.jsxs)("span",{children:["â‚¹",(a.price*a.quantity).toLocaleString()]})]},a.id))}),(0,g.jsx)("div",{className:"border-t border-green-500/20 mt-3 pt-3",children:(0,g.jsxs)("div",{className:"flex justify-between text-sm font-semibold text-green-500",children:[(0,g.jsx)("span",{children:"Total (incl. tax):"}),(0,g.jsxs)("span",{children:["â‚¹",Math.round(1.18*o.reduce((a,b)=>a+(b.price||0)*b.quantity,0)).toLocaleString()]})]})})]}),(0,g.jsx)("button",{type:"submit",className:"w-full rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110",children:o.length>0?"Submit Quote Request":"Get Free Quote"})]})]}),(0,g.jsxs)("div",{className:"space-y-4",children:[(0,g.jsxs)("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-5",children:[(0,g.jsx)("h3",{className:"text-sm font-semibold mb-3",children:"Why Choose Solar?"}),(0,g.jsxs)("div",{className:"space-y-2",children:[(0,g.jsxs)("div",{className:"flex items-center gap-3",children:[(0,g.jsx)("div",{className:"w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center text-xs",children:"ðŸ’°"}),(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"text-sm font-semibold",children:"Save Money"}),(0,g.jsx)("div",{className:"text-xs text-slate-400",children:"Reduce electricity bills by 80%"})]})]}),(0,g.jsxs)("div",{className:"flex items-center gap-3",children:[(0,g.jsx)("div",{className:"w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center text-xs",children:"ðŸŒ±"}),(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"text-sm font-semibold",children:"Go Green"}),(0,g.jsx)("div",{className:"text-xs text-slate-400",children:"Reduce carbon footprint"})]})]}),(0,g.jsxs)("div",{className:"flex items-center gap-3",children:[(0,g.jsx)("div",{className:"w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center text-xs",children:"ðŸ“ˆ"}),(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"text-sm font-semibold",children:"Increase Value"}),(0,g.jsx)("div",{className:"text-xs text-slate-400",children:"Boost property value"})]})]})]})]}),(0,g.jsxs)("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-5",children:[(0,g.jsx)("h3",{className:"text-sm font-semibold mb-3",children:"Quick Estimate"}),k.monthlyBill&&(0,g.jsxs)("div",{className:"space-y-2",children:[(0,g.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,g.jsx)("span",{children:"Annual Bill:"}),(0,g.jsxs)("span",{children:["â‚¹",(12*parseInt(k.monthlyBill)).toLocaleString()]})]}),(0,g.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,g.jsx)("span",{children:"Estimated System Cost:"}),(0,g.jsxs)("span",{children:["â‚¹",(12*parseInt(k.monthlyBill)*8).toLocaleString()]})]}),(0,g.jsxs)("div",{className:"flex justify-between text-xs text-green-500",children:[(0,g.jsx)("span",{children:"Annual Savings:"}),(0,g.jsxs)("span",{children:["â‚¹",(12*parseInt(k.monthlyBill)*.8).toLocaleString()]})]})]}),!k.monthlyBill&&(0,g.jsx)("p",{className:"text-xs text-slate-400",children:"Enter your monthly bill to see estimate"})]})]})]})]}),"cart"===e&&(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"flex items-end justify-between gap-4 mb-6",children:(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{className:"text-2xl font-semibold",children:"Shopping Cart"}),(0,g.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Review your selected items"})]})}),0===o.length?(0,g.jsxs)("div",{className:"text-center py-8",children:[(0,g.jsx)("div",{className:"text-4xl mb-3",children:"ðŸ›’"}),(0,g.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Your cart is empty"}),(0,g.jsx)("p",{className:"text-sm text-slate-400 mb-4",children:"Add some solar products to get started!"}),(0,g.jsx)("button",{onClick:()=>f("products"),className:"rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110",children:"Browse Products"})]}):(0,g.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:o.map(a=>(0,g.jsxs)("article",{className:"rounded-3xl border border-white/10 bg-white/5 p-5 hover:bg-white/10",children:[(0,g.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{className:"text-base font-semibold",children:a.name}),(0,g.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:a.category}),(0,g.jsx)("div",{className:"mt-3 flex items-center gap-2",children:(0,g.jsxs)("span",{className:"text-lg font-semibold text-green-500",children:["â‚¹",a.price?.toLocaleString()]})})]}),(0,g.jsx)("div",{className:"grid h-14 w-14 place-items-center rounded-2xl bg-green-500/15 ring-1 ring-green-500/20",children:a.image?(0,g.jsx)("img",{src:C(a.image),alt:a.name,className:"w-full h-full object-cover rounded-2xl"}):(0,g.jsx)("span",{children:"âš¡"})})]}),(0,g.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,g.jsxs)("div",{className:"flex items-center gap-2",children:[(0,g.jsx)("button",{onClick:()=>{p(o.map(b=>b.id===a.id&&b.quantity>1?{...b,quantity:b.quantity-1}:b))},className:"w-8 h-8 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center text-sm font-semibold hover:bg-white/10 transition-all",children:"-"}),(0,g.jsx)("span",{className:"w-8 text-center text-sm font-semibold",children:a.quantity}),(0,g.jsx)("button",{onClick:()=>{p(o.map(b=>b.id===a.id?{...b,quantity:b.quantity+1}:b))},className:"w-8 h-8 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center text-sm font-semibold hover:bg-white/10 transition-all",children:"+"})]}),(0,g.jsx)("button",{onClick:()=>{p(o.filter(b=>b.id!==a.id))},className:"rounded-2xl border border-white/10 bg-white/5 px-3 py-2 text-sm font-semibold hover:bg-white/10",children:"Remove"})]})]},a.id))}),o.length>0&&(0,g.jsxs)("div",{className:"mt-6 rounded-3xl border border-white/10 bg-white/5 p-5",children:[(0,g.jsxs)("div",{className:"flex items-center justify-between",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"text-sm font-semibold",children:"Order Summary"}),(0,g.jsxs)("div",{className:"mt-1 text-xs text-slate-400",children:[o.length," items â€¢ Tax included"]})]}),(0,g.jsxs)("div",{className:"text-right",children:[(0,g.jsxs)("div",{className:"text-lg font-semibold text-green-500",children:["â‚¹",Math.round(1.18*o.reduce((a,b)=>a+(b.price||0)*b.quantity,0)).toLocaleString()]}),(0,g.jsx)("div",{className:"text-xs text-slate-400",children:"Total with 18% tax"})]})]}),(0,g.jsx)("button",{onClick:()=>{a&&l({...k,name:a.name||"",email:a.email||"",phone:a.phone||"",address:a.address||""}),f("get-quote")},className:"mt-5 inline-flex w-full items-center justify-center rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110",children:"ðŸ’° Generate Quote"})]})]}),"raise-ticket"===e&&(0,g.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,g.jsxs)("div",{className:"mb-6",children:[(0,g.jsx)("h2",{className:"text-2xl font-semibold",children:"Support Center"}),(0,g.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Get help with your solar solutions"})]}),(0,g.jsx)("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-6",children:a?(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Create Support Ticket"}),(0,g.jsxs)("form",{onSubmit:b=>{(b.preventDefault(),a)?(c("tickets",{...m,customerId:a.id,customerName:a.name,status:"open",assignedTo:"",createdBy:a.id,createdAt:new Date().toISOString()}),n({type:"product",itemId:"",issue:"",notes:""}),alert("Ticket raised successfully!")):r(!0)},className:"space-y-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Category"}),(0,g.jsxs)("select",{value:m.type,onChange:a=>n({...m,type:a.target.value,itemId:""}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",children:[(0,g.jsx)("option",{value:"product",children:"Solar Product"}),(0,g.jsx)("option",{value:"service",children:"Solar Service"})]})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Select Item"}),(0,g.jsxs)("select",{value:m.itemId,onChange:a=>n({...m,itemId:a.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",required:!0,children:[(0,g.jsxs)("option",{value:"",children:["Select ",m.type]}),("product"===m.type?b.products:b.services)&&Array.isArray("product"===m.type?b.products:b.services)?("product"===m.type?b.products:b.services).map(a=>(0,g.jsx)("option",{value:a.id,children:a.name},a.id)):null]})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Issue Description"}),(0,g.jsx)("textarea",{placeholder:"Describe your issue in detail...",value:m.issue,onChange:a=>n({...m,issue:a.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",rows:4,required:!0})]}),(0,g.jsx)("button",{type:"submit",className:"w-full rounded-2xl bg-green-500 px-5 py-3 text-sm font-semibold text-black hover:brightness-110",children:"Submit Support Ticket"})]})]}):(0,g.jsxs)("div",{className:"text-center py-8",children:[(0,g.jsx)("div",{className:"text-4xl mb-4",children:"ðŸ”’"}),(0,g.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Login Required"}),(0,g.jsx)("p",{className:"text-sm mb-6 text-slate-400",children:"Please login to raise a support ticket"}),(0,g.jsx)("button",{onClick:()=>{r(!0)},className:"rounded-2xl bg-green-500 px-6 py-2.5 text-sm font-semibold text-black hover:brightness-110",children:"Login to Continue"})]})})]}),"my-orders"===e&&(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"text-center mb-12",children:[(0,g.jsx)("h2",{className:`text-4xl font-bold mb-4 ${i?"text-white":"text-gray-900"}`,children:"My Orders"}),(0,g.jsx)("p",{className:`text-xl ${i?"text-white":"text-gray-900"}`,children:"Track your solar product orders"})]}),(0,g.jsxs)("div",{className:`rounded-2xl ${i?"text-white":"text-gray-900"}`,children:[(0,g.jsx)("div",{className:`p-6 border-b ${i?"text-white":"text-gray-900"}`,children:(0,g.jsx)("h3",{className:`text-xl font-semibold ${i?"text-white":"text-gray-900"}`,children:"Order History"})}),(0,g.jsx)("div",{className:"p-6",children:a?0===s.length?(0,g.jsxs)("div",{className:"text-center py-12",children:[(0,g.jsx)("div",{className:"text-6xl mb-6",children:"ðŸ“¦"}),(0,g.jsx)("h3",{className:`text-2xl font-semibold mb-4 ${i?"text-white":"text-gray-900"}`,children:"No Orders Yet"}),(0,g.jsx)("p",{className:`text-lg mb-8 ${i?"text-white":"text-gray-900"}`,children:"Start shopping for solar products"}),(0,g.jsx)("button",{onClick:()=>f("products"),className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-xl font-semibold text-lg transition-all transform hover:scale-105",children:"Browse Products"})]}):(0,g.jsx)("div",{className:"space-y-6",children:s.map(a=>(0,g.jsx)("div",{className:`p-6 rounded-2xl border transition-all hover:shadow-md ${i?"bg-gray-700 border-gray-600 hover:bg-gray-650":"bg-gray-50 border-gray-200 hover:bg-gray-100"}`,children:(0,g.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,g.jsxs)("div",{className:"flex-1",children:[(0,g.jsx)("h4",{className:`text-lg font-semibold mb-2 ${i?"text-white":"text-gray-900"}`,children:a.itemName}),(0,g.jsxs)("div",{className:"flex items-center space-x-4 mb-3",children:[(0,g.jsx)("span",{className:`text-sm px-3 py-1 rounded-full ${i?"text-white":"text-gray-900"}`,children:a.type}),"product"===a.type&&(0,g.jsxs)("span",{className:`text-sm ${i?"text-white":"text-gray-900"}`,children:["Qty: ",a.quantity]})]}),(0,g.jsxs)("p",{className:"text-xl font-bold text-teal-600 mb-2",children:["â‚¹",(a.totalPrice||a.itemPrice)?.toLocaleString()]}),a.description&&(0,g.jsx)("p",{className:`text-sm mb-2 ${i?"text-white":"text-gray-900"}`,children:a.description}),(0,g.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,g.jsxs)("span",{children:["Preferred: ",a.preferredDate]}),(0,g.jsxs)("span",{children:["Ordered: ",a.createdAt]})]})]}),(0,g.jsx)("span",{className:`px-4 py-2 rounded-full text-sm font-medium text-white ${"completed"===a.status?"bg-green-500":"in-progress"===a.status?"bg-blue-500":"bg-yellow-500"}`,children:a.status.charAt(0).toUpperCase()+a.status.slice(1)})]})},a.id))}):(0,g.jsxs)("div",{className:"text-center py-12",children:[(0,g.jsx)("div",{className:"text-6xl mb-6",children:"ðŸ”’"}),(0,g.jsx)("h3",{className:`text-2xl font-semibold mb-4 ${i?"text-white":"text-gray-900"}`,children:"Login Required"}),(0,g.jsx)("p",{className:`text-lg mb-8 ${i?"text-white":"text-gray-900"}`,children:"Please login to view your orders"}),(0,g.jsx)("button",{onClick:()=>{r(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-xl font-semibold text-lg transition-all transform hover:scale-105",children:"Login to Continue"})]})})]})]}),"my-tickets"===e&&(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{className:"text-center mb-12",children:[(0,g.jsx)("h2",{className:`text-4xl font-bold mb-4 ${i?"text-white":"text-gray-900"}`,children:"Support Tickets"}),(0,g.jsx)("p",{className:`text-xl ${i?"text-white":"text-gray-900"}`,children:"Track your support requests"})]}),(0,g.jsxs)("div",{className:`rounded-2xl ${i?"text-white":"text-gray-900"}`,children:[(0,g.jsx)("div",{className:`p-6 border-b ${i?"text-white":"text-gray-900"}`,children:(0,g.jsx)("h3",{className:`text-xl font-semibold ${i?"text-white":"text-gray-900"}`,children:"Ticket History"})}),(0,g.jsx)("div",{className:"p-6",children:a?0===t.length?(0,g.jsxs)("div",{className:"text-center py-12",children:[(0,g.jsx)("div",{className:"text-6xl mb-6",children:"ðŸŽŸï¸"}),(0,g.jsx)("h3",{className:`text-2xl font-semibold mb-4 ${i?"text-white":"text-gray-900"}`,children:"No Support Tickets"}),(0,g.jsx)("p",{className:`text-lg mb-8 ${i?"text-white":"text-gray-900"}`,children:"Need help? Create a support ticket"}),(0,g.jsx)("button",{onClick:()=>f("raise-ticket"),className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-xl font-semibold text-lg transition-all transform hover:scale-105",children:"Create Ticket"})]}):(0,g.jsx)("div",{className:"space-y-6",children:t.map(a=>{let c=("product"===a.type?b.products&&Array.isArray(b.products)?b.products:[]:b.services&&Array.isArray(b.services)?b.services:[]).find(b=>b.id==a.itemId);return(0,g.jsx)("div",{className:`p-6 rounded-2xl border transition-all hover:shadow-md ${i?"bg-gray-700 border-gray-600 hover:bg-gray-650":"bg-gray-50 border-gray-200 hover:bg-gray-100"}`,children:(0,g.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,g.jsxs)("div",{className:"flex-1",children:[(0,g.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,g.jsxs)("h4",{className:`text-lg font-semibold ${i?"text-white":"text-gray-900"}`,children:["Ticket #",a.id]}),(0,g.jsx)("span",{className:`text-sm px-3 py-1 rounded-full ${i?"text-white":"text-gray-900"}`,children:a.type})]}),(0,g.jsxs)("p",{className:`text-sm mb-2 ${i?"text-white":"text-gray-900"}`,children:["Related to: ",c?.name]}),(0,g.jsx)("p",{className:`mb-3 ${i?"text-white":"text-gray-900"}`,children:a.issue}),a.notes&&(0,g.jsxs)("p",{className:`text-sm mb-3 ${i?"text-white":"text-gray-900"}`,children:[(0,g.jsx)("span",{className:"font-medium",children:"Notes:"})," ",a.notes]}),(0,g.jsxs)("p",{className:"text-sm text-gray-500",children:["Created: ",new Date(a.createdAt).toLocaleDateString()]})]}),(0,g.jsx)("span",{className:`px-4 py-2 rounded-full text-sm font-medium text-white ${"closed"===a.status?"bg-gray-500":"completed"===a.status?"bg-green-500":"in-progress"===a.status?"bg-blue-500":"bg-yellow-500"}`,children:a.status.charAt(0).toUpperCase()+a.status.slice(1)})]})},a.id)})}):(0,g.jsxs)("div",{className:"text-center py-12",children:[(0,g.jsx)("div",{className:"text-6xl mb-6",children:"ðŸ”’"}),(0,g.jsx)("h3",{className:`text-2xl font-semibold mb-4 ${i?"text-white":"text-gray-900"}`,children:"Login Required"}),(0,g.jsx)("p",{className:`text-lg mb-8 ${i?"text-white":"text-gray-900"}`,children:"Please login to view your support tickets"}),(0,g.jsx)("button",{onClick:()=>{r(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-xl font-semibold text-lg transition-all transform hover:scale-105",children:"Login to Continue"})]})})]})]}),q&&(0,g.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,g.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full",children:[(0,g.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Customer Login"}),(0,g.jsxs)("form",{onSubmit:a=>{a.preventDefault();let c=new FormData(a.target),e=c.get("email"),f=c.get("password"),g=b.customers?.find(a=>a.email===e&&a.password===f);g?(d(e,f,{...g,role:"customer"}),r(!1)):alert("Invalid credentials")},className:"space-y-4",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),(0,g.jsx)("input",{name:"email",type:"email",required:!0,className:"w-full bg-gray-700 text-white px-3 py-2 rounded-lg border border-gray-600 focus:border-green-500 focus:outline-none",placeholder:"Enter your email"})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),(0,g.jsx)("input",{name:"password",type:"password",required:!0,className:"w-full bg-gray-700 text-white px-3 py-2 rounded-lg border border-gray-600 focus:border-green-500 focus:outline-none",placeholder:"Enter your password"})]}),(0,g.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,g.jsx)("button",{type:"button",onClick:()=>r(!1),className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-2 rounded-lg transition-colors",children:"Cancel"}),(0,g.jsx)("button",{type:"submit",className:"flex-1 bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg transition-colors",children:"Login"})]})]})]})})]})})]})};function U(){let{currentUser:a}=w(),[b,c]=(0,h.useState)(!1),[d,e]=(0,h.useState)(!1);return((0,h.useEffect)(()=>{c(!0)},[]),b)?d&&!a?(0,g.jsx)(z,{onBackToCustomer:()=>e(!1)}):a&&"customer"!==a.role?(0,g.jsx)(A,{children:(0,g.jsx)(L,{})}):(0,g.jsx)(T,{}):(0,g.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:"Loading..."})}let V=function(){return(0,g.jsx)("div",{className:"min-h-screen bg-white",children:(0,g.jsx)(x,{children:(0,g.jsx)(U,{})})})};function W(){return(0,g.jsx)(V,{})}a.s(["default",()=>W],5205);var X=a.i(5205),Y=a.i(9193);let Z=(0,d.hoist)(X,"default"),$=(0,d.hoist)(X,"getStaticProps"),_=(0,d.hoist)(X,"getStaticPaths"),aa=(0,d.hoist)(X,"getServerSideProps"),ab=(0,d.hoist)(X,"config"),ac=(0,d.hoist)(X,"reportWebVitals"),ad=(0,d.hoist)(X,"unstable_getStaticProps"),ae=(0,d.hoist)(X,"unstable_getStaticPaths"),af=(0,d.hoist)(X,"unstable_getStaticParams"),ag=(0,d.hoist)(X,"unstable_getServerProps"),ah=(0,d.hoist)(X,"unstable_getServerSideProps"),ai=new b.PagesRouteModule({definition:{kind:c.RouteKind.PAGES,page:"/index",pathname:"/",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:f.default,Document:e.default},userland:X}),aj=(0,Y.getHandler)({srcPage:"/index",config:ab,userland:X,routeModule:ai,getStaticPaths:_,getStaticProps:$,getServerSideProps:aa});a.s(["config",0,ab,"default",0,Z,"getServerSideProps",0,aa,"getStaticPaths",0,_,"getStaticProps",0,$,"handler",0,aj,"reportWebVitals",0,ac,"routeModule",0,ai,"unstable_getServerProps",0,ag,"unstable_getServerSideProps",0,ah,"unstable_getStaticParams",0,af,"unstable_getStaticPaths",0,ae,"unstable_getStaticProps",0,ad],7840)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_pages_560f034b.js.map