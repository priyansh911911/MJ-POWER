(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3181,e=>{"use strict";var t=e.i(1398),s=e.i(1788),r=e.i(6693),l=e.i(1376);e.i(461);let a="s3_mjpower_solar",n="http://localhost:4466",i=async(e,t,s={})=>{let{body:r,page:i,sort:d,joins:o,hidden:c,fields:x,filter:m,search:u,nearby:h,session:g,validation:p,permissions:b,loading:j=!0}=s,y={};c&&(y.hidden=c),m&&(y.filter=m),x&&(y.fields=x),g&&(y.session=g),h&&(y.nearby=h),o&&(y.collections=o),p&&(y.validation=p),b&&(y.permissions=b);let f=function(e,t,s){let r,l=((r=t.split("/")).length>2&&r.pop(),r.join("/")),a={fields:s?.fields,hidden:s?.hidden,filter:s?.filter,nearby:s?.nearby,collections:s?.joins,permissions:s?.permissions,validation:s?.validation};a.body_is_array=Array.isArray(s.body||{});let n=e+">"+l;for(let e in a)n+=e+":"+a[e];return e+":"+l+">"+function(e){let t,s=5381;for(let t=0;t<e.length;t++)s=(s<<5)+s^e.charCodeAt(t);let r="";for(let e=0;e<8;e++)s^=s<<13,s^=s>>>17,s^=s<<5,r+=String.fromCharCode(t=(t=(s>>>0)%62)<10?48+t:t<36?87+t:29+t);return r}(n)}(e,t,s),N=l.default[f]||!1;N?y.token=N:(y["token-key"]=f,y["token-path"]="C:\\Users\\priya\\OneDrive\\Documents\\GitHub\\MJ-POWER\\src\\services\\tokens.json");let v={page:i,sort:d,search:u};try{j&&console.log("Loading started...");let s={method:e.toUpperCase(),headers:{...y,"Content-Type":"application/json",app:a},body:r?JSON.stringify(r):null},l=t;if(v.page||v.sort||v.search){let e=new URLSearchParams(v);l+=`?${e.toString()}`}let i=N?n+l:"http://localhost:4466"+l;console.log(i,s);let d=await fetch(i,s);if(!d.ok)throw Error(`HTTP ${d.status}: ${d.statusText}`);return await d.json()}catch(t){if(console.error(`${e.toUpperCase()} Error:`,t.message),"Failed to fetch"===t.message)throw Error("Network error: Unable to connect to server. Please check your internet connection or try again later.");throw t}finally{j&&console.log("Loading completed.")}},d=async(e,t)=>i("get",e,t),o=async(e,t)=>i("put",e,t),c=async(e,t)=>i("post",e,t),x=async(e,t)=>i("delete",e,t),m=async(e,t)=>i("post",`/sql-${e.replace("/","")}`,t);class u{collection;constructor(e){this.collection=e}async findMany(e={}){try{console.log(`FQL: Fetching ${this.collection}`);let t=await d(`/${this.collection}`,{filter:e.filter,search:e.search,sort:e.sort,fields:e.fields,joins:e.joins,page:e.limit?`1,${e.limit}`:void 0});return console.log(`FQL: ${this.collection} result:`,t),{result:t?.result||t?.data||t||[]}}catch(e){return console.error(`FQL: Error fetching ${this.collection}:`,e),{result:[],err:e}}}async findById(e,t={}){try{return{result:await d(`/${this.collection}/${e}`,{fields:t.fields,joins:t.joins,session:t.useSession?"true":void 0})}}catch(e){return{result:null,err:e}}}async findLast(e={}){try{return{result:await d(`/${this.collection}/last`,{filter:e.filter,search:e.search,sort:e.sort,fields:e.fields,joins:e.joins,session:e.useSession?"true":void 0})}}catch(e){return{result:null,err:e}}}async createOne(e,t={}){try{console.log(`FQL: Creating ${this.collection}:`,e),console.log(`FQL: API endpoint will be: /${this.collection}`),"products"===this.collection&&console.log("PRODUCTS: Forcing correct endpoint");let t=await c(`/${this.collection}`,{body:e});return console.log(`FQL: Create ${this.collection} result:`,t),{result:t?.result||{id:t?.id||Date.now()}}}catch(e){return console.error(`FQL: Error creating ${this.collection}:`,e),{result:{id:0},err:e}}}async createMany(e,t={}){try{return{result:await c(`/${this.collection}/batch`,{body:e,session:t.useSession?"true":void 0})}}catch(e){return{result:{ids:[]},err:e}}}async updateById(e,t,s={}){try{return await o(`/${this.collection}/${e}`,{body:t,session:s.useSession?"true":void 0}),{result:!0}}catch(e){return{result:!1,err:e}}}async updateMany(e,t={}){try{return await o(`/${this.collection}/batch`,{body:e,session:t.useSession?"true":void 0}),{result:!0}}catch(e){return{result:!1,err:e}}}async softDeleteById(e,t={}){try{return await o(`/${this.collection}/${e}`,{body:{is_deleted:1},session:t.useSession?"true":void 0}),{result:!0}}catch(e){return{result:!1,err:e}}}}class h{sales=new u("sales");purchases=new u("purchases");purchase_entries=new u("purchase_entries");receipts=new u("receipts");customers=new u("customers");vendors=new u("vendors");items=new u("items");units=new u("units");areas=new u("areas");clients=new u("clients");roles=new u("roles");users=new u("users");products=new u("products");services=new u("services");orders=new u("orders");tickets=new u("tickets");quotes=new u("quotes");async sql(e,t=[],s={}){try{return{result:await m("query",{body:{sql:e,params:t},session:s.useSession?"true":void 0})}}catch(e){return{result:[],err:e}}}}let g=new h,p=(0,s.createContext)({}),b=()=>{let e=(0,s.useContext)(p);if(!e)throw Error("useApp must be used within an AppProvider");return e},j=({children:e})=>{let[l,a]=(0,s.useState)(()=>{{let e=localStorage.getItem("mjpower-data");return e?JSON.parse(e):r.default}}),[n,i]=(0,s.useState)(()=>{{let e=localStorage.getItem("mjpower-user");return e?JSON.parse(e):null}}),[o,x]=(0,s.useState)("dashboard"),[m,u]=(0,s.useState)(!1);(0,s.useEffect)(()=>{localStorage.setItem("mjpower-data",JSON.stringify(l))},[l]),(0,s.useEffect)(()=>{h()},[]);let h=async()=>{try{let[e,t,s,l,n]=await Promise.all([g.customers.findMany({fields:"*"}),g.products.findMany({fields:"*"}),g.services.findMany({fields:"*"}),g.tickets.findMany({fields:"*"}),g.quotes.findMany({fields:"*"})]);console.log("Raw FQL responses:",{customers:e,products:t,services:s,tickets:l,quotes:n});let i=t?.result||[],o=s?.result||[];if(t?.token&&!t?.result)try{let e=await d(`/products?token=${t.token}`);i=e?.result||[]}catch(e){console.log("Token fetch failed for products, using empty array")}if(s?.token&&!s?.result)try{let e=await d(`/services?token=${s.token}`);o=e?.result||[]}catch(e){console.log("Token fetch failed for services, using empty array")}console.log("Setting data from FQL:",{customers:e?.result||e||[],products:i,services:o,tickets:l?.result||l||[],quotes:n?.result||n||[]}),a({...r.default,customers:e?.result||e||[],products:i,services:o,tickets:l?.result||l||[],quotes:n?.result||n||[],orders:[]})}catch(e){console.error("Failed to load from database:",e)}},b=async()=>{try{await c("/mjpower_data",{body:l})}catch(e){console.error("Cloud sync failed:",e)}},j=async()=>{try{let e=await d("/mjpower_data");e&&a(e)}catch(e){console.error("Cloud load failed:",e)}};(0,s.useEffect)(()=>{n?localStorage.setItem("mjpower-user",JSON.stringify(n)):localStorage.removeItem("mjpower-user")},[n]);let y=async(e,t)=>{try{if(!t?.trim())return void a(t=>({...t,[e]:[]}));let s=await g.products.findMany({}),r=s.result?.filter(e=>e.name.toLowerCase().includes(t.toLowerCase()))||[];a(t=>({...t,[e]:r}))}catch(t){console.error("fetchData error:",t),a(t=>({...t,[e]:[]}))}},f=async(e,t)=>{try{console.log(`=== Adding item to ${e} ===`),console.log("Item data:",t),console.log("FQL collection exists:",!!g[e]);let s=await g[e].createOne(t,{});if(console.log("FQL response:",s),s.err)throw console.log("API returned error, falling back to local storage"),Error(s.err.message||s.result);let r={...t,id:s.result.id};return a(t=>({...t,[e]:[...t[e]||[],r]})),console.log(`Successfully added to ${e}:`,r),"products"===e&&setTimeout(async()=>{let e=await g.products.findMany({});console.log("=== Current Products in Database ===",e)},1e3),r}catch(r){console.error(`Database add failed for ${e}:`,r);let s={...t,id:Date.now()};return a(t=>({...t,[e]:[...t[e]||[],s]})),s}},N=async(e,t,s)=>{try{await g[e].updateById(t,s,{useSession:!0}),a(r=>({...r,[e]:r[e].map(e=>e.id===t?{...e,...s}:e)}))}catch(r){console.error("Database update failed:",r),a(r=>({...r,[e]:r[e].map(e=>e.id===t?{...e,...s}:e)}))}},v=async(e,t)=>{try{await g[e].softDeleteById(t,{useSession:!0}),a(s=>({...s,[e]:s[e].filter(e=>e.id!==t)}))}catch(s){console.error("Database delete failed:",s),a(s=>({...s,[e]:s[e].filter(e=>e.id!==t)}))}};return(0,t.jsx)(p.Provider,{value:{data:l,currentUser:n,currentPage:o,setCurrentPage:x,login:(e,t,s=null)=>{if(s)return i(s),!0;let r=l.users?.find(s=>s.username===e&&s.password===t);return!!r&&(i(r),!0)},logout:()=>{i(null),x("dashboard")},updateData:(e,t)=>{a(s=>({...s,[e]:t}))},addItem:f,updateItem:N,deleteItem:v,useCloud:m,setUseCloud:u,syncToCloud:b,loadFromCloud:j,fetchData:y},children:e})},y={src:e.i(5613).default,width:552,height:452,blurWidth:8,blurHeight:7,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAHCAYAAAA1WQxeAAAAqklEQVR42o2OvQrCMACEY1pjIYXqYG2aEiQKDoKDONtBURcFIe2iXSr4Myi0QaxTBcHZxcHHcPPxrIuDi37HccMtHwD/AvOwUGrobUy0Kshl+aZYxy332nx2DrW7gqD2OSqmWfaEGI827t6/DR678/oSBHN/EYYzSikBnHN2StN4OO1PeqLrxVG0PCbJVkq5YoxRoKoqpLZtOA41stVtQvC7xLIwQkj5Kf8CEi0bWzA9qscAAAAASUVORK5CYII="},f=({onBackToCustomer:e})=>{let[r,l]=(0,s.useState)(""),[a,n]=(0,s.useState)(""),[i,d]=(0,s.useState)(""),[o,c]=(0,s.useState)(!1),[x,m]=(0,s.useState)(!1),[u,h]=(0,s.useState)(""),[g,p]=(0,s.useState)(""),[j,f]=(0,s.useState)(""),{login:N,addItem:v,data:w}=b(),k=e=>{if(e.preventDefault(),o){let e=w.customers.find(e=>e.email===r&&e.password===a);if(e){let t={...e,role:"customer"};N(e.email,e.password,t),d("")}else d("Invalid customer credentials")}else N(r,a)?d(""):d("Invalid credentials")};return o?(0,t.jsxs)("div",{className:"min-h-screen bg-blue-600 flex",children:[(0,t.jsx)("div",{className:"hidden lg:flex lg:w-1/2 bg-blue-600 items-center justify-center p-8",children:(0,t.jsxs)("div",{className:"text-center text-white",children:[(0,t.jsx)("div",{className:"bg-white rounded-2xl p-6 inline-block mb-6 shadow-2xl",children:(0,t.jsx)("img",{src:y,alt:"MJ POWER Solar",className:"w-32 h-auto"})}),(0,t.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"MJ POWER Solar"}),(0,t.jsx)("p",{className:"text-xl text-blue-100 mb-8",children:"Your trusted partner in clean energy solutions"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:"ðŸŒž"}),(0,t.jsx)("div",{children:"Premium Solar Panels"})]}),(0,t.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:"âš¡"}),(0,t.jsx)("div",{children:"Expert Installation"})]}),(0,t.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:"ðŸ”§"}),(0,t.jsx)("div",{children:"24/7 Support"})]}),(0,t.jsxs)("div",{className:"bg-white/10 p-4 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:"ðŸ’°"}),(0,t.jsx)("div",{children:"Best Prices"})]})]})]})}),(0,t.jsx)("div",{className:"w-full lg:w-1/2 bg-white flex items-center justify-center p-8",children:(0,t.jsxs)("div",{className:"w-full max-w-md",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("div",{className:"lg:hidden bg-blue-600 rounded-xl p-3 inline-block mb-4",children:(0,t.jsx)("img",{src:y,alt:"MJ POWER Solar",className:"w-16 h-auto"})}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Fixed Text"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Fixed Text"})]}),(0,t.jsxs)("form",{onSubmit:x?e=>{(e.preventDefault(),w.customers.find(e=>e.email===r))?d("Customer with this email already exists"):(v("customers",{name:u,email:r,phone:g,address:j,password:a,assignedTo:"",assignedType:"partner"}),d(""),m(!1),h(""),p(""),f(""),l(""),n(""),alert("Registration successful! You can now login."))}:k,className:"space-y-4",children:[x&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"Full Name"}),(0,t.jsx)("input",{type:"text",placeholder:"Enter your full name",value:u,onChange:e=>h(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900",required:!0})]}),x&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"Phone Number"}),(0,t.jsx)("input",{type:"tel",placeholder:"Enter your phone number",value:g,onChange:e=>p(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"Email Address"}),(0,t.jsx)("input",{type:"email",placeholder:"Enter your email",value:r,onChange:e=>l(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"Password"}),(0,t.jsx)("input",{type:"password",placeholder:"Enter your password",value:a,onChange:e=>n(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900",required:!0})]}),i&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg text-center",children:i}),x&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"Installation Address"}),(0,t.jsx)("textarea",{placeholder:"Enter your address for solar installation",value:j,onChange:e=>f(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-gray-900",rows:3})]}),(0,t.jsx)("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition-all duration-200 shadow-md hover:shadow-lg",children:"Fixed Text"}),x&&(0,t.jsx)("button",{type:"button",onClick:()=>{m(!1),h(""),p(""),f(""),l(""),n(""),d("")},className:"w-full mt-3 bg-gray-500 hover:bg-gray-600 text-white font-semibold py-3 rounded-lg transition-all duration-200",children:"Cancel"})]}),(0,t.jsxs)("div",{className:"mt-6 text-center space-y-3",children:[!x&&(0,t.jsx)("button",{onClick:()=>{e?e():(c(!o),d(""),l(""),n(""))},className:"text-blue-600 hover:text-blue-800 text-sm font-medium underline",children:"Back to Customer Portal"}),!x&&(0,t.jsx)("div",{children:(0,t.jsx)("button",{onClick:()=>{m(!0),d("")},className:"text-blue-600 hover:text-blue-800 text-sm font-medium underline",children:"New customer? Create account"})})]})]})})]}):(0,t.jsxs)("div",{className:"min-h-screen bg-white flex items-center justify-center p-4",children:[(0,t.jsxs)("div",{className:"absolute inset-0 opacity-10",children:[(0,t.jsx)("div",{className:"absolute top-10 left-10 w-32 h-32 border-4 border-yellow-400 rotate-12"}),(0,t.jsx)("div",{className:"absolute bottom-20 right-20 w-40 h-40 border-4 border-yellow-400 -rotate-12"}),(0,t.jsx)("div",{className:"absolute top-1/2 left-1/4 w-24 h-24 border-4 border-green-400 rotate-45"})]}),(0,t.jsxs)("div",{className:"w-full max-w-md relative z-10",children:[(0,t.jsxs)("div",{className:"text-center mb-6 sm:mb-8",children:[(0,t.jsx)("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-2xl p-3 sm:p-4 inline-block mb-4 sm:mb-6 shadow-2xl",children:(0,t.jsx)("img",{src:y,alt:"MJ POWER Solar",className:"w-24 sm:w-32 h-auto"})}),(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-black mb-2 drop-shadow-lg",children:"Solar Staff Portal"}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-gray-700",children:"Power the future with solar"})]}),(0,t.jsxs)("form",{onSubmit:k,className:"bg-white rounded-2xl p-6 sm:p-8 shadow-xl border border-gray-200 space-y-4 sm:space-y-5",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-blue-900 font-semibold mb-2 text-sm sm:text-base flex items-center",children:[(0,t.jsx)("span",{className:"mr-2",children:"ðŸ‘¤"})," Username"]}),(0,t.jsx)("input",{type:"text",placeholder:"Enter your username",value:r,onChange:e=>l(e.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 bg-blue-50 border-2 border-blue-200 rounded-lg text-gray-800 focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-200 text-sm sm:text-base transition-all",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-blue-900 font-semibold mb-2 text-sm sm:text-base flex items-center",children:[(0,t.jsx)("span",{className:"mr-2",children:"ðŸ”’"})," Password"]}),(0,t.jsx)("input",{type:"password",placeholder:"Enter your password",value:a,onChange:e=>n(e.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-3 bg-blue-50 border-2 border-blue-200 rounded-lg text-gray-800 focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-200 text-sm sm:text-base transition-all",required:!0})]}),i&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-3 sm:px-4 py-2 sm:py-3 rounded-lg text-center text-sm sm:text-base",children:i}),(0,t.jsx)("div",{className:"pt-2 sm:pt-4",children:(0,t.jsxs)("button",{type:"submit",className:"w-full bg-gradient-to-r from-orange-600 to-orange-500 text-white font-bold py-3 sm:py-4 rounded-lg hover:from-orange-700 hover:to-orange-600 text-sm sm:text-base shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 flex items-center justify-center",children:[(0,t.jsx)("span",{className:"mr-2",children:"âš¡"}),"Staff Login"]})})]}),(0,t.jsx)("div",{className:"mt-6 text-center space-y-3",children:(0,t.jsx)("button",{onClick:()=>{e?e():(c(!o),d(""),l(""),n(""))},className:"text-black hover:text-blue-600 text-sm font-semibold bg-gray-100 px-6 py-2 rounded-full hover:bg-gray-200 transition-all duration-200",children:"ðŸ  Back to Customer Portal"})})]})]})},N=({children:e})=>{let{currentUser:r,logout:l,setCurrentPage:a}=b(),[n,i]=(0,s.useState)("Dashboard"),[d,o]=(0,s.useState)(!1),[c,x]=(0,s.useState)(!1);return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 text-gray-900 flex relative",children:[(0,t.jsx)("div",{className:"lg:hidden fixed top-0 left-0 right-0 z-50 bg-white border-b border-gray-200 p-2 shadow-sm",children:(0,t.jsx)("button",{onClick:()=>o(!d),className:"bg-white/10 backdrop-blur-sm p-2 rounded-lg border border-yellow-400 hover:bg-white/20 transition-all",children:(0,t.jsx)("span",{className:"text-yellow-300 text-xl",children:"â˜°"})})}),(0,t.jsx)("div",{className:"hidden lg:block fixed top-2 left-2 z-50",children:(0,t.jsx)("button",{onClick:()=>x(!c),className:"bg-white/10 backdrop-blur-sm p-2 rounded-lg border border-yellow-400 hover:bg-white/20 transition-all",children:(0,t.jsx)("span",{className:"text-yellow-300 text-lg",children:"â˜°"})})}),d&&(0,t.jsx)("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>o(!1)}),(0,t.jsxs)("div",{className:`fixed inset-y-0 left-0 z-40 w-64 bg-white border-r border-gray-200 flex flex-col h-screen overflow-y-auto transition-transform duration-300 ease-in-out shadow-lg ${d?"translate-x-0":"-translate-x-full"} lg:translate-x-0 ${c?"lg:-translate-x-full":""}`,children:[(0,t.jsxs)("div",{className:"flex-1 p-1 lg:p-2",children:[(0,t.jsx)("div",{className:"flex justify-center mb-2",children:(0,t.jsx)("div",{className:"bg-orange-500 p-2 rounded-xl flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-white font-bold text-xl",children:"MJ"})})}),(0,t.jsx)("nav",{children:(0,t.jsx)("ul",{className:"space-y-0.5 lg:space-y-1",children:({admin:[{name:"Dashboard",icon:"â˜€ï¸"},{name:"Customers",icon:"ðŸ‘¥"},{name:"Products",icon:"ðŸ”‹"},{name:"Services",icon:"âš¡"},{name:"Quotes",icon:"ðŸ“‹"},{name:"Tickets",icon:"ðŸŽ«"},{name:"Add Technician",icon:"ðŸ‘¨ðŸ”§"},{name:"Add Partner",icon:"ðŸ¤"},{name:"Reports",icon:"ðŸ“Š"}],manager:[{name:"Dashboard",icon:"â˜€ï¸"},{name:"Tickets",icon:"ðŸŽ«"},{name:"Reports",icon:"ðŸ“Š"}],partner:[{name:"Dashboard",icon:"â˜€ï¸"},{name:"Customers",icon:"ðŸ‘¥"},{name:"Tickets",icon:"ðŸŽ«"}],technician:[{name:"Dashboard",icon:"â˜€ï¸"},{name:"Tickets",icon:"ðŸŽ«"}]})[r?.role]?.map(e=>(0,t.jsx)("li",{children:(0,t.jsxs)("button",{onClick:()=>{i(e.name),a(e.name.toLowerCase()),o(!1)},className:`w-full flex items-center gap-1.5 lg:gap-2 px-2 lg:px-3 py-1.5 lg:py-2 rounded-lg transition-all duration-200 ${n===e.name?"bg-orange-200 text-orange-800 shadow-sm":"text-gray-700 hover:bg-gray-100"}`,children:[(0,t.jsx)("span",{className:"text-sm lg:text-base",children:e.icon}),(0,t.jsx)("span",{className:"font-medium text-xs",children:e.name})]})},e.name))})})]}),(0,t.jsx)("div",{className:"p-1.5 lg:p-2 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-medium text-gray-900",children:r?.name}),(0,t.jsx)("p",{className:"text-xs text-gray-600 capitalize",children:r?.role})]}),(0,t.jsx)("button",{onClick:l,className:"bg-red-500 hover:bg-red-600 text-white px-1.5 py-0.5 rounded text-xs transition-all",children:"Logout"})]})})]}),(0,t.jsx)("div",{className:`flex-1 overflow-y-auto transition-all duration-300 ${c?"lg:ml-0":"lg:ml-64"} ml-0`,children:(0,t.jsx)("main",{className:"p-3 sm:p-4 lg:p-6 pt-16 lg:pt-6",children:e})})]})},v=()=>{let{data:e,addItem:r,updateItem:l,deleteItem:a,currentUser:n}=b(),[i,d]=(0,s.useState)(!1),[o,c]=(0,s.useState)(null),[x,m]=(0,s.useState)({name:"",email:"",phone:"",address:"",assignedTo:"",assignedType:"partner"}),u=["admin","partner"].includes(n?.role),h=async e=>{e.preventDefault();try{o?await l("customers",o.id,x):await r("customers",x),g()}catch(e){console.error("Error saving customer:",e),alert("Failed to save customer. Please try again.")}},g=()=>{m({name:"",email:"",phone:"",address:"",assignedTo:"",assignedType:"partner"}),d(!1),c(null)},p=e=>{m(e),c(e),d(!0)};return(0,t.jsxs)("div",{className:"p-2 sm:p-4",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 sm:mb-6 gap-3",children:[(0,t.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Customers"}),u&&(0,t.jsx)("button",{onClick:()=>d(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 sm:px-4 sm:py-2 rounded-lg text-sm sm:text-base",children:"Add Customer"})]}),i&&u&&(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200 mb-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:o?"Edit Customer":"Add Customer"}),(0,t.jsxs)("form",{onSubmit:h,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsx)("input",{type:"text",placeholder:"Customer Name",value:x.name,onChange:e=>m({...x,name:e.target.value}),className:"p-3 border border-gray-300 rounded-lg",required:!0}),(0,t.jsx)("input",{type:"email",placeholder:"Email",value:x.email,onChange:e=>m({...x,email:e.target.value}),className:"p-3 border border-gray-300 rounded-lg",required:!0}),(0,t.jsx)("input",{type:"tel",placeholder:"Phone",value:x.phone,onChange:e=>m({...x,phone:e.target.value}),className:"p-3 border border-gray-300 rounded-lg",required:!0}),(0,t.jsxs)("select",{value:x.assignedType,onChange:e=>m({...x,assignedType:e.target.value}),className:"p-3 border border-gray-300 rounded-lg",children:[(0,t.jsx)("option",{value:"partner",children:"Partner"}),(0,t.jsx)("option",{value:"technician",children:"Technician"})]}),(0,t.jsx)("textarea",{placeholder:"Address",value:x.address,onChange:e=>m({...x,address:e.target.value}),className:"md:col-span-2 p-3 border border-gray-300 rounded-lg",rows:3}),(0,t.jsxs)("div",{className:"md:col-span-2 flex gap-2",children:[(0,t.jsx)("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg",children:o?"Update Customer":"Add Customer"}),(0,t.jsx)("button",{type:"button",onClick:g,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg",children:"Cancel"})]})]})]}),(0,t.jsx)("div",{className:"block sm:hidden space-y-3",children:e.customers?.map(e=>(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:e.name}),u&&(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>p(e),className:"bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>a("customers",e.id),className:"bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs",children:"Delete"})]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:e.email}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:e.phone}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[e.assignedTo," (",e.assignedType,")"]})]},e.id))}),(0,t.jsx)("div",{className:"hidden sm:block bg-white rounded-lg border border-gray-200 overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Name"}),(0,t.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Email"}),(0,t.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Phone"}),(0,t.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Assigned To"}),u&&(0,t.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:e.customers?.map(e=>(0,t.jsxs)("tr",{className:"border-t",children:[(0,t.jsx)("td",{className:"p-3 text-sm",children:e.name}),(0,t.jsx)("td",{className:"p-3 text-sm",children:e.email}),(0,t.jsx)("td",{className:"p-3 text-sm",children:e.phone}),(0,t.jsxs)("td",{className:"p-3 text-sm",children:[e.assignedTo," (",e.assignedType,")"]}),u&&(0,t.jsxs)("td",{className:"p-3",children:[(0,t.jsx)("button",{onClick:()=>p(e),className:"bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded mr-2 text-sm",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>a("customers",e.id),className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm",children:"Delete"})]})]},e.id))})]})})]})};function w(e){return e?e.startsWith("http://")||e.startsWith("https://")?e:`https://uploads.backendservices.in/storage/admin/packages/${e}`:""}async function k(e){console.log("ðŸ–¼ï¸ Starting image upload..."),console.log("File:",e.name,"Size:",e.size,"Type:",e.type),console.log("Upload URL:","https://uploads.backendservices.in/api");let t=new FormData;t.append("folder","packages"),t.append("image",e);try{console.log("ðŸ“¤ Sending upload request...");let e=await fetch("https://uploads.backendservices.in/api",{method:"POST",headers:{username:"admin",password:"arodos"},body:t});if(console.log("ðŸ“¥ Upload response status:",e.status),console.log("ðŸ“¥ Upload response ok:",e.ok),!e.ok){let t=await e.text();throw console.error("âŒ Upload failed response:",t),Error(`Upload failed with status ${e.status}: ${t}`)}let s=await e.json();console.log("âœ… Upload response data:",s);let r=s?.files?.image;if(console.log("ðŸ“ Image path from response:",r),!r)return console.error("âŒ No image path in response"),null;let l=r.split("/"),a=l[l.length-1]||null;return console.log("ðŸ“„ Final filename:",a),a}catch(e){return console.error("âŒ Upload Error:",e.message),console.error("âŒ Full error:",e),null}}let C=()=>{let{data:e,addItem:r,updateItem:l,deleteItem:a,currentUser:n}=b(),[i,d]=(0,s.useState)(!1),[o,c]=(0,s.useState)(null),[x,m]=(0,s.useState)({name:"",category:"",price:"",description:"",specifications:"",image:"",gstPercent:"18",partnerCommissionPercent:"10",technicianCommissionPercent:"5"}),[u,h]=(0,s.useState)(!1),g=["admin","manager"].includes(n?.role),p=e.categories?.filter(e=>"product"===e.type)||[],j=async e=>{let t=e.target.files[0];if(t){h(!0);try{let e=await k(t);m({...x,image:e||""})}catch(e){alert("Image upload failed")}h(!1)}};(0,s.useEffect)(()=>{},[]);let y=async e=>{e.preventDefault();let t={name:x.name,category:x.category,price:parseFloat(x.price),description:x.description||"",specifications:x.specifications||"",image:x.image||"",gstPercent:parseFloat(x.gstPercent),partnerCommissionPercent:parseFloat(x.partnerCommissionPercent),technicianCommissionPercent:parseFloat(x.technicianCommissionPercent)};console.log("Submitting product data:",t);try{if(o)await l("products",o.id,t),console.log("Product updated successfully");else{let e=await r("products",t);console.log("Product added successfully:",e)}f()}catch(e){console.error("Error saving product:",e),alert("Error saving product. Check console for details.")}},f=()=>{m({name:"",category:"",price:"",description:"",specifications:"",image:"",gstPercent:"18",partnerCommissionPercent:"10",technicianCommissionPercent:"5"}),d(!1),c(null)},N=e=>{m(e),c(e),d(!0)};return(0,t.jsxs)("div",{className:"p-2",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-2 relative z-10",children:[(0,t.jsxs)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 flex items-center",children:[(0,t.jsx)("span",{className:"mr-2",children:"ðŸ”‹"})," Solar Products"]}),g&&(0,t.jsx)("button",{onClick:()=>d(!0),className:"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-700 hover:to-green-600 text-white px-4 py-2 rounded-lg font-semibold shadow-lg transition-all w-full sm:w-auto whitespace-nowrap",children:"+ Add Product"})]}),i&&g&&(0,t.jsxs)("div",{className:"bg-white/10 backdrop-blur-xl border border-yellow-400/30 p-4 sm:p-6 rounded-xl mb-4 shadow-lg relative z-10",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-yellow-300 mb-4",children:o?"Edit Product":"Add Product"}),(0,t.jsxs)("form",{onSubmit:y,className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,t.jsx)("input",{type:"text",placeholder:"Product Name (e.g., Solar Panel 500W)",value:x.name,onChange:e=>m({...x,name:e.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all",required:!0}),(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:j,className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 outline-none transition-all"}),u&&(0,t.jsx)("p",{className:"text-yellow-300 text-sm mt-1",children:"Uploading..."}),x.image&&(0,t.jsx)("img",{src:w(x.image),alt:"Preview",className:"mt-2 h-20 w-20 object-cover rounded"})]}),(0,t.jsxs)("select",{value:x.category,onChange:e=>m({...x,category:e.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select Category"}),p.map((e,s)=>(0,t.jsx)("option",{value:e.name,children:e.name},e.id||s))]}),(0,t.jsx)("input",{type:"number",step:"0.01",placeholder:"Price (â‚¹)",value:x.price,onChange:e=>m({...x,price:e.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all",required:!0}),(0,t.jsx)("textarea",{placeholder:"Product Description",value:x.description,onChange:e=>m({...x,description:e.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all",rows:3}),(0,t.jsx)("textarea",{placeholder:"Technical Specifications",value:x.specifications,onChange:e=>m({...x,specifications:e.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all",rows:2}),(0,t.jsx)("input",{type:"number",step:"0.01",placeholder:"GST %",value:x.gstPercent,onChange:e=>m({...x,gstPercent:e.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all"}),(0,t.jsx)("input",{type:"number",step:"0.01",placeholder:"Partner Commission %",value:x.partnerCommissionPercent,onChange:e=>m({...x,partnerCommissionPercent:e.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all"}),(0,t.jsx)("input",{type:"number",step:"0.01",placeholder:"Technician Commission %",value:x.technicianCommissionPercent,onChange:e=>m({...x,technicianCommissionPercent:e.target.value}),className:"p-3 bg-white/10 text-white rounded-lg border border-blue-300/30 focus:border-green-500 focus:ring-2 focus:ring-green-200 outline-none transition-all"}),(0,t.jsxs)("div",{className:"sm:col-span-2 flex flex-col sm:flex-row gap-2",children:[(0,t.jsx)("button",{type:"submit",className:"bg-gradient-to-r from-green-600 to-green-500 hover:from-green-700 hover:to-green-600 text-white px-4 py-2 rounded-lg font-semibold shadow-lg transition-all",children:o?"Update Product":"Add Product"}),(0,t.jsx)("button",{type:"button",onClick:f,className:"bg-gradient-to-r from-gray-600 to-gray-500 hover:from-gray-700 hover:to-gray-600 text-white px-4 py-2 rounded-lg font-semibold shadow-md transition-all",children:"Cancel"})]})]})]}),(0,t.jsx)("div",{className:"hidden md:block bg-white border border-gray-200 rounded-xl overflow-hidden shadow-lg",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Product Name"}),(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Category"}),(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Price"}),(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"GST %"}),(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Partner %"}),(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Tech %"}),g&&(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:e.products?.length>0?e.products.map(e=>{let s=e.image&&""!==e.image.trim();return(0,t.jsxs)("tr",{className:"border-t border-gray-200 hover:bg-gray-50 transition-all",children:[(0,t.jsx)("td",{className:"p-3 text-gray-900",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[s?(0,t.jsx)("img",{src:w(e.image),alt:e.name,className:"h-10 w-10 object-cover rounded"}):(0,t.jsx)("div",{className:"h-10 w-10 rounded bg-white/10 flex items-center justify-center text-xs text-blue-200",children:"No Img"}),e.name]})}),(0,t.jsx)("td",{className:"p-3 text-gray-700",children:e.category}),(0,t.jsxs)("td",{className:"p-3 text-green-600 font-semibold",children:["â‚¹",e.price]}),(0,t.jsxs)("td",{className:"p-3 text-gray-700",children:[e.gstPercent,"%"]}),(0,t.jsxs)("td",{className:"p-3 text-gray-700",children:[e.partnerCommissionPercent,"%"]}),(0,t.jsxs)("td",{className:"p-3 text-gray-700",children:[e.technicianCommissionPercent,"%"]}),g&&(0,t.jsxs)("td",{className:"p-3 whitespace-nowrap",children:[(0,t.jsx)("button",{onClick:()=>N(e),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-lg mr-2 text-sm transition-all",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>a("products",e.id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-lg text-sm transition-all",children:"Delete"})]})]},e.id)}):(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:g?7:6,className:"p-6 text-center text-gray-500",children:'No solar products added yet. Click "Add Product" to get started.'})})})]})}),(0,t.jsx)("div",{className:"md:hidden space-y-3",children:e.products?.length>0?e.products.map(e=>(0,t.jsx)("div",{className:"bg-white border border-gray-200 p-4 rounded-xl shadow-lg",children:(0,t.jsxs)("div",{className:"space-y-2",children:[e.image&&(0,t.jsx)("img",{src:w(e.image),alt:e.name,className:"h-32 w-full object-cover rounded"}),(0,t.jsx)("div",{children:(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:e.name})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Category: "}),(0,t.jsx)("span",{className:"text-gray-800",children:e.category})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Price: "}),(0,t.jsxs)("span",{className:"text-green-600 font-bold",children:["â‚¹",e.price]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"GST: "}),(0,t.jsxs)("span",{className:"text-gray-800",children:[e.gstPercent,"%"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Partner: "}),(0,t.jsxs)("span",{className:"text-gray-800",children:[e.partnerCommissionPercent,"%"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Tech: "}),(0,t.jsxs)("span",{className:"text-gray-800",children:[e.technicianCommissionPercent,"%"]})]})]}),g&&(0,t.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,t.jsx)("button",{onClick:()=>N(e),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg flex-1 text-sm transition-all",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>a("products",e.id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-lg flex-1 text-sm transition-all",children:"Delete"})]})]})},e.id)):(0,t.jsx)("div",{className:"bg-white border border-gray-200 p-6 rounded-xl text-center text-gray-500",children:'No solar products added yet. Click "Add Product" to get started.'})})]})},S=()=>{let{data:e,addItem:r,updateItem:l,deleteItem:a,currentUser:n}=b(),[i,d]=(0,s.useState)(!1),[o,c]=(0,s.useState)(null),[x,m]=(0,s.useState)({name:"",category:"",price:"",description:"",duration:"",includes:""}),u=["admin","manager"].includes(n?.role),h=e.categories.filter(e=>"service"===e.type),g=()=>{m({name:"",category:"",price:"",description:"",duration:"",includes:""}),d(!1),c(null)},p=e=>{m({name:e.name||"",category:e.category||"",price:e.price?.toString()||"",description:e.description||"",duration:e.duration||"",includes:e.includes||""}),c(e),d(!0)};return(0,t.jsxs)("div",{className:"p-2",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-2 relative z-10",children:[(0,t.jsx)("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Services"}),u&&(0,t.jsx)("button",{onClick:()=>d(!0),className:"btn-primary px-4 py-2 rounded w-full sm:w-auto text-sm whitespace-nowrap",children:"Add Service"})]}),i&&u&&(0,t.jsxs)("div",{className:"glass-form p-3 sm:p-4 rounded-lg mb-4 relative z-10",children:[(0,t.jsx)("h3",{className:"text-base font-semibold text-green-400 mb-3",children:o?"Edit Service":"Add Service"}),(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t={name:x.name,category:x.category,price:parseFloat(x.price),description:x.description,duration:x.duration,includes:x.includes};o?l("services",o.id,t):r("services",t),g()},className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,t.jsx)("input",{type:"text",placeholder:"Service Name",value:x.name,onChange:e=>m({...x,name:e.target.value}),className:"p-2 bg-gray-700 text-green-100 rounded border border-green-600 text-sm",required:!0}),(0,t.jsxs)("select",{value:x.category,onChange:e=>m({...x,category:e.target.value}),className:"p-2 bg-gray-700 text-green-100 rounded border border-green-600 text-sm",required:!0,children:[(0,t.jsx)("option",{value:"",className:"bg-gray-700 text-green-100",children:"Select Category"}),h.map(e=>(0,t.jsx)("option",{value:e.name,className:"bg-gray-700 text-green-100",children:e.name},e.id))]}),(0,t.jsx)("input",{type:"number",step:"0.01",placeholder:"Price",value:x.price,onChange:e=>m({...x,price:e.target.value}),className:"p-2 bg-gray-700 text-green-100 rounded border border-green-600 text-sm",required:!0}),(0,t.jsx)("input",{type:"text",placeholder:"Duration (e.g., 2-3 hours)",value:x.duration,onChange:e=>m({...x,duration:e.target.value}),className:"p-2 bg-gray-700 text-green-100 rounded border border-green-600 text-sm"}),(0,t.jsx)("textarea",{placeholder:"Description",value:x.description,onChange:e=>m({...x,description:e.target.value}),className:"p-2 bg-gray-700 text-green-100 rounded border border-green-600 text-sm",rows:2}),(0,t.jsx)("textarea",{placeholder:"What's included",value:x.includes,onChange:e=>m({...x,includes:e.target.value}),className:"p-2 bg-gray-700 text-green-100 rounded border border-green-600 text-sm",rows:2}),(0,t.jsxs)("div",{className:"sm:col-span-2 flex flex-col sm:flex-row gap-2",children:[(0,t.jsx)("button",{type:"submit",className:"btn-primary px-3 py-1.5 rounded text-sm",children:o?"Update Service":"Add Service"}),(0,t.jsx)("button",{type:"button",onClick:g,className:"btn-secondary px-3 py-1.5 rounded text-sm",children:"Cancel"})]})]})]}),(0,t.jsx)("div",{className:"hidden md:block bg-white border border-gray-200 rounded-lg",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-2 text-left text-gray-900 text-sm",children:"Name"}),(0,t.jsx)("th",{className:"p-2 text-left text-gray-900 text-sm",children:"Category"}),(0,t.jsx)("th",{className:"p-2 text-left text-gray-900 text-sm",children:"Price"}),(0,t.jsx)("th",{className:"p-2 text-left text-gray-900 text-sm",children:"Duration"}),(0,t.jsx)("th",{className:"p-2 text-left text-gray-900 text-sm",children:"Description"}),u&&(0,t.jsx)("th",{className:"p-2 text-left text-gray-900 text-sm",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:e.services?.map(e=>(0,t.jsxs)("tr",{className:"border-t border-gray-200",children:[(0,t.jsx)("td",{className:"p-2 text-gray-900 text-sm",children:e.name}),(0,t.jsx)("td",{className:"p-2 text-gray-700 text-sm",children:e.category}),(0,t.jsxs)("td",{className:"p-2 text-green-600 text-sm",children:["â‚¹",e.price]}),(0,t.jsx)("td",{className:"p-2 text-gray-700 text-sm",children:e.duration}),(0,t.jsx)("td",{className:"p-2 text-gray-700 text-sm",children:e.description}),u&&(0,t.jsxs)("td",{className:"p-2",children:[(0,t.jsx)("button",{onClick:()=>p(e),className:"btn-info px-2 py-1 rounded mr-1 text-xs",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>a("services",e.id),className:"btn-danger px-2 py-1 rounded text-xs",children:"Delete"})]})]},e.id))})]})}),(0,t.jsx)("div",{className:"md:hidden space-y-2",children:e.services?.map(e=>(0,t.jsx)("div",{className:"bg-white border border-gray-200 p-3 rounded-lg",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Name: "}),(0,t.jsx)("span",{className:"text-gray-900",children:e.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Category: "}),(0,t.jsx)("span",{className:"text-gray-800",children:e.category})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Price: "}),(0,t.jsxs)("span",{className:"text-green-600",children:["â‚¹",e.price]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Duration: "}),(0,t.jsx)("span",{className:"text-gray-800",children:e.duration})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Description: "}),(0,t.jsx)("span",{className:"text-gray-800",children:e.description})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Includes: "}),(0,t.jsx)("span",{className:"text-gray-800",children:e.includes})]}),u&&(0,t.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,t.jsx)("button",{onClick:()=>p(e),className:"btn-info px-2 py-1 rounded flex-1 text-xs",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>a("services",e.id),className:"btn-danger px-2 py-1 rounded flex-1 text-xs",children:"Delete"})]})]})},e.id))})]})},P=()=>{let{data:e,updateItem:r,deleteItem:l,currentUser:a}=b(),[n,i]=(0,s.useState)("all"),d=["admin","manager"].includes(a?.role),o=e.quotes?.filter(e=>"all"===n||e.status===n)||[],c=(e,t)=>{r("orders",e,{status:t})},x=e=>{switch(e){case"completed":return"bg-green-100 text-green-800";case"in-progress":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return(0,t.jsxs)("div",{className:"p-2",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-2",children:[(0,t.jsxs)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 flex items-center",children:[(0,t.jsx)("span",{className:"mr-2",children:"ðŸ“‹"})," Customer Quotes"]}),(0,t.jsxs)("select",{value:n,onChange:e=>i(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900",children:[(0,t.jsx)("option",{value:"all",children:"All Quotes"}),(0,t.jsx)("option",{value:"pending",children:"Pending"}),(0,t.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,t.jsx)("option",{value:"completed",children:"Completed"}),(0,t.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]}),(0,t.jsx)("div",{className:"hidden md:block bg-white border border-gray-200 rounded-xl overflow-hidden shadow-lg",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Quote ID"}),(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Customer"}),(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Email"}),(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Phone"}),(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Address"}),(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Items"}),(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Subtotal"}),(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Tax"}),(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Total"}),(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Date"}),d&&(0,t.jsx)("th",{className:"p-3 text-left text-gray-900 font-semibold",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:o.length>0?o.map(e=>(0,t.jsxs)("tr",{className:"border-t border-gray-200 hover:bg-gray-50 transition-all",children:[(0,t.jsxs)("td",{className:"p-3 text-gray-900 font-medium",children:["#",e.id]}),(0,t.jsx)("td",{className:"p-3 text-gray-700",children:e.name}),(0,t.jsx)("td",{className:"p-3 text-gray-700",children:e.email}),(0,t.jsx)("td",{className:"p-3 text-gray-700",children:e.phone}),(0,t.jsx)("td",{className:"p-3 text-gray-700 max-w-xs truncate",title:e.address,children:e.address}),(0,t.jsx)("td",{className:"p-3 text-gray-700",children:(0,t.jsx)("div",{className:"max-w-xs",children:e.items?.map((e,s)=>(0,t.jsxs)("div",{className:"text-sm",children:[e.name," - â‚¹",e.price," x ",e.quantity]},s))})}),(0,t.jsxs)("td",{className:"p-3 text-gray-700",children:["â‚¹",e.subtotal]}),(0,t.jsxs)("td",{className:"p-3 text-gray-700",children:["â‚¹",e.tax]}),(0,t.jsxs)("td",{className:"p-3 text-green-600 font-semibold",children:["â‚¹",e.totalAmount]}),(0,t.jsx)("td",{className:"p-3 text-gray-700",children:new Date(e.created_at||Date.now()).toLocaleDateString()}),(0,t.jsx)("td",{className:"p-3",children:(0,t.jsx)("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${x(e.status)}`,children:e.status})}),(0,t.jsx)("td",{className:"p-3 text-gray-700",children:e.createdAt}),d&&(0,t.jsxs)("td",{className:"p-3 whitespace-nowrap",children:[(0,t.jsxs)("select",{value:e.status,onChange:t=>c(e.id,t.target.value),className:"text-sm border border-gray-300 rounded px-2 py-1 mr-2",children:[(0,t.jsx)("option",{value:"pending",children:"Pending"}),(0,t.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,t.jsx)("option",{value:"completed",children:"Completed"}),(0,t.jsx)("option",{value:"cancelled",children:"Cancelled"})]}),(0,t.jsx)("button",{onClick:()=>l("quotes",e.id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-lg text-sm transition-all",children:"Delete"})]})]},e.id)):(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:d?11:10,className:"p-6 text-center text-gray-500",children:"No quotes found for the selected filter."})})})]})}),(0,t.jsx)("div",{className:"md:hidden space-y-3",children:o.length>0?o.map(e=>(0,t.jsx)("div",{className:"bg-white border border-gray-200 p-4 rounded-xl shadow-lg",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("span",{className:"text-gray-700 font-semibold",children:["Order #",e.id]}),(0,t.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${x(e.status)}`,children:e.status})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Customer: "}),(0,t.jsx)("span",{className:"text-gray-900",children:e.customerName})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Item: "}),(0,t.jsx)("span",{className:"text-gray-900",children:e.itemName})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Type: "}),(0,t.jsx)("span",{className:"text-gray-800 capitalize",children:e.type})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Qty: "}),(0,t.jsx)("span",{className:"text-gray-800",children:e.quantity||1})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Total: "}),(0,t.jsxs)("span",{className:"text-green-600 font-bold",children:["â‚¹",e.totalPrice||e.itemPrice]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-700 font-semibold",children:"Date: "}),(0,t.jsx)("span",{className:"text-gray-800",children:e.createdAt})]}),d&&(0,t.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,t.jsxs)("select",{value:e.status,onChange:t=>c(e.id,t.target.value),className:"flex-1 text-sm border border-gray-300 rounded px-2 py-2",children:[(0,t.jsx)("option",{value:"pending",children:"Pending"}),(0,t.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,t.jsx)("option",{value:"completed",children:"Completed"}),(0,t.jsx)("option",{value:"cancelled",children:"Cancelled"})]}),(0,t.jsx)("button",{onClick:()=>l("quotes",e.id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-lg text-sm transition-all",children:"Delete"})]})]})},e.id)):(0,t.jsx)("div",{className:"bg-white border border-gray-200 p-6 rounded-xl text-center text-gray-500",children:"No quotes found for the selected filter."})})]})},A=()=>{let{data:e,addItem:r,updateItem:l,deleteItem:a,currentUser:n}=b(),[i,d]=(0,s.useState)(!1),[o,c]=(0,s.useState)(null),[x,m]=(0,s.useState)({title:"",description:"",priority:"medium",status:"open",assignedTo:"",customerId:""}),u=()=>{m({title:"",description:"",priority:"medium",status:"open",assignedTo:"",customerId:""}),d(!1),c(null)},h=e=>{m(e),c(e),d(!0)};return(0,t.jsxs)("div",{className:"p-2 sm:p-4",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 sm:mb-6 gap-3",children:[(0,t.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Support Tickets"}),(0,t.jsx)("button",{onClick:()=>d(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 sm:px-4 sm:py-2 rounded-lg text-sm sm:text-base",children:"Create Ticket"})]}),i&&(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200 mb-6",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:[o?"Edit":"Add"," Item"]}),(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t={...x,createdBy:n?.id,createdAt:new Date().toISOString()};o?l("tickets",o.id,t):r("tickets",t),u()},className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsx)("input",{type:"text",placeholder:"Ticket Title",value:x.title,onChange:e=>m({...x,title:e.target.value}),className:"p-3 border border-gray-300 rounded-lg",required:!0}),(0,t.jsxs)("select",{value:x.priority,onChange:e=>m({...x,priority:e.target.value}),className:"p-3 border border-gray-300 rounded-lg",children:[(0,t.jsx)("option",{value:"low",children:"Low"}),(0,t.jsx)("option",{value:"medium",children:"Medium"}),(0,t.jsx)("option",{value:"high",children:"High"}),(0,t.jsx)("option",{value:"urgent",children:"Urgent"})]}),(0,t.jsxs)("select",{value:x.customerId,onChange:e=>m({...x,customerId:e.target.value}),className:"p-3 border border-gray-300 rounded-lg",children:[(0,t.jsx)("option",{value:"",children:"Select Customer"}),e.customers?.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,t.jsxs)("select",{value:x.status,onChange:e=>m({...x,status:e.target.value}),className:"p-3 border border-gray-300 rounded-lg",children:[(0,t.jsx)("option",{value:"open",children:"Open"}),(0,t.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,t.jsx)("option",{value:"resolved",children:"Resolved"}),(0,t.jsx)("option",{value:"closed",children:"Closed"})]}),(0,t.jsx)("textarea",{placeholder:"Description",value:x.description,onChange:e=>m({...x,description:e.target.value}),className:"md:col-span-2 p-3 border border-gray-300 rounded-lg",rows:4,required:!0}),(0,t.jsxs)("div",{className:"md:col-span-2 flex gap-2",children:[(0,t.jsxs)("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg",children:[o?"Edit":"Add"," Item Ticket"]}),(0,t.jsx)("button",{type:"button",onClick:u,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg",children:"Cancel"})]})]})]}),(0,t.jsx)("div",{className:"block sm:hidden space-y-3",children:e.tickets?.map(s=>{let r=e.customers?.find(e=>e.id==s.customerId);return(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 text-sm",children:s.title}),(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("button",{onClick:()=>h(s),className:"bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>a("tickets",s.id),className:"bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs",children:"Delete"})]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:r?.name||"N/A"}),(0,t.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,t.jsx)("span",{className:`px-2 py-1 rounded text-xs ${"urgent"===s.priority?"bg-red-100 text-red-800":"high"===s.priority?"bg-orange-100 text-orange-800":"medium"===s.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:s.priority}),(0,t.jsx)("span",{className:`px-2 py-1 rounded text-xs ${"closed"===s.status?"bg-gray-100 text-gray-800":"resolved"===s.status?"bg-green-100 text-green-800":"in-progress"===s.status?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:new Date(s.createdAt).toLocaleDateString()})]},s.id)})}),(0,t.jsx)("div",{className:"hidden sm:block bg-white rounded-lg border border-gray-200 overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Title"}),(0,t.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Customer"}),(0,t.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Priority"}),(0,t.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Status"}),(0,t.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Created"}),(0,t.jsx)("th",{className:"p-3 text-left text-sm font-medium",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:e.tickets?.map(s=>{let r=e.customers?.find(e=>e.id==s.customerId);return(0,t.jsxs)("tr",{className:"border-t",children:[(0,t.jsx)("td",{className:"p-3 text-sm",children:s.title}),(0,t.jsx)("td",{className:"p-3 text-sm",children:r?.name||"N/A"}),(0,t.jsx)("td",{className:"p-3",children:(0,t.jsx)("span",{className:`px-2 py-1 rounded text-xs ${"urgent"===s.priority?"bg-red-100 text-red-800":"high"===s.priority?"bg-orange-100 text-orange-800":"medium"===s.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:s.priority})}),(0,t.jsx)("td",{className:"p-3",children:(0,t.jsx)("span",{className:`px-2 py-1 rounded text-xs ${"closed"===s.status?"bg-gray-100 text-gray-800":"resolved"===s.status?"bg-green-100 text-green-800":"in-progress"===s.status?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})}),(0,t.jsx)("td",{className:"p-3 text-sm",children:new Date(s.createdAt).toLocaleDateString()}),(0,t.jsxs)("td",{className:"p-3",children:[(0,t.jsx)("button",{onClick:()=>h(s),className:"bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded mr-2 text-sm",children:"Edit"}),(0,t.jsx)("button",{onClick:()=>a("tickets",s.id),className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm",children:"Delete"})]})]},s.id)})})]})})]})},q=()=>{let e,{data:r,currentUser:l,addItem:a}=b(),[n,i]=(0,s.useState)(!1),[d,o]=(0,s.useState)({userId:"",amount:"",reason:""}),c=["admin","manager"].includes(l?.role),x=(e={},r.tickets.filter(e=>"completed"===e.status).forEach(t=>{let s=("product"===t.type?r.products:r.services).find(e=>e.id==t.itemId);if(s){let l=r.customers.find(e=>e.id==t.customerId),a=l?r.users.find(e=>e.id==l.assignedTo&&"partner"===e.role):null,n=r.users.find(e=>e.id==t.assignedTo);if(a){e[a.id]||(e[a.id]={user:a,total:0,items:[]});let t=s.price*s.partnerCommissionPercent/100;e[a.id].total+=t,e[a.id].items.push({item:s.name,commission:t})}if(n){e[n.id]||(e[n.id]={user:n,total:0,items:[]});let t=s.price*s.technicianCommissionPercent/100;e[n.id].total+=t,e[n.id].items.push({item:s.name,commission:t})}}}),e),m=r.bonuses||[],u=(()=>{if(l?.role==="partner"){let e=r.customers.filter(e=>e.assignedTo==l.id),t=r.tickets.filter(t=>e.some(e=>e.id==t.customerId)),s=x[l.id]?.total||0,a=m.filter(e=>e.userId==l.id).reduce((e,t)=>e+t.amount,0);return{customers:e.length,tickets:t.length,commission:s,bonuses:a,totalEarnings:s+a}}if(l?.role==="technician"){let e=r.tickets.filter(e=>e.assignedTo==l.id),t=e.filter(e=>"completed"===e.status),s=x[l.id]?.total||0,a=m.filter(e=>e.userId==l.id).reduce((e,t)=>e+t.amount,0);return{assignedTickets:e.length,completedTickets:t.length,commission:s,bonuses:a,totalEarnings:s+a}}return null})();return l?.role==="partner"||l?.role==="technician"?(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-green-400 mb-6",children:"My Reports"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-6 mb-6",children:["partner"===l.role&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"bg-gray-800 p-4 lg:p-6 rounded-lg border border-green-600",children:[(0,t.jsx)("h3",{className:"text-green-400 text-sm lg:text-lg font-semibold",children:"My Customers"}),(0,t.jsx)("p",{className:"text-xl lg:text-3xl font-bold text-green-100 mt-1 lg:mt-2",children:u?.customers})]}),(0,t.jsxs)("div",{className:"bg-gray-800 p-4 lg:p-6 rounded-lg border border-green-600",children:[(0,t.jsx)("h3",{className:"text-green-400 text-sm lg:text-lg font-semibold",children:"Tickets Raised"}),(0,t.jsx)("p",{className:"text-xl lg:text-3xl font-bold text-green-100 mt-1 lg:mt-2",children:u?.tickets})]})]}),"technician"===l.role&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"bg-gray-800 p-4 lg:p-6 rounded-lg border border-green-600",children:[(0,t.jsx)("h3",{className:"text-green-400 text-sm lg:text-lg font-semibold",children:"Assigned Tickets"}),(0,t.jsx)("p",{className:"text-xl lg:text-3xl font-bold text-green-100 mt-1 lg:mt-2",children:u?.assignedTickets})]}),(0,t.jsxs)("div",{className:"bg-gray-800 p-4 lg:p-6 rounded-lg border border-green-600",children:[(0,t.jsx)("h3",{className:"text-green-400 text-sm lg:text-lg font-semibold",children:"Completed Tickets"}),(0,t.jsx)("p",{className:"text-xl lg:text-3xl font-bold text-green-100 mt-1 lg:mt-2",children:u?.completedTickets})]})]}),(0,t.jsxs)("div",{className:"bg-gray-800 p-4 lg:p-6 rounded-lg border border-green-600",children:[(0,t.jsx)("h3",{className:"text-green-400 text-sm lg:text-lg font-semibold",children:"Commission"}),(0,t.jsxs)("p",{className:"text-xl lg:text-3xl font-bold text-green-100 mt-1 lg:mt-2",children:["â‚¹",u?.commission.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"bg-gray-800 p-4 lg:p-6 rounded-lg border border-green-600",children:[(0,t.jsx)("h3",{className:"text-green-400 text-sm lg:text-lg font-semibold",children:"Bonuses"}),(0,t.jsxs)("p",{className:"text-xl lg:text-3xl font-bold text-green-100 mt-1 lg:mt-2",children:["â‚¹",u?.bonuses.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"bg-gray-800 p-4 lg:p-6 rounded-lg border border-green-600",children:[(0,t.jsx)("h3",{className:"text-green-400 text-sm lg:text-lg font-semibold",children:"Total Earnings"}),(0,t.jsxs)("p",{className:"text-xl lg:text-3xl font-bold text-green-100 mt-1 lg:mt-2",children:["â‚¹",u?.totalEarnings.toFixed(2)]})]})]})]}):(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 gap-4 relative z-10",children:[(0,t.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-green-400",children:"Reports & Analytics"}),c&&(0,t.jsx)("button",{onClick:()=>i(!0),className:"bg-green-600 hover:bg-green-700 px-4 py-2 rounded text-white w-full sm:w-auto whitespace-nowrap",children:"Add Bonus"})]}),n&&(0,t.jsxs)("div",{className:"bg-gray-800 p-4 sm:p-6 rounded-lg mb-6 border border-green-600 relative z-10",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-green-400 mb-4",children:"Add Bonus"}),(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a("bonuses",{...d,amount:parseFloat(d.amount),addedBy:l.id,addedAt:new Date().toISOString()}),o({userId:"",amount:"",reason:""}),i(!1)},className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,t.jsxs)("select",{value:d.userId,onChange:e=>o({...d,userId:e.target.value}),className:"p-3 bg-gray-700 text-green-100 rounded border border-green-600",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select User"}),r.users.filter(e=>["partner","technician"].includes(e.role)).map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," (",e.role,")"]},e.id))]}),(0,t.jsx)("input",{type:"number",step:"0.01",placeholder:"Bonus Amount",value:d.amount,onChange:e=>o({...d,amount:e.target.value}),className:"p-3 bg-gray-700 text-green-100 rounded border border-green-600",required:!0}),(0,t.jsx)("input",{type:"text",placeholder:"Reason",value:d.reason,onChange:e=>o({...d,reason:e.target.value}),className:"p-3 bg-gray-700 text-green-100 rounded border border-green-600",required:!0}),(0,t.jsxs)("div",{className:"sm:col-span-3 flex flex-col sm:flex-row gap-2",children:[(0,t.jsx)("button",{type:"submit",className:"bg-green-600 hover:bg-green-700 px-4 py-2 rounded text-white",children:"Add Bonus"}),(0,t.jsx)("button",{type:"button",onClick:()=>i(!1),className:"bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded text-white",children:"Cancel"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-6",children:[(0,t.jsxs)("div",{className:"bg-white p-4 lg:p-6 rounded-lg border border-gray-200 shadow-sm",children:[(0,t.jsx)("h3",{className:"text-gray-600 text-sm lg:text-lg font-semibold",children:"Total Customers"}),(0,t.jsx)("p",{className:"text-xl lg:text-3xl font-bold text-black mt-1 lg:mt-2",children:r.customers.length})]}),(0,t.jsxs)("div",{className:"bg-white p-4 lg:p-6 rounded-lg border border-gray-200 shadow-sm",children:[(0,t.jsx)("h3",{className:"text-gray-600 text-sm lg:text-lg font-semibold",children:"Total Tickets"}),(0,t.jsx)("p",{className:"text-xl lg:text-3xl font-bold text-black mt-1 lg:mt-2",children:r.tickets.length})]}),(0,t.jsxs)("div",{className:"bg-white p-4 lg:p-6 rounded-lg border border-gray-200 shadow-sm",children:[(0,t.jsx)("h3",{className:"text-gray-600 text-sm lg:text-lg font-semibold",children:"Completed Tickets"}),(0,t.jsx)("p",{className:"text-xl lg:text-3xl font-bold text-black mt-1 lg:mt-2",children:r.tickets.filter(e=>"completed"===e.status).length})]}),(0,t.jsxs)("div",{className:"bg-white p-4 lg:p-6 rounded-lg border border-gray-200 shadow-sm",children:[(0,t.jsx)("h3",{className:"text-gray-600 text-sm lg:text-lg font-semibold",children:"Total Commissions"}),(0,t.jsxs)("p",{className:"text-xl lg:text-3xl font-bold text-black mt-1 lg:mt-2",children:["â‚¹",Object.values(x).reduce((e,t)=>e+t.total,0).toFixed(2)]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 lg:gap-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:[(0,t.jsx)("h3",{className:"text-base lg:text-lg font-semibold text-black p-4 border-b border-gray-200",children:"Commission Summary"}),(0,t.jsx)("div",{className:"p-4",children:Object.values(x).map(({user:e,total:s})=>(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-200",children:[(0,t.jsxs)("span",{className:"text-black text-sm lg:text-base",children:[e.name," (",e.role,")"]}),(0,t.jsxs)("span",{className:"text-orange-500 font-semibold text-sm lg:text-base",children:["â‚¹",s.toFixed(2)]})]},e.id))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:[(0,t.jsx)("h3",{className:"text-base lg:text-lg font-semibold text-black p-4 border-b border-gray-200",children:"Recent Bonuses"}),(0,t.jsx)("div",{className:"p-4",children:m.slice(-10).map(e=>{let s=r.users.find(t=>t.id==e.userId);return(0,t.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-200",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-black text-sm lg:text-base",children:s?.name}),(0,t.jsx)("p",{className:"text-xs lg:text-sm text-gray-600",children:e.reason})]}),(0,t.jsxs)("span",{className:"text-orange-500 font-semibold text-sm lg:text-base",children:["â‚¹",e.amount]})]},e.id)})})]})]})]})},T=()=>{let{addItem:e}=b(),[r,l]=(0,s.useState)({name:"",email:"",phone:"",username:"",password:"",specialization:""});return(0,t.jsxs)("div",{className:"w-full p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,t.jsx)("button",{onClick:()=>window.history.back(),className:"btn-secondary px-3 py-2 rounded flex items-center gap-2",children:"â† Back"}),(0,t.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-green-400",children:"Add New Technician"})]}),(0,t.jsxs)("form",{onSubmit:t=>{t.preventDefault(),e("users",{...r,role:"technician"}),l({name:"",email:"",phone:"",username:"",password:"",specialization:""}),alert("Technician added successfully!")},className:"glass-form p-4 sm:p-6 rounded-lg space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Name"}),(0,t.jsx)("input",{type:"text",value:r.name,onChange:e=>l({...r,name:e.target.value}),className:"w-full px-3 py-2 bg-white/5 backdrop-blur-sm text-green-100 focus:bg-white/10 transition-all duration-200 rounded border-0 outline-none",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Email"}),(0,t.jsx)("input",{type:"email",value:r.email,onChange:e=>l({...r,email:e.target.value}),className:"w-full px-3 py-2 bg-white/5 backdrop-blur-sm text-green-100 focus:bg-white/10 transition-all duration-200 rounded border-0 outline-none",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Phone"}),(0,t.jsx)("input",{type:"tel",value:r.phone,onChange:e=>l({...r,phone:e.target.value}),className:"w-full px-3 py-2 bg-white/5 backdrop-blur-sm text-green-100 focus:bg-white/10 transition-all duration-200 rounded border-0 outline-none",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Username"}),(0,t.jsx)("input",{type:"text",value:r.username,onChange:e=>l({...r,username:e.target.value}),className:"w-full px-3 py-2 bg-white/5 backdrop-blur-sm text-green-100 focus:bg-white/10 transition-all duration-200 rounded border-0 outline-none",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Password"}),(0,t.jsx)("input",{type:"password",value:r.password,onChange:e=>l({...r,password:e.target.value}),className:"w-full px-3 py-2 bg-white/5 backdrop-blur-sm text-green-100 focus:bg-white/10 transition-all duration-200 rounded border-0 outline-none",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Specialization"}),(0,t.jsx)("input",{type:"text",value:r.specialization,onChange:e=>l({...r,specialization:e.target.value}),className:"w-full px-3 py-2 bg-white/5 backdrop-blur-sm text-green-100 focus:bg-white/10 transition-all duration-200 rounded border-0 outline-none",placeholder:"e.g., Electrical, Plumbing"})]})]}),(0,t.jsx)("button",{type:"submit",className:"w-full btn-primary font-bold py-2 sm:py-3 px-4 rounded",children:"Add Technician"})]})]})},I=()=>{let{addItem:e}=b(),[r,l]=(0,s.useState)({name:"",email:"",phone:"",username:"",password:"",company:"",territory:""});return(0,t.jsxs)("div",{className:"w-full p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,t.jsx)("button",{onClick:()=>window.history.back(),className:"btn-secondary px-3 py-2 rounded flex items-center gap-2",children:"â† Back"}),(0,t.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-green-400",children:"Add New Partner"})]}),(0,t.jsxs)("form",{onSubmit:t=>{t.preventDefault(),e("users",{...r,role:"partner"}),l({name:"",email:"",phone:"",username:"",password:"",company:"",territory:""}),alert("Partner added successfully!")},className:"glass-form p-4 sm:p-6 rounded-lg space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Name"}),(0,t.jsx)("input",{type:"text",value:r.name,onChange:e=>l({...r,name:e.target.value}),className:"glass-input w-full px-3 py-2 rounded placeholder-green-300/50",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Email"}),(0,t.jsx)("input",{type:"email",value:r.email,onChange:e=>l({...r,email:e.target.value}),className:"glass-input w-full px-3 py-2 rounded placeholder-green-300/50",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Phone"}),(0,t.jsx)("input",{type:"tel",value:r.phone,onChange:e=>l({...r,phone:e.target.value}),className:"glass-input w-full px-3 py-2 rounded placeholder-green-300/50",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Username"}),(0,t.jsx)("input",{type:"text",value:r.username,onChange:e=>l({...r,username:e.target.value}),className:"glass-input w-full px-3 py-2 rounded placeholder-green-300/50",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Password"}),(0,t.jsx)("input",{type:"password",value:r.password,onChange:e=>l({...r,password:e.target.value}),className:"glass-input w-full px-3 py-2 rounded placeholder-green-300/50",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Company"}),(0,t.jsx)("input",{type:"text",value:r.company,onChange:e=>l({...r,company:e.target.value}),className:"glass-input w-full px-3 py-2 rounded placeholder-green-300/50",placeholder:"Partner company name"})]}),(0,t.jsxs)("div",{className:"sm:col-span-2",children:[(0,t.jsx)("label",{className:"block text-green-300 text-sm font-medium mb-2",children:"Territory"}),(0,t.jsx)("input",{type:"text",value:r.territory,onChange:e=>l({...r,territory:e.target.value}),className:"glass-input w-full px-3 py-2 rounded placeholder-green-300/50",placeholder:"Assigned territory or region"})]})]}),(0,t.jsx)("button",{type:"submit",className:"w-full btn-primary font-bold py-2 sm:py-3 px-4 rounded",children:"Add Partner"})]})]})},$=()=>{let{currentUser:e,data:s,currentPage:r,setCurrentPage:l}=b();return(0,t.jsx)("div",{children:(()=>{switch(r){case"customers":return(0,t.jsx)(v,{});case"products":return(0,t.jsx)(C,{});case"services":return(0,t.jsx)(S,{});case"quotes":case"orders":return(0,t.jsx)(P,{});case"tickets":return(0,t.jsx)(A,{});case"reports":return(0,t.jsx)(q,{});case"add technician":return(0,t.jsx)(T,{});case"add partner":return(0,t.jsx)(I,{});default:return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 mb-2 flex items-center",children:[(0,t.jsx)("span",{className:"mr-2",children:"â˜€ï¸"})," Welcome back, ",e?.name,"!"]}),(0,t.jsxs)("p",{className:"text-gray-600",children:["Solar Energy Management - ",e?.role," dashboard"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsx)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-gray-600 text-sm font-medium",children:"Solar Customers"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:s.customers.length})]}),(0,t.jsx)("span",{className:"text-3xl text-orange-500",children:"ðŸ‘¥"})]})}),(0,t.jsx)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-gray-600 text-sm font-medium",children:"Solar Products"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:s.products.length})]}),(0,t.jsx)("span",{className:"text-3xl text-orange-500",children:"ðŸ”‹"})]})}),(0,t.jsx)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-gray-600 text-sm font-medium",children:"Services"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:s.services.length})]}),(0,t.jsx)("span",{className:"text-3xl text-orange-500",children:"âš¡"})]})}),(0,t.jsx)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-all",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-gray-600 text-sm font-medium",children:"Quotes"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:(s.quotes||[]).length})]}),(0,t.jsx)("span",{className:"text-3xl text-orange-500",children:"ðŸ“‹"})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[(0,t.jsxs)("h3",{className:"text-gray-900 text-lg font-semibold mb-4 flex items-center",children:[(0,t.jsx)("span",{className:"mr-2",children:"ðŸŽ«"})," Recent Support Tickets"]}),(0,t.jsxs)("div",{className:"space-y-3",children:[Array.isArray(s.tickets)?s.tickets.slice(0,3).map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg border border-gray-100",children:[(0,t.jsxs)("span",{className:"text-gray-900 text-sm font-medium",children:["Ticket #",s+1]}),(0,t.jsx)("span",{className:"text-orange-600 text-xs font-semibold bg-orange-100 px-2 py-1 rounded",children:"Open"})]},s)):null,(!Array.isArray(s.tickets)||0===s.tickets.length)&&(0,t.jsx)("p",{className:"text-gray-500 text-sm",children:"No tickets yet"})]})]}),(0,t.jsxs)("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[(0,t.jsxs)("h3",{className:"text-gray-900 text-lg font-semibold mb-4 flex items-center",children:[(0,t.jsx)("span",{className:"mr-2",children:"âš¡"})," Quick Actions"]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(e?.role==="admin"||e?.role==="partner")&&(0,t.jsx)("button",{onClick:()=>l("customers"),className:"w-full bg-gradient-to-r from-green-600 to-green-500 hover:from-green-700 hover:to-green-600 text-white p-2 rounded-lg transition-all text-sm font-semibold shadow-md hover:shadow-lg",children:"+ Add Solar Customer"}),e?.role==="admin"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>l("add partner"),className:"w-full bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 text-white p-2 rounded-lg transition-all text-sm font-semibold shadow-md hover:shadow-lg",children:"+ Add Partner"}),(0,t.jsx)("button",{onClick:()=>l("add technician"),className:"w-full bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 text-white p-2 rounded-lg transition-all text-sm font-semibold shadow-md hover:shadow-lg",children:"+ Add Technician"})]}),(0,t.jsx)("button",{onClick:()=>l("tickets"),className:"w-full bg-gradient-to-r from-yellow-600 to-yellow-500 hover:from-yellow-700 hover:to-yellow-600 text-white p-2 rounded-lg transition-all text-sm font-semibold shadow-md hover:shadow-lg",children:"+ Create Support Ticket"}),(0,t.jsx)("button",{onClick:()=>l("reports"),className:"w-full bg-gradient-to-r from-purple-600 to-purple-500 hover:from-purple-700 hover:to-purple-600 text-white p-2 rounded-lg transition-all text-sm font-semibold shadow-md hover:shadow-lg",children:"ðŸ“Š View Reports"})]})]})]})]})}})()})},E=new Map;function D(e){let t=E.get(e);return t&&t.expiry>Date.now()?t.data:(t&&E.delete(e),null)}function L(e,t,s){E.set(e,{data:t,expiry:Date.now()+("number"==typeof s?s:3e5)})}function M(e,t){try{return`${e}:${JSON.stringify(t)}`}catch{return`${e}:${String(t)}`}}function O(){try{let e=localStorage.getItem("loginTimestamp");if(e&&Date.now()-parseInt(e,10)>864e5){try{localStorage.removeItem("isLoggedIn"),localStorage.removeItem("user"),localStorage.removeItem("session"),localStorage.removeItem("loginTimestamp")}catch{}return!1}}catch{}return!0}function B(){try{if(!O())return null;let e=localStorage.getItem("user");if(!e)return null;return JSON.parse(e)}catch{return null}}class R{resource;constructor(e){this.resource=e}async findLast(e={}){let{sort:t="-created_at",search:s="",fields:r="*",filter:l="",useCache:a=!1,useSession:n=!1,cacheTtlMs:i=3e5}=e,o={page:"1,1",sort:t,search:s,fields:r,filter:l,...this.getSessionParam(n)},c=M(`${this.resource}:last`,{sort:t,search:s,fields:r,filter:l,useSession:n});if(a){let e=D(c);if(e)return e}let x=await d(`/${this.resource}`,o),m=Array.isArray(x?.result)?x.result[0]:x?.result,u={...x,result:m};return a&&!x?.err&&L(c,u,i),u}getSessionParam(e){let t=function(){try{if(!O())return null;return localStorage.getItem("session")}catch{return null}}();return e&&t?{session:t}:{}}ensureValidIds(e,t){if(!Array.isArray(e)||0===e.length)throw Error(`${t}: ids[] must not be empty`)}async findAll(e={}){return this.findMany(e)}async findMany(e={}){let{page:t="",sort:s="created_at",limit:r="",joins:l="",search:a="",fields:n="*",filter:i="",nearby:o="",useCache:c=!1,useSession:x=!1,cacheTtlMs:m=3e5}=e,u={page:`${t},${r}`,sort:s,search:a,fields:n,filter:i,...l?{joins:l}:{},...o?{nearby:o}:{},...this.getSessionParam(x)},h=M(`${this.resource}:list`,{page:t,limit:r,sort:s,fields:n,filter:i,useSession:x});if(c){let e=D(h);if(e)return e}let g=await d(`/${this.resource}`,u);return c&&!g?.err&&L(h,g,m),g}async findOne(e,t={}){let{fields:s="*",useSession:r=!1,useCache:l=!1,cacheTtlMs:a=3e5,joins:n=""}=t,i={fields:s,...n?{joins:n}:{},...this.getSessionParam(r)},o=M(`${this.resource}:byId`,{id:e,fields:s,useSession:r});if(l){let e=D(o);if(e)return e}let c=await d(`/${this.resource}/${e}`,i);return Array.isArray(c?.result)&&(c.result=c.result[0]),l&&!c?.err&&L(o,c,a),c}async findManyIds(e,t={}){let{fields:s="*",useSession:r=!1,useCache:l=!1,cacheTtlMs:a=3e5,joins:n=""}=t,i={fields:s,...n?{joins:n}:{},...this.getSessionParam(r)},o=M(`${this.resource}:byIds`,{ids:e,fields:s,useSession:r});if(l){let e=D(o);if(e)return e}let c=await d(`/${this.resource}/${e.join(",")}`,i);return c.result=c?.result||[],l&&!c?.err&&L(o,c,a),c}async createOne(e,t={}){let{useSession:s=!1,fields:r="*"}=t,l={...e};if(s){let e=B(),t=e?.client?.id??e?.client;t&&null==l.client&&(l.client=t)}return await c(`/${this.resource}`,{body:l,...this.getSessionParam(s),fields:r})}async createMany(e,t={}){let{useSession:s=!1,fields:r="*"}=t,l=e.map(e=>({...e}));if(s){let e=B(),t=e?.client?.id??e?.client;t&&(l=l.map(e=>null==e.client?{...e,client:t}:e))}return await c(`/${this.resource}`,{body:l,...this.getSessionParam(s),fields:r})}async updateOne(e,t,s={}){let{useSession:r=!1,fields:l="*"}=s;return await o(`/${this.resource}/${e}`,{body:t,...this.getSessionParam(r),fields:l})}async updateMany(e,t={}){let{useSession:s=!1,fields:r="*"}=t,l=e.map(({id:e,data:t})=>({id:e,...t}));return await o(`/${this.resource}`,{body:l,...this.getSessionParam(s),fields:r})}async deleteOne(e,t={}){let{useSession:s=!1}=t;return await x(`/${this.resource}/${e}`,this.getSessionParam(s))}async deleteMany(e,t={}){this.ensureValidIds(e,"deleteMany");let{useSession:s=!1}=t;return await x(`/${this.resource}/${e.join(",")}`,this.getSessionParam(s))}async softDeleteOne(e,t={}){return this.updateOne(e,{is_deleted:1},t)}async softDeleteMany(e,t={}){this.ensureValidIds(e,"softDeleteMany");let s=e.map(e=>({id:e,data:{is_deleted:1}}));return this.updateMany(s,t)}async restoreOne(e,t={}){return this.updateOne(e,{is_deleted:0},t)}async restoreMany(e,t={}){this.ensureValidIds(e,"restoreMany");let s=e.map(e=>({id:e,data:{is_deleted:0}}));return this.updateMany(s,t)}async rawSql(e,t,s=[],r={}){let{useSession:l=!1,useCache:a=!1,cacheTtlMs:n=3e5}=r,i=e?e.trim().replace(/\s+/g,"-").toLowerCase():"rawSql",d=M(i,{sql:t,params:JSON.stringify(s),useSession:l});if(a){let e=D(d);if(e)return e}let o=await m(`/${i}`,{body:{sql:t,params:s},...this.getSessionParam(l)});return a&&!o?.err&&L(d,o,n),o}}function F(e){return new R(e)}let Q={users:F("users"),orders:F("orders"),tickets:F("tickets"),products:F("products"),services:F("services"),customers:F("customers"),quotes:F("quotes")},U=()=>{let{currentUser:e,data:r,addItem:l,login:a}=b();console.log("CustomerPortal data:",r),console.log("Products:",r.products),console.log("Services:",r.services);let[n,i]=(0,s.useState)("home"),[d]=(0,s.useState)(!1),[o]=(0,s.useState)({type:"product",itemId:"",quantity:1,description:"",preferredDate:""}),[c,x]=(0,s.useState)({name:"",phone:"",email:"",address:"",propertyType:"residential",roofArea:"",monthlyBill:"",requirements:""}),[m,u]=(0,s.useState)({type:"product",itemId:"",issue:"",notes:""}),[h,g]=(0,s.useState)([]),[p,j]=(0,s.useState)(!1);(0,s.useEffect)(()=>{e||"my-orders"!==n&&"my-tickets"!==n||i("home")},[e,n]);let y=e&&r.orders?.filter(t=>t.customerId===e.id)||[],f=e&&r.tickets?.filter(t=>t.customerId===e.id)||[];(0,s.useEffect)(()=>{e&&"my-quotes"===n&&N()},[e,n]);let N=async()=>{if(!e)return},v=[{id:"home",label:"Home",icon:"ðŸ "},{id:"products",label:"Products",icon:"ðŸ›’"},{id:"services",label:"Services",icon:"ðŸ”§"},{id:"raise-ticket",label:"Support",icon:"ðŸŽ«"},...e?[{id:"my-orders",label:"My Orders",icon:"ðŸ“¦"},{id:"my-tickets",label:"My Tickets",icon:"ðŸŽŸï¸"}]:[]];return(0,t.jsxs)("div",{className:"min-h-screen bg-slate-900 text-slate-100",children:[(0,t.jsx)("nav",{className:"sticky top-0 z-40 border-b border-gray-700/60 bg-slate-900/80 backdrop-blur",children:(0,t.jsxs)("div",{className:"mx-auto flex max-w-7xl items-center justify-between gap-4 px-4 py-4",children:[(0,t.jsxs)("a",{href:"#",className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"h-11 w-11 rounded-xl bg-blue-600 flex items-center justify-center ring-1 ring-white/10",children:(0,t.jsx)("span",{className:"text-white font-bold text-lg",children:"MJ"})}),(0,t.jsxs)("div",{className:"leading-tight hidden sm:block",children:[(0,t.jsx)("div",{className:"font-semibold tracking-wide",children:"MJ Power"}),(0,t.jsx)("div",{className:"text-xs text-slate-400",children:"Products â€¢ Services â€¢ Support"})]})]}),(0,t.jsxs)("div",{className:"hidden lg:flex w-full max-w-xl items-center gap-2",children:[(0,t.jsxs)("div",{className:"relative w-full",children:[(0,t.jsx)("input",{type:"search",placeholder:"Search products (Inverters, Batteries, Panels...)",className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 pr-10 text-sm text-slate-100 placeholder:text-slate-400 outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20"}),(0,t.jsx)("span",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-slate-400",children:"âŒ•"})]}),(0,t.jsx)("a",{onClick:()=>i("get-quote"),className:"rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110 cursor-pointer whitespace-nowrap",children:"Get Quote"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[v.map(s=>(0,t.jsx)("button",{onClick:()=>{e||"my-orders"!==s.id&&"my-tickets"!==s.id?i(s.id):j(!0)},className:"hidden lg:inline rounded-xl px-3 py-2 text-sm text-slate-200 hover:bg-white/5",children:s.label},s.id)),(0,t.jsxs)("button",{onClick:()=>i("cart"),className:"rounded-2xl border border-white/10 bg-white/5 px-3 py-2 text-sm hover:bg-white/10",type:"button",children:["ðŸ›’ ",(0,t.jsxs)("span",{className:"ml-1 text-slate-300",children:["(",h.length,")"]})]})]})]})}),(0,t.jsx)("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-slate-900/95 backdrop-blur border-t border-gray-700/60 lg:hidden",children:(0,t.jsxs)("div",{className:"grid grid-cols-5 gap-1 px-2 py-2",children:[v.slice(0,4).map(s=>(0,t.jsxs)("button",{onClick:()=>{e||"my-orders"!==s.id&&"my-tickets"!==s.id?i(s.id):j(!0)},className:`flex flex-col items-center py-2 px-1 rounded-lg text-xs transition-colors ${n===s.id?"text-green-500 bg-white/10":"text-slate-400"}`,children:[(0,t.jsx)("span",{className:"text-lg mb-1",children:s.icon}),(0,t.jsx)("span",{className:"truncate",children:s.label})]},s.id)),(0,t.jsxs)("button",{onClick:()=>i("get-quote"),className:`flex flex-col items-center py-2 px-1 rounded-lg text-xs transition-colors ${"get-quote"===n?"text-green-500 bg-white/10":"text-slate-400"}`,children:[(0,t.jsx)("span",{className:"text-lg mb-1",children:"ðŸ’°"}),(0,t.jsx)("span",{className:"truncate",children:"Quote"})]})]})}),(0,t.jsx)("div",{className:"pb-20 lg:pb-0",children:(0,t.jsxs)("main",{className:"mx-auto max-w-7xl px-4 py-6 lg:py-10",children:["home"===n&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"relative overflow-hidden mb-8",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-green-500/15 via-transparent to-white/5"}),(0,t.jsxs)("div",{className:"mx-auto grid max-w-7xl items-center gap-10 px-4 py-12 md:grid-cols-2 md:py-16",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-1.5 text-xs text-slate-200",children:[(0,t.jsx)("span",{className:"h-2 w-2 rounded-full bg-green-500"}),"Power solutions for homes, businesses & industry"]}),(0,t.jsxs)("h1",{className:"mt-5 text-4xl font-semibold leading-tight tracking-tight md:text-5xl",children:["Reliable ",(0,t.jsx)("span",{className:"text-green-500",children:"Electrical"})," Products",(0,t.jsx)("br",{className:"hidden sm:block"}),"+ Expert Services"]}),(0,t.jsx)("p",{className:"mt-4 max-w-xl text-slate-300",children:"Buy authentic power products (inverters, batteries, solar, wiring) and book installation, maintenance, AMC, and audits â€” all in one place."}),(0,t.jsxs)("div",{className:"mt-6 flex flex-wrap gap-3",children:[(0,t.jsx)("button",{onClick:()=>i("products"),className:"rounded-2xl bg-green-500 px-5 py-3 text-sm font-semibold text-black hover:brightness-110",children:"Shop Products"}),(0,t.jsx)("button",{onClick:()=>i("services"),className:"rounded-2xl border border-white/10 bg-white/5 px-5 py-3 text-sm font-semibold text-slate-100 hover:bg-white/10",children:"Explore Services"}),(0,t.jsx)("button",{onClick:()=>i("get-quote"),className:"rounded-2xl border border-green-500/40 bg-black/20 px-5 py-3 text-sm font-semibold text-green-500 hover:border-green-500/70",children:"Request a Quote"})]}),(0,t.jsxs)("div",{className:"mt-8 grid grid-cols-2 gap-3 sm:grid-cols-3",children:[(0,t.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[(0,t.jsx)("div",{className:"text-sm font-semibold",children:"Warranty-backed"}),(0,t.jsx)("div",{className:"mt-1 text-xs text-slate-400",children:"Genuine products only"})]}),(0,t.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[(0,t.jsx)("div",{className:"text-sm font-semibold",children:"Fast Support"}),(0,t.jsx)("div",{className:"mt-1 text-xs text-slate-400",children:"Phone + onsite"})]}),(0,t.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-white/5 p-4",children:[(0,t.jsx)("div",{className:"text-sm font-semibold",children:"Professional Install"}),(0,t.jsx)("div",{className:"mt-1 text-xs text-slate-400",children:"Certified team"})]})]})]}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)("div",{className:"rounded-3xl border border-white/10 bg-gradient-to-b from-white/10 to-white/5 p-6 shadow-2xl shadow-black/40",children:(()=>{let e=r.products&&r.products.length>0?r.products.reduce((e,t)=>(t.originalPrice?(t.originalPrice-t.price)/t.originalPrice*100:0)>(e?.originalPrice?(e.originalPrice-e.price)/e.originalPrice*100:0)?t:e,null):null;if(e&&e.originalPrice||(e=r.products&&r.products.length>0?r.products[0]:null),!e)return null;let s=e.originalPrice?Math.round((e.originalPrice-e.price)/e.originalPrice*100):15;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-slate-100",children:"Today's Deal"}),(0,t.jsx)("div",{className:"mt-1 text-xs text-slate-400",children:"Limited stock â€¢ Best price"})]}),(0,t.jsxs)("span",{className:"rounded-full bg-green-500/20 px-3 py-1 text-xs font-semibold text-green-500",children:["-",s,"%"]})]}),(0,t.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,t.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/20 p-4",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-semibold",children:e.name}),(0,t.jsxs)("div",{className:"mt-1 text-xs text-slate-400",children:[e.category," â€¢ ",e.description]}),(0,t.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"text-lg font-semibold text-green-500",children:["â‚¹",e.price?.toLocaleString()]}),e.originalPrice&&(0,t.jsxs)("span",{className:"text-sm text-slate-500 line-through",children:["â‚¹",e.originalPrice?.toLocaleString()]})]})]}),(0,t.jsx)("div",{className:"h-14 w-14 rounded-2xl bg-green-500/15 ring-1 ring-green-500/20 grid place-items-center",children:"âš¡"})]}),(0,t.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>{h.find(t=>t.id===e.id)||g([...h,{...e,quantity:1}])},className:"w-full rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110",type:"button",children:"Add to Cart"}),(0,t.jsx)("button",{className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-center text-sm font-semibold hover:bg-white/10",children:"Install +"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/20 p-4",children:[(0,t.jsx)("div",{className:"text-xs text-slate-400",children:"Avg dispatch"}),(0,t.jsx)("div",{className:"mt-1 text-lg font-semibold",children:"24â€“48 hrs"})]}),(0,t.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/20 p-4",children:[(0,t.jsx)("div",{className:"text-xs text-slate-400",children:"Service coverage"}),(0,t.jsx)("div",{className:"mt-1 text-lg font-semibold",children:"Onsite"})]})]})]})]})})()})})]})]}),(0,t.jsxs)("div",{className:"mb-10",children:[(0,t.jsxs)("div",{className:"flex items-end justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold",children:"Shop by Category"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Quickly find what you need."})]}),(0,t.jsx)("button",{onClick:()=>i("products"),className:"text-sm font-semibold text-green-500 hover:underline",children:"View all â†’"})]}),(0,t.jsx)("div",{className:"mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[{name:"Solar Panels",icon:"â˜€ï¸",color:"bg-yellow-400"},{name:"Inverters",icon:"âš¡",color:"bg-yellow-400"},{name:"Batteries",icon:"ðŸ”‹",color:"bg-yellow-400"},{name:"Installation",icon:"ðŸ”§",color:"bg-yellow-400"}].map(e=>(0,t.jsxs)("button",{onClick:()=>i("products"),className:"group rounded-3xl border border-white/10 bg-white/5 p-5 hover:bg-white/10 text-left",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"text-sm font-semibold",children:e.name}),(0,t.jsx)("div",{className:"rounded-2xl bg-green-500/15 px-3 py-2 text-green-500 ring-1 ring-green-500/20",children:e.icon})]}),(0,t.jsxs)("p",{className:"mt-3 text-sm text-slate-400",children:["Professional ",e.name.toLowerCase()," solutions"]}),(0,t.jsx)("p",{className:"mt-4 text-xs text-slate-500 group-hover:text-slate-300",children:"Explore â†’"})]},e.name))})]}),(0,t.jsxs)("div",{className:"mb-10",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold",children:"Featured Products"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Add to cart or request installation."})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"All"}),(0,t.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"Inverters"}),(0,t.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"Batteries"}),(0,t.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"Solar"})]})]}),(0,t.jsx)("div",{className:"mt-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:r.products?.slice(0,3).map(e=>(0,t.jsxs)("article",{className:"rounded-3xl border border-white/10 bg-white/5 p-5 hover:bg-white/10",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-base font-semibold",children:e.name}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:e.category}),(0,t.jsx)("div",{className:"mt-3 flex items-center gap-2",children:(0,t.jsxs)("span",{className:"text-lg font-semibold text-green-500",children:["â‚¹",e.price?.toLocaleString()]})}),(0,t.jsx)("p",{className:"mt-2 text-xs text-slate-500",children:"â­ 4.5 â€¢ Reviews"})]}),(0,t.jsx)("div",{className:"grid h-14 w-14 place-items-center rounded-2xl bg-green-500/15 ring-1 ring-green-500/20",children:"âš¡"})]}),(0,t.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>{h.find(t=>t.id===e.id)||g([...h,{...e,quantity:1}])},className:"w-full rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110",type:"button",children:"Add to Cart"}),(0,t.jsx)("button",{className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-center text-sm font-semibold hover:bg-white/10",children:"Install +"})]})]},e.id))})]}),(0,t.jsxs)("div",{className:"rounded-3xl p-8 lg:p-12 text-white",children:[(0,t.jsxs)("div",{className:"text-center mb-12",children:[(0,t.jsx)("h3",{className:"text-3xl font-bold mb-4 text-white",children:"Why Choose MJPOWER Solar?"}),(0,t.jsx)("p",{className:"text-lg text-gray-300",children:"Leading the way in sustainable energy solutions"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("span",{className:"text-2xl",children:"ðŸ†"})}),(0,t.jsx)("h4",{className:"text-lg font-semibold mb-2 text-white",children:"Expert Installation"}),(0,t.jsx)("p",{className:"text-gray-300",children:"Professional installation by certified technicians"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("span",{className:"text-2xl",children:"âš¡"})}),(0,t.jsx)("h4",{className:"text-lg font-semibold mb-2 text-white",children:"Premium Quality"}),(0,t.jsx)("p",{className:"text-gray-300",children:"High-efficiency solar panels and components"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("span",{className:"text-2xl",children:"ðŸ› ï¸"})}),(0,t.jsx)("h4",{className:"text-lg font-semibold mb-2 text-white",children:"24/7 Support"}),(0,t.jsx)("p",{className:"text-gray-300",children:"Round-the-clock maintenance and support"})]})]})]})]}),"services"===n&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-end justify-between gap-4 mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold",children:"Services"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Book onsite work, AMC, and audits."})]}),(0,t.jsx)("button",{className:"text-sm font-semibold text-green-500 hover:underline",children:"Request service â†’"})]}),(0,t.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:r.services?.map(e=>(0,t.jsxs)("article",{className:"rounded-3xl border border-white/10 bg-white/5 p-5 hover:bg-white/10",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold",children:e.name}),(0,t.jsx)("span",{className:"rounded-2xl bg-green-500/15 px-3 py-2 text-green-500 ring-1 ring-green-500/20",children:"ðŸ”§"})]}),(0,t.jsx)("p",{className:"mt-3 text-sm text-slate-400",children:e.description}),(0,t.jsx)("div",{className:"mt-3 flex items-center gap-2",children:(0,t.jsxs)("span",{className:"text-lg font-semibold text-green-500",children:["â‚¹",e.price?.toLocaleString()]})}),(0,t.jsx)("button",{onClick:()=>{h.find(t=>t.id===e.id)||g([...h,{...e,quantity:1}])},className:"mt-5 inline-flex w-full items-center justify-center rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110",children:"Book Service"})]},e.id))})]}),"products"===n&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold",children:"Featured Products"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Add to cart or request installation."})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"All"}),(0,t.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"Inverters"}),(0,t.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"Batteries"}),(0,t.jsx)("button",{className:"rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm hover:bg-white/10",type:"button",children:"Solar"})]})]}),(0,t.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:r.products?.map(e=>(0,t.jsxs)("article",{className:"rounded-3xl border border-white/10 bg-white/5 p-5 hover:bg-white/10",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-base font-semibold",children:e.name}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:e.description}),(0,t.jsx)("div",{className:"mt-3 flex items-center gap-2",children:(0,t.jsxs)("span",{className:"text-lg font-semibold text-green-500",children:["â‚¹",e.price?.toLocaleString()]})}),(0,t.jsx)("p",{className:"mt-2 text-xs text-slate-500",children:"â­ 4.5 â€¢ Reviews"})]}),(0,t.jsx)("div",{className:"grid h-14 w-14 place-items-center rounded-2xl bg-green-500/15 ring-1 ring-green-500/20",children:"âš¡"})]}),(0,t.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>{if(h.find(t=>t.id===e.id))i("cart");else{let t=o.quantity||1;g([...h,{...e,quantity:t}])}},className:"w-full rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110",children:h.find(t=>t.id===e.id)?"âœ“ In Cart":"Add to Cart"}),(0,t.jsx)("button",{className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-center text-sm font-semibold hover:bg-white/10",children:"Install +"})]})]},e.id))})]}),"get-quote"===n&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex items-end justify-between gap-4 mb-6",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold",children:"Get Solar Quote"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Get a personalized solar solution estimate"})]})}),(0,t.jsxs)("div",{className:"grid gap-4 lg:grid-cols-2",children:[(0,t.jsxs)("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-5",children:[(0,t.jsx)("h3",{className:"text-base font-semibold mb-4",children:"Request Quote"}),(0,t.jsxs)("form",{onSubmit:async t=>{t.preventDefault();let s={...c,customerId:e?.id,customerName:e?.name||c.name,status:"pending",estimatedCost:Math.round(12*(parseInt(c.monthlyBill)||0)*8),estimatedSavings:Math.round(12*(parseInt(c.monthlyBill)||0)*.8),type:h.length>0?"cart-quote":"form-quote",...h.length>0&&{items:h.map(e=>({id:e.id,name:e.name,price:e.price,quantity:e.quantity,total:e.price*e.quantity})),subtotal:h.reduce((e,t)=>e+(t.price||0)*t.quantity,0),tax:Math.round(.18*h.reduce((e,t)=>e+(t.price||0)*t.quantity,0)),totalAmount:Math.round(1.18*h.reduce((e,t)=>e+(t.price||0)*t.quantity,0))}};try{let e=await Q.quotes.createOne(s);e.err?alert("Error submitting quote: "+e.message):(alert("Quote request submitted successfully! We will contact you soon."),x({name:"",phone:"",email:"",address:"",propertyType:"residential",roofArea:"",monthlyBill:"",requirements:""}),g([]),i("home"))}catch(e){console.error("Error submitting quote:",e),e.message.includes("Network error")?alert("Connection failed. Please check if the server is running and try again."):alert("Error submitting quote: "+e.message)}},className:"space-y-3",children:[(0,t.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,t.jsx)("input",{type:"text",placeholder:"Full Name",value:c.name,onChange:e=>x({...c,name:e.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",required:!0}),(0,t.jsx)("input",{type:"tel",placeholder:"Phone Number",value:c.phone,onChange:e=>x({...c,phone:e.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",required:!0})]}),(0,t.jsx)("input",{type:"email",placeholder:"Email Address",value:c.email,onChange:e=>x({...c,email:e.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",required:!0}),(0,t.jsx)("textarea",{placeholder:"Installation Address",value:c.address,onChange:e=>x({...c,address:e.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",rows:2,required:!0}),(0,t.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,t.jsxs)("select",{value:c.propertyType,onChange:e=>x({...c,propertyType:e.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",children:[(0,t.jsx)("option",{value:"residential",children:"Residential"}),(0,t.jsx)("option",{value:"commercial",children:"Commercial"}),(0,t.jsx)("option",{value:"industrial",children:"Industrial"})]}),(0,t.jsx)("input",{type:"number",placeholder:"Roof Area (sq ft)",value:c.roofArea,onChange:e=>x({...c,roofArea:e.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20"})]}),(0,t.jsx)("input",{type:"number",placeholder:"Monthly Electricity Bill (â‚¹)",value:c.monthlyBill,onChange:e=>x({...c,monthlyBill:e.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",required:!0}),(0,t.jsx)("textarea",{placeholder:"Special Requirements or Questions",value:c.requirements,onChange:e=>x({...c,requirements:e.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",rows:2}),h.length>0&&(0,t.jsxs)("div",{className:"rounded-2xl border border-green-500/20 bg-green-500/5 p-4",children:[(0,t.jsx)("h4",{className:"text-sm font-semibold text-green-500 mb-3",children:"Selected Items"}),(0,t.jsx)("div",{className:"space-y-2",children:h.map(e=>(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsxs)("span",{children:[e.name," x",e.quantity]}),(0,t.jsxs)("span",{children:["â‚¹",(e.price*e.quantity).toLocaleString()]})]},e.id))}),(0,t.jsx)("div",{className:"border-t border-green-500/20 mt-3 pt-3",children:(0,t.jsxs)("div",{className:"flex justify-between text-sm font-semibold text-green-500",children:[(0,t.jsx)("span",{children:"Total (incl. tax):"}),(0,t.jsxs)("span",{children:["â‚¹",Math.round(1.18*h.reduce((e,t)=>e+(t.price||0)*t.quantity,0)).toLocaleString()]})]})})]}),(0,t.jsx)("button",{type:"submit",className:"w-full rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110",children:h.length>0?"Submit Quote Request":"Get Free Quote"})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-5",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold mb-3",children:"Why Choose Solar?"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center text-xs",children:"ðŸ’°"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-semibold",children:"Save Money"}),(0,t.jsx)("div",{className:"text-xs text-slate-400",children:"Reduce electricity bills by 80%"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center text-xs",children:"ðŸŒ±"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-semibold",children:"Go Green"}),(0,t.jsx)("div",{className:"text-xs text-slate-400",children:"Reduce carbon footprint"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center text-xs",children:"ðŸ“ˆ"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-semibold",children:"Increase Value"}),(0,t.jsx)("div",{className:"text-xs text-slate-400",children:"Boost property value"})]})]})]})]}),(0,t.jsxs)("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-5",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold mb-3",children:"Quick Estimate"}),c.monthlyBill&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,t.jsx)("span",{children:"Annual Bill:"}),(0,t.jsxs)("span",{children:["â‚¹",(12*parseInt(c.monthlyBill)).toLocaleString()]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,t.jsx)("span",{children:"Estimated System Cost:"}),(0,t.jsxs)("span",{children:["â‚¹",(12*parseInt(c.monthlyBill)*8).toLocaleString()]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-green-500",children:[(0,t.jsx)("span",{children:"Annual Savings:"}),(0,t.jsxs)("span",{children:["â‚¹",(12*parseInt(c.monthlyBill)*.8).toLocaleString()]})]})]}),!c.monthlyBill&&(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Enter your monthly bill to see estimate"})]})]})]})]}),"cart"===n&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex items-end justify-between gap-4 mb-6",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold",children:"Shopping Cart"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Review your selected items"})]})}),0===h.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"text-4xl mb-3",children:"ðŸ›’"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Your cart is empty"}),(0,t.jsx)("p",{className:"text-sm text-slate-400 mb-4",children:"Add some solar products to get started!"}),(0,t.jsx)("button",{onClick:()=>i("products"),className:"rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110",children:"Browse Products"})]}):(0,t.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:h.map(e=>(0,t.jsxs)("article",{className:"rounded-3xl border border-white/10 bg-white/5 p-5 hover:bg-white/10",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-base font-semibold",children:e.name}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:e.category}),(0,t.jsx)("div",{className:"mt-3 flex items-center gap-2",children:(0,t.jsxs)("span",{className:"text-lg font-semibold text-green-500",children:["â‚¹",e.price?.toLocaleString()]})})]}),(0,t.jsx)("div",{className:"grid h-14 w-14 place-items-center rounded-2xl bg-green-500/15 ring-1 ring-green-500/20",children:e.image?(0,t.jsx)("img",{src:w(e.image),alt:e.name,className:"w-full h-full object-cover rounded-2xl"}):(0,t.jsx)("span",{children:"âš¡"})})]}),(0,t.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>{g(h.map(t=>t.id===e.id&&t.quantity>1?{...t,quantity:t.quantity-1}:t))},className:"w-8 h-8 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center text-sm font-semibold hover:bg-white/10 transition-all",children:"-"}),(0,t.jsx)("span",{className:"w-8 text-center text-sm font-semibold",children:e.quantity}),(0,t.jsx)("button",{onClick:()=>{g(h.map(t=>t.id===e.id?{...t,quantity:t.quantity+1}:t))},className:"w-8 h-8 rounded-lg bg-white/5 border border-white/10 flex items-center justify-center text-sm font-semibold hover:bg-white/10 transition-all",children:"+"})]}),(0,t.jsx)("button",{onClick:()=>{g(h.filter(t=>t.id!==e.id))},className:"rounded-2xl border border-white/10 bg-white/5 px-3 py-2 text-sm font-semibold hover:bg-white/10",children:"Remove"})]})]},e.id))}),h.length>0&&(0,t.jsxs)("div",{className:"mt-6 rounded-3xl border border-white/10 bg-white/5 p-5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-semibold",children:"Order Summary"}),(0,t.jsxs)("div",{className:"mt-1 text-xs text-slate-400",children:[h.length," items â€¢ Tax included"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-lg font-semibold text-green-500",children:["â‚¹",Math.round(1.18*h.reduce((e,t)=>e+(t.price||0)*t.quantity,0)).toLocaleString()]}),(0,t.jsx)("div",{className:"text-xs text-slate-400",children:"Total with 18% tax"})]})]}),(0,t.jsx)("button",{onClick:()=>{e&&x({...c,name:e.name||"",email:e.email||"",phone:e.phone||"",address:e.address||""}),i("get-quote")},className:"mt-5 inline-flex w-full items-center justify-center rounded-2xl bg-green-500 px-4 py-2.5 text-sm font-semibold text-black hover:brightness-110",children:"ðŸ’° Generate Quote"})]})]}),"raise-ticket"===n&&(0,t.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold",children:"Support Center"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-400",children:"Get help with your solar solutions"})]}),(0,t.jsx)("div",{className:"rounded-3xl border border-white/10 bg-white/5 p-6",children:e?(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Create Support Ticket"}),(0,t.jsxs)("form",{onSubmit:t=>{(t.preventDefault(),e)?(l("tickets",{...m,customerId:e.id,customerName:e.name,status:"open",assignedTo:"",createdBy:e.id,createdAt:new Date().toISOString()}),u({type:"product",itemId:"",issue:"",notes:""}),alert("Ticket raised successfully!")):j(!0)},className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Category"}),(0,t.jsxs)("select",{value:m.type,onChange:e=>u({...m,type:e.target.value,itemId:""}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",children:[(0,t.jsx)("option",{value:"product",children:"Solar Product"}),(0,t.jsx)("option",{value:"service",children:"Solar Service"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Select Item"}),(0,t.jsxs)("select",{value:m.itemId,onChange:e=>u({...m,itemId:e.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",required:!0,children:[(0,t.jsxs)("option",{value:"",children:["Select ",m.type]}),("product"===m.type?r.products:r.services)&&Array.isArray("product"===m.type?r.products:r.services)?("product"===m.type?r.products:r.services).map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id)):null]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Issue Description"}),(0,t.jsx)("textarea",{placeholder:"Describe your issue in detail...",value:m.issue,onChange:e=>u({...m,issue:e.target.value}),className:"w-full rounded-2xl border border-white/10 bg-white/5 px-4 py-3 text-sm outline-none focus:border-green-500/60 focus:ring-2 focus:ring-green-500/20",rows:4,required:!0})]}),(0,t.jsx)("button",{type:"submit",className:"w-full rounded-2xl bg-green-500 px-5 py-3 text-sm font-semibold text-black hover:brightness-110",children:"Submit Support Ticket"})]})]}):(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"text-4xl mb-4",children:"ðŸ”’"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Login Required"}),(0,t.jsx)("p",{className:"text-sm mb-6 text-slate-400",children:"Please login to raise a support ticket"}),(0,t.jsx)("button",{onClick:()=>{j(!0)},className:"rounded-2xl bg-green-500 px-6 py-2.5 text-sm font-semibold text-black hover:brightness-110",children:"Login to Continue"})]})})]}),"my-orders"===n&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-center mb-12",children:[(0,t.jsx)("h2",{className:`text-4xl font-bold mb-4 ${d?"text-white":"text-gray-900"}`,children:"My Orders"}),(0,t.jsx)("p",{className:`text-xl ${d?"text-white":"text-gray-900"}`,children:"Track your solar product orders"})]}),(0,t.jsxs)("div",{className:`rounded-2xl ${d?"text-white":"text-gray-900"}`,children:[(0,t.jsx)("div",{className:`p-6 border-b ${d?"text-white":"text-gray-900"}`,children:(0,t.jsx)("h3",{className:`text-xl font-semibold ${d?"text-white":"text-gray-900"}`,children:"Order History"})}),(0,t.jsx)("div",{className:"p-6",children:e?0===y.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"text-6xl mb-6",children:"ðŸ“¦"}),(0,t.jsx)("h3",{className:`text-2xl font-semibold mb-4 ${d?"text-white":"text-gray-900"}`,children:"No Orders Yet"}),(0,t.jsx)("p",{className:`text-lg mb-8 ${d?"text-white":"text-gray-900"}`,children:"Start shopping for solar products"}),(0,t.jsx)("button",{onClick:()=>i("products"),className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-xl font-semibold text-lg transition-all transform hover:scale-105",children:"Browse Products"})]}):(0,t.jsx)("div",{className:"space-y-6",children:y.map(e=>(0,t.jsx)("div",{className:`p-6 rounded-2xl border transition-all hover:shadow-md ${d?"bg-gray-700 border-gray-600 hover:bg-gray-650":"bg-gray-50 border-gray-200 hover:bg-gray-100"}`,children:(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h4",{className:`text-lg font-semibold mb-2 ${d?"text-white":"text-gray-900"}`,children:e.itemName}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 mb-3",children:[(0,t.jsx)("span",{className:`text-sm px-3 py-1 rounded-full ${d?"text-white":"text-gray-900"}`,children:e.type}),"product"===e.type&&(0,t.jsxs)("span",{className:`text-sm ${d?"text-white":"text-gray-900"}`,children:["Qty: ",e.quantity]})]}),(0,t.jsxs)("p",{className:"text-xl font-bold text-teal-600 mb-2",children:["â‚¹",(e.totalPrice||e.itemPrice)?.toLocaleString()]}),e.description&&(0,t.jsx)("p",{className:`text-sm mb-2 ${d?"text-white":"text-gray-900"}`,children:e.description}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,t.jsxs)("span",{children:["Preferred: ",e.preferredDate]}),(0,t.jsxs)("span",{children:["Ordered: ",e.createdAt]})]})]}),(0,t.jsx)("span",{className:`px-4 py-2 rounded-full text-sm font-medium text-white ${"completed"===e.status?"bg-green-500":"in-progress"===e.status?"bg-blue-500":"bg-yellow-500"}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]})},e.id))}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"text-6xl mb-6",children:"ðŸ”’"}),(0,t.jsx)("h3",{className:`text-2xl font-semibold mb-4 ${d?"text-white":"text-gray-900"}`,children:"Login Required"}),(0,t.jsx)("p",{className:`text-lg mb-8 ${d?"text-white":"text-gray-900"}`,children:"Please login to view your orders"}),(0,t.jsx)("button",{onClick:()=>{j(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-xl font-semibold text-lg transition-all transform hover:scale-105",children:"Login to Continue"})]})})]})]}),"my-tickets"===n&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-center mb-12",children:[(0,t.jsx)("h2",{className:`text-4xl font-bold mb-4 ${d?"text-white":"text-gray-900"}`,children:"Support Tickets"}),(0,t.jsx)("p",{className:`text-xl ${d?"text-white":"text-gray-900"}`,children:"Track your support requests"})]}),(0,t.jsxs)("div",{className:`rounded-2xl ${d?"text-white":"text-gray-900"}`,children:[(0,t.jsx)("div",{className:`p-6 border-b ${d?"text-white":"text-gray-900"}`,children:(0,t.jsx)("h3",{className:`text-xl font-semibold ${d?"text-white":"text-gray-900"}`,children:"Ticket History"})}),(0,t.jsx)("div",{className:"p-6",children:e?0===f.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"text-6xl mb-6",children:"ðŸŽŸï¸"}),(0,t.jsx)("h3",{className:`text-2xl font-semibold mb-4 ${d?"text-white":"text-gray-900"}`,children:"No Support Tickets"}),(0,t.jsx)("p",{className:`text-lg mb-8 ${d?"text-white":"text-gray-900"}`,children:"Need help? Create a support ticket"}),(0,t.jsx)("button",{onClick:()=>i("raise-ticket"),className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-xl font-semibold text-lg transition-all transform hover:scale-105",children:"Create Ticket"})]}):(0,t.jsx)("div",{className:"space-y-6",children:f.map(e=>{let s=("product"===e.type?r.products&&Array.isArray(r.products)?r.products:[]:r.services&&Array.isArray(r.services)?r.services:[]).find(t=>t.id==e.itemId);return(0,t.jsx)("div",{className:`p-6 rounded-2xl border transition-all hover:shadow-md ${d?"bg-gray-700 border-gray-600 hover:bg-gray-650":"bg-gray-50 border-gray-200 hover:bg-gray-100"}`,children:(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,t.jsxs)("h4",{className:`text-lg font-semibold ${d?"text-white":"text-gray-900"}`,children:["Ticket #",e.id]}),(0,t.jsx)("span",{className:`text-sm px-3 py-1 rounded-full ${d?"text-white":"text-gray-900"}`,children:e.type})]}),(0,t.jsxs)("p",{className:`text-sm mb-2 ${d?"text-white":"text-gray-900"}`,children:["Related to: ",s?.name]}),(0,t.jsx)("p",{className:`mb-3 ${d?"text-white":"text-gray-900"}`,children:e.issue}),e.notes&&(0,t.jsxs)("p",{className:`text-sm mb-3 ${d?"text-white":"text-gray-900"}`,children:[(0,t.jsx)("span",{className:"font-medium",children:"Notes:"})," ",e.notes]}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:["Created: ",new Date(e.createdAt).toLocaleDateString()]})]}),(0,t.jsx)("span",{className:`px-4 py-2 rounded-full text-sm font-medium text-white ${"closed"===e.status?"bg-gray-500":"completed"===e.status?"bg-green-500":"in-progress"===e.status?"bg-blue-500":"bg-yellow-500"}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]})},e.id)})}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"text-6xl mb-6",children:"ðŸ”’"}),(0,t.jsx)("h3",{className:`text-2xl font-semibold mb-4 ${d?"text-white":"text-gray-900"}`,children:"Login Required"}),(0,t.jsx)("p",{className:`text-lg mb-8 ${d?"text-white":"text-gray-900"}`,children:"Please login to view your support tickets"}),(0,t.jsx)("button",{onClick:()=>{j(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-4 rounded-xl font-semibold text-lg transition-all transform hover:scale-105",children:"Login to Continue"})]})})]})]}),p&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Customer Login"}),(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=new FormData(e.target),s=t.get("email"),l=t.get("password"),n=r.customers?.find(e=>e.email===s&&e.password===l);n?(a(s,l,{...n,role:"customer"}),j(!1)):alert("Invalid credentials")},className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),(0,t.jsx)("input",{name:"email",type:"email",required:!0,className:"w-full bg-gray-700 text-white px-3 py-2 rounded-lg border border-gray-600 focus:border-green-500 focus:outline-none",placeholder:"Enter your email"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),(0,t.jsx)("input",{name:"password",type:"password",required:!0,className:"w-full bg-gray-700 text-white px-3 py-2 rounded-lg border border-gray-600 focus:border-green-500 focus:outline-none",placeholder:"Enter your password"})]}),(0,t.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,t.jsx)("button",{type:"button",onClick:()=>j(!1),className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white py-2 rounded-lg transition-colors",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",className:"flex-1 bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg transition-colors",children:"Login"})]})]})]})})]})})]})};function z(){let{currentUser:e}=b(),[r,l]=(0,s.useState)(!1),[a,n]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{l(!0)},[]),r)?a&&!e?(0,t.jsx)(f,{onBackToCustomer:()=>n(!1)}):e&&"customer"!==e.role?(0,t.jsx)(N,{children:(0,t.jsx)($,{})}):(0,t.jsx)(U,{}):(0,t.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:"Loading..."})}let _=function(){return(0,t.jsx)("div",{className:"min-h-screen bg-white",children:(0,t.jsx)(j,{children:(0,t.jsx)(z,{})})})};function W(){return(0,t.jsx)(_,{})}e.s(["default",()=>W],3181)},9675,(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",()=>e.r(3181)]),t.hot&&t.hot.dispose(function(){window.__NEXT_P.push(["/"])})}]);